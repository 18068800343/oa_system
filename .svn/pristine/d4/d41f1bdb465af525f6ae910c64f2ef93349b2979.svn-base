<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../../font2/iconfont.css">
    <link rel="stylesheet" href="../../font3/iconfont.css">
	<link href="../../style/bootstrap.min.css" rel="stylesheet">
    <link href="../../style/style.css" rel="stylesheet">
    <link href="../../toastr/toastr.css" rel="stylesheet">
    <link rel="stylesheet" href="../../style/jquery.dataTables.min.css">
    <link rel="stylesheet" href="../../style/jquery-editable-select.css">
    <style lang="">
        body{
            background: #fff;
        }
        .UpperPart{
            display: flex;
            justify-content:space-between;
            border-bottom: 1px solid #ccc;
            padding-bottom: 12px;
        }
        .selected{
            background: rgba(247, 161, 3,0.2);
        }
        #mainContent th{
            cursor: pointer;
            font-size: 14px;
        }
        #tijiaoren{
                display: flex;
                flex-wrap:wrap;
        }
        .tab-content>div{
            margin-top:18px;
        }
    </style>
</head>
<body>
   
    <!-- 面包屑 -->
    <div class="mianbao">
    	<ul class="breadcrumb">
    		<li><i class="iconfont icon-knowledgebase"></i></li>
			<li>基础数据管理</li>
			<li class="active">合作单位管理</li>
		</ul>
    </div>

    <div class="zhuti-content">
        <div>
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active" id="diyi"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">主页</a></li>
                <li role="presentation" id="dier"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">新建</a></li>
                <li role="presentation" id="disan"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">修改</a></li>
                <li role="presentation" id="disi"><a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">查看详细信息</a></li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="home">
                    <div class="UpperPart">
                        <div class="UpperPartL" style="font-size:18px;">
                            <form class="form-inline">
                                <label>状态筛选:</label>
                                <select class="zhuangtai">
                                    <option>正常进行</option>
                                    <option>项目终止</option>
                                    <option>项目履约完结</option>
                                </select>
                            </form>
                        </div>
                        <div class="UpperPartR">
                            <button type="button" class="btn btn-primary" id="zenjia" >填报任务单</button>
                        </div>
                    </div>
                    <div class="LowerPart" style="margin-top:3px;">
                        <table class="table table-bordered table-condensed" id="mainContent">
                            <thead>
                                
                                <tr>
                                    <th>项目名称</th>
                                    <th>编号</th>
                                    <th>项目所属公司</th>
                                    <th>项目类型</th>
                                    <th>项目业主单位</th>
                                    <th>项目金额</th>
                                    <th>合同金额</th>
                                    <th>项目开始时间</th>
                                    <th>主办部门</th>
                                    <th style="width:60px;">操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                            </tbody>   
                        </table>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="profile">
                    <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">项目基本信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                                <td>项目名称</td>
                                <td>
                                	<form class="form-inline">
									    <input type="text" class="form-control" style="width:222px;" id="taskName">  <i class="iconfont icon-xingxing-copy" style="color:red;"></i>
									  </form>
                                </td>
                                <td style="width:150px;">编号</td>
                                <td style="width:250px;"><input type="text" class="form-control" style="width:180px;" id="taskbianhao"></td>
                                <td style="width:150px;">项目经营模式</td>
                                <td style="width:250px;">
                                    <select class="form-control" style="width:180px;" id="moshi">
                                        <option>自营</option>
                                        <option>联营</option>
                                    </select>
                                </td>
                                <td style="width:150px;">项目所属公司</td>
                                <td>
                                    <select class="form-control" style="width:180px;" id="gongsi">
                                        <option>华通</option>
                                        <option>华汇</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:150px;">项目类型</td>
                                <td style="width:300px;">
                                    <form class="form-inline">
                                        <select class="form-control" style="width:110px;" id="yijileixing">
                                            <option>--请选择--</option>
                                        </select>
                                        <select class="form-control" style="width:110px;" id="erjileixing">
                                            <option>--请选择--</option>
                                        </select>
                                    </form>
                                </td>
                                <td>设计阶段</td>
                                <td>
                                		<select class="form-control" style="width:180px;" id="shejijieduan">
                                            <option value="无">无</option>
                                            <option value="一阶段设计">一阶段设计</option>
                                            <option value="二阶段设计">二阶段设计</option>
                                        </select>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                    	</tbody>
                    </table>
                    
                    <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">项目业主信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                                <td style="width:150px;">项目业主单位</td>
                                <td style="width:300px;">
                                <form class="form-inline">
                                	<select class="form-control" style="width:220px;" id="yezhudanwei">
                                        
                                    </select>  <i class="iconfont icon-xingxing-copy" style="color:red;"></i>
                                </form>
                                </td>
                                <td style="width:150px;">项目金额</td>
                                <td style="width:250px;"><input type="text" class="form-control" style="width:180px;" id="jine"></td>
                                <td style="width:150px;">合同金额</td>
                                <td style="width:250px;"><input type="text" class="form-control" style="width:180px;" id="hetonge"></td>
                                <td style="width:150px;">暂定金</td>
                                <td><input type="text" class="form-control" style="width:180px;" id="zandingjin"></td>
                            </tr>
                            <tr>
                                <td>项目开始时间</td>
                                <td><input type="text" class="form-control" id="year" style="width:220px;"></td>
                                <td>项目结束时间</td>
                                <td><input type="text" class="form-control" id="year2" style="width:180px;"></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                    	</tbody>
                    </table>
                    <table class="table table-bordered table-condensed">
                            <tr>
                                <td>联系人</td>
                                <td>
                                    <select class="form-control" style="width:180px;" id="lianxiren">
                                        <option>---请选择---</option>
                                            <option>1111</option>
                                            <option>2222</option>
                                    </select>
                                </td>
                                <td>联系方式</td>
                                <td>
                                    <select class="form-control" style="width:180px;" id="lianxifangshi">
                                        <option>---请选择---</option>
                                        <option>1111</option>
                                        <option>2222</option>
                                    </select>
                                </td>
                                <td><button type="button" class="btn btn-info" onclick="addLianxiren()">添加</button></td>
                            </tr>
                        </table>
                        <table class="table table-bordered table-condensed" id="lianxibiaoge">
                            <thead>
                                <tr>
                                    <th colspan="2">添加的联系人,联系方式</th>
                                </tr>
                                <tr>
                                    <th style="width:120px;">联系人</th>
                                    <th>联系方式</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table>
                        
                    <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="4">项目承接信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                                <td style="width:150px;">主办部门</td>
                                <td>
                                    <form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="zhuban">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额" id="zhubanjine">
                                    </form>
                                </td>
                                <td>协办部门1</td>
                                <td>
                                		<form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xieban1">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额" id="xieban1jine">
                                    </form>
                                </td>
                            </tr>
                            <tr>
                                <td>协办部门2</td>
                                <td>
                                    <form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xieban2">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额"  id="xieban2jine">
                                    </form>
                                </td>
                                <td>协办部门3</td>
                                <td>
                                		<form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xieban3">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额" id="xieban3jine">
                                    </form>
                                </td>
                            </tr>
                            <tr>
                                <td>项目概况及工作内容</td>
                                <td colspan="3"><textarea cols="50" rows="5" id="gaikuang"></textarea></td>
                            </tr>
                    	</tbody>
                    </table>
                    <div class="modal-footer" >
                        <button type="button" class="btn btn-default"  onclick="quxiao()">取消</button>
                        <button type="button" class="btn btn-default"  onclick="addrenwudan()">保存</button>
                        <button type="button" class="btn btn-success"   onclick="tijiaorenwudan()">提交</button> 
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="messages">
                    <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">修改项目基本信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                                <td>项目名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                   <input type="text" class="form-control" style="width:222px;" id="xgtaskName">
                                </td>
                                <td style="width:100px;">编号</td>
                                <td><input type="text" class="form-control" style="width:180px;" id="xgtaskbianhao"></td>
                                <td>项目经营模式</td>
                                <td>
                                    <select class="form-control" style="width:180px;" id="xgmoshi">
                                        <option>自营</option>
                                        <option>联营</option>
                                    </select>
                                </td>
                                <td>项目所属公司</td>
                                <td>
                                    <select class="form-control" style="width:180px;" id="xggongsi">
                                        <option>华通</option>
                                        <option>华汇</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:100px;">项目类型</td>
                                <td>
                                    <form class="form-inline">
                                        <select class="form-control" style="width:110px;" id="xgyijileixing">
                                            <option>---请选择---</option>
                                        </select>
                                        <select class="form-control" style="width:110px;" id="xgerjileixing">
                                            <option>---请选择---</option>
                                        </select>
                                    </form>
                                </td>
                                <td>设计阶段</td>
                                <td>
                                		<select class="form-control" style="width:180px;" id="xgshejijieduan">
                                            <option value="无">无</option>
                                            <option value="一阶段设计">一阶段设计</option>
                                            <option value="二阶段设计">二阶段设计</option>
                                        </select>
                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                    	</tbody>
                 </table>
                 
                 <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">修改业主信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                                <td>项目业主单位  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" style="width:180px;" id="xgyezhudanwei">
                                        
                                    </select>
                                </td>
                                <td>项目金额</td>
                                <td><input type="text" class="form-control" style="width:180px;" id="xgjine"></td>
                                <td>合同金额</td>
                                <td><input type="text" class="form-control" style="width:180px;" id="xghetonge"></td>
                                <td>暂定金</td>
                                <td><input type="text" class="form-control" style="width:180px;" id="xgzandingjin"></td>
                            </tr>
                            <tr>
                                <td>项目开始时间</td>
                                <td><input type="text" class="form-control" style="width:180px;" id="xgstartTime"></td>
                                <td>项目结束时间</td>
                                <td><input type="text" class="form-control"  style="width:180px;" id="xgendTime"></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                    	</tbody>
                 </table>
                 <table class="table table-bordered table-condensed">
                            <tr>
                                <td>联系人</td>
                                <td>
                                    <select class="form-control" style="width:300px;" id="xglianxiren">
                                        <option>---请选择---</option>
                                       	<option>123123</option>
                               			<option>456456</option>
                                    </select>
                                </td>
                                <td>联系方式</td>
                                <td>
                                    <select class="form-control" style="width:243px;" id="xglianxifangshi">
                                        <option>---请选择---</option>
                                        <option>123123</option>
                                		<option>456456</option>
                                    </select>
                                </td>
                                <td><button type="button" class="btn btn-info" onclick="xgaddLianxiren()">添加</button></td>
                            </tr>
                        </table>
                        <table class="table table-bordered table-condensed" id="xglianxibiaoge">
                            <thead>
                                <tr>
                                    <th colspan="2">修改的联系人,联系方式</th>
                                </tr>
                                <tr>
                                    <th>联系人</th>
                                    <th>联系方式</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table>
                 
                 <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="4">修改承接信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                                <td>主办部门</td>
                                <td>
                                    <form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xgzhuban">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额" id="xgzhubanjine">
                                    </form>
                                </td>
                                <td>协办部门1</td>
                                <td>
                                		<form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xgxieban1">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额" id="xgxiebanjine">
                                    </form>
                                </td>
                            </tr>
                            <tr>
                                <td>协办部门2</td>
                                <td>
                                    <form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xgxieban2">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额"  id="xgxieban2jine">
                                    </form>
                                </td>
                                <td>协办部门3</td>
                                <td>
                                		<form class="form-inline">
                                        <select class="form-control" style="width:150px;" id="xgxieban3">
                                            
                                        </select>
                                        <input type="text" class="form-control" style="width:150px;" placeholder="金额" id="xgxieban3jine">
                                    </form>
                                </td>
                            </tr>
                            <tr>
                                <td>项目概况及工作内容</td>
                                <td colspan="3"><textarea cols="50" rows="5" id="xggaikuang"></textarea></td>
                            </tr>
                    	</tbody>
                    </table>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default"  onclick="quxiao2()">取消</button>
                        <button type="button" class="btn btn-default" onclick="xgsaverenwudan()">保存</button>
                        <button type="button" class="btn btn-success" onclick="xgaddrenwudan()">提交</button>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="settings">
                	<table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">查看项目基本信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
                            <td>项目名称</td>
                            <td id="looktaskName"></td>
                            <td style="width:100px;">编号</td>
                            <td id="looktaskbianhao"></td>
                            <td>项目经营模式</td>
                            <td id="lookmoshi"></td>
                            <td>项目所属公司</td>
                            <td id="lookgongsi"></td>
                        </tr>
                        <tr>
                            <td style="width:100px;">项目类型</td>
                            <td id="lookleixing"></td>
                            <td>设计阶段</td>
                            <td id="lookshejijieduan"></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    	</tbody>
                    </table>
                    
                    <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">查看业主信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
	                            <td>项目业主单位</td>
	                            <td id="lookyezhudanwei"></td>
	                            <td>项目金额</td>
	                            <td id="lookjine"></td>
	                            <td>合同金额</td>
	                            <td id="lookhetonge"></td>
	                            <td>暂定金</td>
	                            <td id="lookzandingjin"></td>
	                        </tr>
	                        <tr>
	                            <td>项目开始时间</td>
	                            <td id="lookstartTime"></td>
	                            <td>项目结束时间</td>
	                            <td id="lookendTime"></td>
	                            <td></td>
	                            <td></td>
	                            <td></td>
	                            <td></td>
	                        </tr>
                    	</tbody>
                    </table>
                    <table class="table table-bordered table-condensed"  id="looklianxibiaoge">
                        <thead>
                            <tr>
                                <th colspan="2">添加的联系人,联系方式</th>
                            </tr>
                            <tr>
                                <th>联系人</th>
                                <th>联系方式</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                    
                    <table class="table table-bordered table-condensed">
                    	<thead>
                    		<tr>
                    			<th colspan="8">查看承接信息</th>
                    		</tr>
                    	</thead>
                    	<tbody>
                    		<tr>
	                             <td>主办部门</td>
	                             <td id="lookzhuban"></td>
	                             <td>金额</td>
	                             <td id="lookzhubanjine"></td>
	                             <td>协办部门1</td>
	                             <td id="lookxieban1"></td>
	                             <td>金额</td>
	                             <td id="lookxiebanjine"></td>
	                         </tr>
	                         <tr>
	                             <td>协办部门2</td>
	                             <td id="lookxieban2"></td>
	                             <td>金额</td>
	                             <td id="lookxieban2jine"></td>
	                             <td>协办部门3</td>
	                             <td id="lookxieban3"></td>
	                             <td>金额</td>
	                             <td id="lookxieban3jine"></td>
	                         </tr>
	                        <tr>
	                            <td>项目概况及工作内容</td>
	                            <td colspan="8"  id="lookgaikuang"></td>
	                        </tr>
                    	</tbody>
                    </table>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" onclick="quxiao3()">取消</button>
                    </div>
                </div>
            </div>

                
        </div>
    </div>

<!-- 提交 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="tijiaogei">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">提交给</h4>
            </div>
            <div class="modal-body">
                <form class="form-inline">
                
                    <!-- <div id="tijiaoren"></div> -->
                        <table class="table table-bordered table-condensed">
                            <tr>
                                <td>部门</td>
                                <td>
                                	<select class="form-control" style="width:150px;" id="tijiaobumen">
                                            
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>提交人</td>
                                <td>
                                	<select class="form-control" style="width:150px;" id="tijiaoshei">
                                            
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>职务</td>
                                <td>
                                	<select class="form-control" style="width:150px;" id="tijiaozhiwu">
                                            
                                    </select>
                                </td>
                            </tr>
                        </table>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-success" data-dismiss="modal"  onclick="tijiaorenwudan2()">提交</button>
            </div>
        </div>
    </div>
</div>
<!-- 提交 modal结束 -->
<!-- Modal3 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal3">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>任务单重新启用申请表</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed">
                            <tr>
                                <td>任务单重新启用原因</td>
                                <td colspan="3"><textarea name="" id="" cols="50" rows="5"></textarea></td>
                            </tr>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default">保存</button>
            <!-- <button type="button" class="btn btn-success">提交</button> -->
        </div>
        </div>
    </div>
</div>
<!-- model3结束 -->
<!-- Modal4 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal4">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>任务单中止申请表</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed">
                            <tr>
                                <td>任务单中止原因</td>
                                <td colspan="3"><textarea name="" id="" cols="50" rows="5"></textarea></td>
                            </tr>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default">保存</button>
            <button type="button" class="btn btn-success" id="stopTask">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- model4结束 -->
<!-- Modal5-->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal5">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>任务单履约完结申请表</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed">
                            <tr>
                                <td>任务单履约完结原因</td>
                                <td colspan="3"><textarea name="" id="" cols="50" rows="5"></textarea></td>
                            </tr>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default">保存</button>
            <button type="button" class="btn btn-success" id="finishTask">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- model5结束 -->
</body>
<script src="../../js/jquery.js"></script>
<script src="../../js/common-scripts.js"></script>
<script src="../../js/jquery.dataTables.min.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/laydate/laydate.js"></script>
<script src="../../js/jquery-editable-select.js"></script>
<script src="../../toastr/toastr.js"></script>
<script>  
    $(document).ready( function () {
    	laydate.render({
            elem: '#year' //指定元素
        });
        laydate.render({
            elem: '#year2' //指定元素
        });
        laydate.render({
            elem: '#xgstartTime' //指定元素
        });
        laydate.render({
            elem: '#xgendTime' //指定元素
        });
        $('#editable-select').editableSelect({ 
            effects: 'slide' 
        });
        $('#editable-selectT').editableSelect({ 
            effects: 'slide' 
        });
        leixingSelect();
        leixingSelect2();
        initTable();
        initbzhiwu();
        initbushei();
        initbumen();
        
	});
        $("#diyi a").hide();
        $("#dier a").hide();
        $("#disan a").hide();
        $("#disi a").hide();
    $("#zenjia").click(function(){
        $("#diyi").removeClass("active");
        $("#dier").addClass("active");
        $("#diyi a").show();
        $("#dier a").show();
        $("#home").removeClass("active");
        $("#profile").addClass("active");
    })
    function quxiao(){
    	 $("#diyi").addClass("active");
         $("#dier").removeClass("active");
         $("#diyi a").hide();
         $("#dier a").hide();
         $("#home").addClass("active");
         $("#profile").removeClass("active");
    }
    function quxiao2(){
    	$("#diyi").addClass("active");
        $("#disan").removeClass("active");
        $("#diyi a").hide();
        $("#disan a").hide();
        $("#home").addClass("active");
        $("#messages").removeClass("active");
   }
    function quxiao3(){
    	$("#diyi").addClass("active");
        $("#disi").removeClass("active");
        $("#diyi a").hide();
        $("#disi a").hide();
        $("#home").addClass("active");
        $("#settings").removeClass("active");
   }

    var table=$('#mainContent').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
		            { "data": "prjName"},
		            { "data": "prjNo"}, 
		            { "data": "prjCompany"}, 
		            { "data": "prjType2"}, 
		            { "data": "prjOwnerUnit"}, 
		            { "data": "prjEstimateMoney"}, 
		            { "data": "contractMoney"}, 
		            { "data": "prjStartTime"}, 
		            { "data": "omName"}, 
		            { "data": null},
		        ],
		        "columnDefs": [
								{	
										 "class": "tcenter",
										    "targets": 9,
										    "searchable": true,
										    "render": function(data, type, full) {
										  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息"   id="lookDetall"></i><i class="iconfont icon-xiugai iconxiugai" style="font-size:18px;cursor:pointer;" title="修改"  id="Changedanwei"></i><i class="iconfont icon-arrow chongqi" style="font-size:18px;cursor:pointer;display:none;" title="重启" data-toggle="modal" data-target="#myModal3"></i><i class="iconfont icon-tuichu iconzhongzhi" style="font-size:18px;cursor:pointer;" title="项目中止"  data-toggle="modal" data-target="#myModal4"></i><i class="iconfont icon-yibanshixiang iconlywj" style="font-size:18px;cursor:pointer;" title="项目履约完结"  data-toggle="modal" data-target="#myModal5"></i>'
										        }
										  }
								],
        "order": [[1, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
	function initTable(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/task/selectTaskByStatus',
            dataType: 'json',
            data: {
            	status:2,
            },
            success: function (json) {
            	//console.log(json)
                $('#mainContent').dataTable().fnClearTable();
                $('#mainContent').DataTable().rows.add(json).draw(false);
            }
        });
    }


    //初始化
    $(".zhuangtai").change(function(){
        var zt=$(".zhuangtai").val();
        if(zt=="正常进行"){
        	$.ajax({
                type: 'POST',
                url: getContextPath()+'/task/selectTaskByStatus',
                dataType: 'json',
                data: {
                	status:2,
                },
                success: function (json) {
                    $('#mainContent').dataTable().fnClearTable();
                    $('#mainContent').DataTable().rows.add(json).draw(false);
                    $(".chongqi").hide();
                    $(".iconxiugai").show();
                    $(".iconzhongzhi").show();
                    $(".iconlywj").show();
                }
            });
            
        }else if(zt=="项目终止"){
        	$.ajax({
                type: 'POST',
                url: getContextPath()+'/task/selectTaskByStatus',
                dataType: 'json',
                data: {
                	status:3,
                },
                success: function (json) {
                    $('#mainContent').dataTable().fnClearTable();
                    $('#mainContent').DataTable().rows.add(json).draw(false);
                    $(".chongqi").show();
                    $(".iconxiugai").hide();
                    $(".iconzhongzhi").hide();
                    $(".iconlywj").hide();
                }
            });
            
        }else if(zt=="项目履约完结"){
        	$.ajax({
                type: 'POST',
                url: getContextPath()+'/task/selectTaskByStatus',
                dataType: 'json',
                data: {
                	status:4,
                },
                success: function (json) {
                    $('#mainContent').dataTable().fnClearTable();
                    $('#mainContent').DataTable().rows.add(json).draw(false);
                    $(".chongqi").hide();
                	$(".iconxiugai").hide();
                	$(".iconzhongzhi").hide();
                    $(".iconlywj").hide();
                }
            });
        	
        }
    })
	
    //初始化一级类型
    function leixingSelect(){
    	//console.log(1)
	    $.ajax({
	        type: 'POST',
	        url: getContextPath()+'/projectType/selectAllFirstPrj',
	        dataType: 'json',
	        async:false,
	        data: {
	           
	        },
	        success: function (json) {
	        	//console.log(json)
	        	 for(var i=0;i<json.length;i++){
	        		$("#yijileixing").append( "<option value='" + json[i].idFirst + "'>"
		                    + json[i].nameFirst + "</option>")
                    $("#xgyijileixing").append( "<option value='" + json[i].idFirst + "'>"
	                    + json[i].nameFirst + "</option>")
	        	} 
	        	 $('#yijileixing').trigger("change");
		         $('#xgyijileixing').trigger("change");
	        }
	    });
	}
    //二级类型
    $("#yijileixing").change(function(){
        var id=$(this).children('option:selected').val();//这就是selected的值
        var yijiid=$(this).children('option:selected').val();
        //console.log(yijiid)
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/projectType/selectOne_TwoPrj',
            dataType: 'json',
            data:{
            	idFirst:yijiid,
            },
            success: function (json) {
            	$("#erjileixing").empty("");
            	for(var i=0;i<json.length;i++){
            		$("#erjileixing").append( "<option value='" + json[i].nameSecond + "'>"
		                    + json[i].nameSecond + "</option>")
    			}
            }
        }); 
    })
    $("#xgyijileixing").change(function(){
        var id=$(this).children('option:selected').val();//这就是selected的值
        var yijiid=$(this).children('option:selected').val();
        //console.log(yijiid)
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/projectType/selectOne_TwoPrj',
            dataType: 'json',
            async:false, 
            data:{
            	idFirst:yijiid,
            },
            success: function (json) {
            	$("#xgerjileixing").empty("");
            	for(var i=0;i<json.length;i++){
            		$("#xgerjileixing").append( "<option value='" + json[i].nameSecond + "'>"
		                    + json[i].nameSecond + "</option>")
    			}
            }
        }); 
    })
    //初始化提交部门
	function initbumen(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/organizationManagement/getOrgIdAndName',
            dataType: 'json',
            data: {

            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
                for(var i=0;i<json.length;i++){
                	$("#tijiaobumen").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#zhuban").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xieban1").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xieban2").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xieban3").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xgzhuban").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xgxieban1").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xgxieban2").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                	$("#xgxieban3").append("<option value="+json[i].omId+">"+json[i].omName+"</option>");
                }
            }
		});
	}
    //初始化提交人员
	function initbushei(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/user/selectAllUser',
            dataType: 'json',
            data: {

            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
                for(var i=0;i<json.length;i++){
                	$("#tijiaoshei").append("<option value="+json[i].uName+">"+json[i].uName+"</option>");
                }
            }
		});
	}
	//初始化职务
	function initbzhiwu(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/jobc/selectJobByType',
            dataType: 'json',
            data: {

            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
                for(var i=0;i<json.length;i++){
                	$("#tijiaozhiwu").append("<option value="+json[i].dutyDesc+">"+json[i].dutyDesc+"</option>");
                }
            }
		});
	}
    //项目业主单位
    function leixingSelect2(){
	    $.ajax({
	        type: 'POST',
	        url: getContextPath()+'/cooperator/selectCooperatorIdAndName',
	        dataType: 'json',
	        data: {
	           
	        },
	        success: function (json) {
	        	//console.log(json)
	        	 for(var i=0;i<json.length;i++){
	        		$("#yezhudanwei").append( "<option value='" + json[i].ccName + "'>"
		                    + json[i].ccName + "</option>")
                   $("#xgyezhudanwei").append( "<option value='" + json[i].ccName + "'>"
                    + json[i].ccName + "</option>")
	        	}
	        }
	    });
	}
  //增加联系人联系电话
    function addLianxiren(){
    	$("#lianxibiaoge tbody").append("<tr><td>"
    			+$("#lianxiren").val()
    			+"</td><td>"
    			+$("#lianxifangshi").val()
    			+"</td></tr>")
    }
    function xgaddLianxiren(){
    	$("#xglianxibiaoge tbody").append("<tr><td>"
    			+'<input type="text" class="form-control" value='+$("#xglianxiren").find("option:selected").val()+'>'
    			+"</td><td>"
    			+'<input type="text" class="form-control" value='+$("#xglianxifangshi").find("option:selected").val()+'>'
    			+"</td></tr>")
    }
    
    //添加任务单
    function addrenwudan(){
    	var danwei= new Array();
    	var lianxibiao= new Array();
    	$("#lianxibiaoge tbody").find("tr").each(function(){
    		var tdArr = $(this).children();
    		var name = tdArr.eq(0).text();
    	    var way = tdArr.eq(1).text();
    	    
    	    var xinlianxibiao={
    	    		eId:undefined,
    				eMan:undefined,
    				eTel:undefined
    	    }
    	    xinlianxibiao.eId=null;
    	    xinlianxibiao.eMan=name;
    	    xinlianxibiao.eTel=way;
    	    lianxibiao.push(xinlianxibiao);
    	    //console.log(lianxibiao)
    	})
    	
    	/* var leixing=new Array();
    	var leixinga={
	    		yiji:undefined,
				erji:undefined,
	    } 
    	leixinga.yiji=$("#yijileixing").find("option:selected").val();*/
    	/* leixing.push(leixinga); */
    	if(lianxibiao.length!=0){
    		
    	
    	    var yiji=$("#yijileixing").find("option:selected").val();
	    	var erji=$("#erjileixing").find("option:selected").val();
    		var taskName=$("#taskName").val();
        	var taskbianhao=$("#taskbianhao").val();
        	var moshi=$("#moshi").find("option:selected").val();
        	var gongsi=$("#gongsi").find("option:selected").val();
        	var shejijieduan=$("#shejijieduan").find("option:selected").val();
        	var yezhudanwei=$("#yezhudanwei").val();
        	var jine=$("#jine").val();
        	var hetonge=$("#hetonge").val();
        	var zandingjin=$("#zandingjin").val();
        	var startTime=$("#year").val();
        	var endTime=$("#year2").val();
        	var zhuban=$("#zhuban").val();
        	var zhubanjine=$("#zhubanjine").val();
        	var xieban1=$("#xieban1").find("option:selected").val();
        	var xieban1jine=$("#xieban1jine").val();
        	var xieban2=$("#xieban2").find("option:selected").val();
        	var xieban2jine=$("#xieban2jine").val();
        	var xieban3=$("#xieban3").find("option:selected").val();
        	var xieban3jine=$("#xieban3jine").val();
        	var gaikuang=$("#gaikuang").val();
        	
    	    var xindanwei={
    	    		prjType1:undefined,
    	    		prjType2:undefined,
    	    		prjNo:undefined,
    	    		prjName:undefined,
	            	prjManagementModel:undefined,
	            	prjCompany:undefined,
	            	jsPhases:undefined,
	            	prjOwnerUnit:undefined,
	            	workContent:undefined,
	            	prjEstimateMoney:undefined,
	            	contractMoney:undefined,
	            	provisionalSum:undefined,
	            	prjStartTime:undefined,
	            	prjEndTime:undefined,
	            	mainDepartment:undefined,
	            	mainDepartmentMoney:undefined,
	            	assistDepartment1:undefined,
	            	assistDepartment1Money:undefined,
	            	assistDepartment2:undefined,
	            	assistDepartment2Money:undefined,
	            	assistDepartment3:undefined,
	            	assistDepartment3Money:undefined,
	            	enterprise:undefined,
   			}


    	    //xindanwei.prjType=$("#erjileixing").find("option:selected").val(),

    	    xindanwei.prjType1=yiji,
    	    xindanwei.prjType2=erji,
    	    xindanwei.prjNo=taskbianhao,
    	    xindanwei.prjName=taskName,
    	    xindanwei.prjManagementModel=moshi,
    	    xindanwei.prjCompany=gongsi,
    	    xindanwei.jsPhases=shejijieduan,
    	    xindanwei.prjOwnerUnit=yezhudanwei,
    	    xindanwei.workContent=gaikuang,
    	    xindanwei.prjEstimateMoney=jine,
    	    xindanwei.contractMoney=hetonge,
    	    xindanwei.provisionalSum=zandingjin,
    	    xindanwei.prjStartTime=startTime,
    	    xindanwei.prjEndTime=endTime,
    	    xindanwei.mainDepartment=zhuban,
    	    xindanwei.mainDepartmentMoney=zhubanjine,
    	    xindanwei.assistDepartment1=xieban1,
    	    xindanwei.assistDepartment1Money=xieban1jine,
    	    xindanwei.assistDepartment2=xieban2,
    	    xindanwei.assistDepartment2Money=xieban2jine,
    	    xindanwei.assistDepartment3=xieban3,
    	    xindanwei.assistDepartment3Money=xieban3jine,
    	    xindanwei.enterprise=lianxibiao,
    	    danwei.push(xindanwei);
    		console.log(danwei)
    		
    	      $.ajax({
	            type: 'POST',
	            url: getContextPath()+'/task/addTask',
	            dataType: 'json',
	            contentType: "application/json", 
	            data:JSON.stringify(danwei),
	            success: function (json) {
	            	if(json==0){
	            		
	            	}else{
	            		location.reload([true]);
		            	 //$('#mainContent').DataTable().row.add().draw(false);     //新增行立即显示
	            	}
	            }
	        });
    	//$('#myModal').modal('hide');
    	}else{
    		alert("请至少输入一条联系人联系方式")
    	}
    	quxiao();
    }
 
  //判别是否要弹出提交人
  /* function panbietijiao(){
	  $.ajax({
          type: 'POST',
          url: getContextPath()+'/flow/submitFlow',
          dataType: 'json',
          data:{},
          success: function (json) {
        	  console.log(json);
        	 if(json.receiver!=null){
        		  $("#tijiaogei").modal('show');
        		  for(var i=0;i<json.receiver.length;i++){
        			  $("#tijiaoren").append("<input type='radio' name='tijiaorenming' data-id='"+json.receiver[i].userId+"' value='"+json.receiver[i].userId+"'>"+json.receiver[i].uName+"&nbsp&nbsp&nbsp&nbsp&nbsp");
        		  }
        	  }else{
        		  tijiaorenwudan();
        	  }
          }
      });
	  
  } */
  //提交任务单
  var lianjie;
    function tijiaorenwudan(){
    	var danwei= new Array();
    	var lianxibiao= new Array();
    	$("#lianxibiaoge tbody").find("tr").each(function(){
    		var tdArr = $(this).children();
    		var name = tdArr.eq(0).text();
    	    var way = tdArr.eq(1).text();
    	    
    	    var xinlianxibiao={
    	    		eId:undefined,
    				eMan:undefined,
    				eTel:undefined
    	    }
    	    xinlianxibiao.eId=null;
    	    xinlianxibiao.eMan=name;
    	    xinlianxibiao.eTel=way;
    	    lianxibiao.push(xinlianxibiao);
    	    //console.log(lianxibiao)
    	})
   	if(lianxibiao.length!=0){
	   
    	    var yiji=$("#yijileixing").find("option:selected").val();
	    	var erji=$("#erjileixing").find("option:selected").val();
    		var taskName=$("#taskName").val();
        	var taskbianhao=$("#taskbianhao").val();
        	var moshi=$("#moshi").find("option:selected").val();
        	var gongsi=$("#gongsi").find("option:selected").val();
        	var shejijieduan=$("#shejijieduan").find("option:selected").val();
        	var yezhudanwei=$("#yezhudanwei").val();
        	var jine=$("#jine").val();
        	var hetonge=$("#hetonge").val();
        	var zandingjin=$("#zandingjin").val();
        	var startTime=$("#year").val();
        	var endTime=$("#year2").val();
        	var zhuban=$("#zhuban").val();
        	var zhubanjine=$("#zhubanjine").val();
        	var xieban1=$("#xieban1").find("option:selected").val();
        	var xieban1jine=$("#xieban1jine").val();
        	var xieban2=$("#xieban2").find("option:selected").val();
        	var xieban2jine=$("#xieban2jine").val();
        	var xieban3=$("#xieban3").find("option:selected").val();
        	var xieban3jine=$("#xieban3jine").val();
        	var gaikuang=$("#gaikuang").val();
        	
    	    var xindanwei={
    	    		prjType1:undefined,
    	    		prjType2:undefined,
    	    		prjNo:undefined,
    	    		prjName:undefined,
	            	prjManagementModel:undefined,
	            	prjCompany:undefined,
	            	jsPhases:undefined,
	            	prjOwnerUnit:undefined,
	            	workContent:undefined,
	            	prjEstimateMoney:undefined,
	            	contractMoney:undefined,
	            	provisionalSum:undefined,
	            	prjStartTime:undefined,
	            	prjEndTime:undefined,
	            	mainDepartment:undefined,
	            	mainDepartmentMoney:undefined,
	            	assistDepartment1:undefined,
	            	assistDepartment1Money:undefined,
	            	assistDepartment2:undefined,
	            	assistDepartment2Money:undefined,
	            	assistDepartment3:undefined,
	            	assistDepartment3Money:undefined,
	            	enterprise:undefined,
   			}

    	    xindanwei.prjType1=$("#yijileixing").find("option:selected").val();
    	    xindanwei.prjType2=$("#erjileixing").find("option:selected").val();
    	    xindanwei.prjNo=taskbianhao;
    	    xindanwei.prjName=taskName;
    	    xindanwei.prjManagementModel=moshi;
    	    xindanwei.prjCompany=gongsi;
    	    xindanwei.jsPhases=shejijieduan;
    	    xindanwei.prjOwnerUnit=yezhudanwei;
    	    xindanwei.workContent=gaikuang;
    	    xindanwei.prjEstimateMoney=jine;
    	    xindanwei.contractMoney=hetonge;
    	    xindanwei.provisionalSum=zandingjin;
    	    xindanwei.prjStartTime=startTime;
    	    xindanwei.prjEndTime=endTime;
    	    xindanwei.mainDepartment=zhuban;
    	    xindanwei.mainDepartmentMoney=zhubanjine;
    	    xindanwei.assistDepartment1=xieban1;
    	    xindanwei.assistDepartment1Money=xieban1jine;
    	    xindanwei.assistDepartment2=xieban2;
    	    xindanwei.assistDepartment2Money=xieban2jine;
    	    xindanwei.assistDepartment3=xieban3;
    	    xindanwei.assistDepartment3Money=xieban3jine;
    	    xindanwei.enterprise=lianxibiao;
    	    danwei.push(xindanwei);
    		//console.log(danwei)
    		
    	      $.ajax({
	            type: 'POST',
	            url: getContextPath()+'/task/addTask3',
	            dataType: 'json',
	            contentType: "application/json", 
	            data:JSON.stringify(danwei),
	            success: function (json) {
	            	if(json.receiver!=null){
	            		//console.log(json)
	            		lianjie=json.url;
		        		  $("#tijiaogei").modal('show');
		        		  $("#tijiaoren").empty("");
		        		  for(var i=0;i<json.receiver.length;i++){
		        			  $("#tijiaoren").append("<input type='radio' name='tijiaorenming' data-id='"+json.receiver[i].userId+"' value='"+json.receiver[i].uName+"'>"+json.receiver[i].uName+"&nbsp&nbsp&nbsp&nbsp&nbsp");
		        		  }
		        	  }
	            }
	        }); 
    	//$('#myModal').modal('hide');
   		}else{
   			alert("请至少输入一条联系人联系方式")
   		}
    	quxiao();
    }
  function tijiaorenwudan2(){
	  var uid=$("input[name='tijiaorenming']:checked").attr("data-id");
	  var uname=$("input[name='tijiaorenming']:checked").val();
	  //console.log(uid,uname);
	 $.ajax({
          type: 'POST',
          url: getContextPath()+'/task/addTask4',
          dataType: 'json',
          data:{
        	  url:lianjie,
        	  userId:uid,
        	  uName:uname,
          },
          success: function (json) {
        	  location.reload([true]);
        	  toastr.success('提交成功');
          }
      }); 
	
  }
    //修改任务单
    var xiugaiid;
    $('#mainContent').delegate('#Changedanwei','click', function () {

        $("#diyi").removeClass("active");
        $("#disan").addClass("active");
        $("#diyi a").show();
        $("#disan a").show();
        $("#home").removeClass("active");
        $("#messages").addClass("active");

  		var dom = $(this).parents('tr');
		var data=$('#mainContent').DataTable().row(dom).data();
		xiugaiid=data.prjId;
			//console.log(data)
	  		$.ajax({
	            type: 'POST',
	            url: getContextPath()+'/task/selectTaskById',
	            dataType: 'json',
	            data: {
	            	id:data.prjId
	            },
	            success: function (json) {
	            	//console.log(json)
	            	var yijiji=$("#xgyijileixing").val(json.prjType1);
	            	$("#xgyijileixing").trigger("change");
	            	var erji=$("#xgerjileixing").val(json.prjType2);
	        		var taskName=$("#xgtaskName").val(json.prjName);
	            	var taskbianhao=$("#xgtaskbianhao").val(json.prjNo);
	            	var moshi=$("#xgmoshi").val(json.prjManagementModel);
	            	var gongsi=$("#xggongsi").val(json.prjCompany);
	            	var shejijieduan=$("#xgshejijieduan").val(json.jsPhases);
	            	var yezhudanwei=$("#xgyezhudanwei").val(json.prjOwnerUnit);
	            	var jine=$("#xgjine").val(json.prjEstimateMoney);
	            	var hetonge=$("#xghetonge").val(json.contractMoney);
	            	var zandingjin=$("#xgzandingjin").val(json.provisionalSum);
	            	var startTime=$("#xgstartTime").val(json.prjStartTime);
	            	var endTime=$("#xgendTime").val(json.prjEndTime);
	            	var zhuban=$("#xgzhuban").val(json.mainDepartment);
	            	var zhubanjine=$("#xgzhubanjine").val(json.mainDepartmentMoney);
	            	var xieban1=$("#xgxieban1").val(json.assistDepartment1);
	            	var xieban1jine=$("#xgxiebanjine").val(json.assistDepartment1Money);
	            	var xieban2=$("#xgxieban2").val(json.assistDepartment2);
	            	var xieban2jine=$("#xgxieban2jine").val(json.assistDepartment2Money);
	            	var xieban3=$("#xgxieban3").val(json.assistDepartment3);
	            	var xieban3jine=$("#xgxieban3jine").val(json.assistDepartment3Money);
	            	var gaikuang=$("#xggaikuang").val(json.workContent);
	            	
	            	$("#xglianxibiaoge tbody").empty("");
	            	for(var i=0;i<json.enterprise.length;i++){
	            		$("#xglianxibiaoge").append("<tr><td>"
												    			+'<input type="text" class="form-control" value="'+json.enterprise[i].eMan+'">'
												    			+"</td><td>"
												    			+'<input type="text" class="form-control" value='+json.enterprise[i].eTel+'>'
												    			+"</td></tr>")
	            	}
	            }
	        });	
  		
    	});
    function xgaddrenwudan(){
    	var danwei= new Array();
    	var lianxibiao= new Array();
    	$("#xglianxibiaoge tbody").find("tr").each(function(){
    		var tdArr = $(this).children();
    		var name = tdArr.eq(0).find("input").val();
    	    var way = tdArr.eq(1).find("input").val();
    	   
    	    var xinlianxibiao={
    	    		eId:undefined,
    				eMan:undefined,
    				eTel:undefined
    	    }
    	    xinlianxibiao.eId=null;
    	    xinlianxibiao.eMan=name;
    	    xinlianxibiao.eTel=way;
    	    lianxibiao.push(xinlianxibiao);
    	   // console.log(lianxibiao)
    	})
    	
    		var yijiji=$("#xgyijileixing").find("option:selected").val();
           	var erji=$("#xgerjileixing").find("option:selected").val();
    		var taskName=$("#xgtaskName").val();
        	var taskbianhao=$("#xgtaskbianhao").val();
        	var moshi=$("#xgmoshi").find("option:selected").val();
        	var gongsi=$("#xggongsi").find("option:selected").val();
        	var shejijieduan=$("#xgshejijieduan").find("option:selected").val();
        	var yezhudanwei=$("#xgyezhudanwei").val();
        	var jine=$("#xgjine").val();
        	var hetonge=$("#xghetonge").val();
        	var zandingjin=$("#xgzandingjin").val();
        	var startTime=$("#xgstartTime").val();
        	var endTime=$("#xgendTime").val();
        	var zhuban=$("#xgzhuban").val();
        	var zhubanjine=$("#xgzhubanjine").val();
        	var xieban1=$("#xgxieban1").find("option:selected").val();
        	var xieban1jine=$("#xgxiebanjine").val();
        	var xieban2=$("#xgxieban2").find("option:selected").val();
        	var xieban2jine=$("#xgxieban2jine").val();
        	var xieban3=$("#xgxieban3").find("option:selected").val();
        	var xieban3jine=$("#xgxieban3jine").val();
        	var gaikuang=$("#xggaikuang").val();
        	
    	    var xindanwei={
    	    		prjType1:undefined,
    	    		prjType2:undefined,
    	    		prjNo:undefined,
    	    		prjName:undefined,
	            	prjManagementModel:undefined,
	            	prjCompany:undefined,
	            	jsPhases:undefined,
	            	prjOwnerUnit:undefined,
	            	workContent:undefined,
	            	prjEstimateMoney:undefined,
	            	contractMoney:undefined,
	            	provisionalSum:undefined,
	            	prjStartTime:undefined,
	            	prjEndTime:undefined,
	            	mainDepartment:undefined,
	            	mainDepartmentMoney:undefined,
	            	assistDepartment1:undefined,
	            	assistDepartment1Money:undefined,
	            	assistDepartment2:undefined,
	            	assistDepartment2Money:undefined,
	            	assistDepartment3:undefined,
	            	assistDepartment3Money:undefined,
	            	enterprise:undefined,
	            	prjId:undefined,
   			}
    	    xindanwei.prjType1=yijiji;
    	    xindanwei.prjType2=erji;
    	    xindanwei.prjNo=taskbianhao;
    	    xindanwei.prjName=taskName;
    	    xindanwei.prjManagementModel=moshi;
    	    xindanwei.prjCompany=gongsi;
    	    xindanwei.jsPhases=shejijieduan;
    	    xindanwei.prjOwnerUnit=yezhudanwei;
    	    xindanwei.workContent=gaikuang;
    	    xindanwei.prjEstimateMoney=jine;
    	    xindanwei.contractMoney=hetonge;
    	    xindanwei.provisionalSum=zandingjin;
    	    xindanwei.prjStartTime=startTime;
    	    xindanwei.prjEndTime=endTime;
    	    xindanwei.mainDepartment=zhuban;
    	    xindanwei.mainDepartmentMoney=zhubanjine;
    	    xindanwei.assistDepartment1=xieban1;
    	    xindanwei.assistDepartment1Money=xieban1jine;
    	    xindanwei.assistDepartment2=xieban2;
    	    xindanwei.assistDepartment2Money=xieban2jine;
    	    xindanwei.assistDepartment3=xieban3;
    	    xindanwei.assistDepartment3Money=xieban3jine;
    	    xindanwei.enterprise=lianxibiao;
    	    xindanwei.prjId=xiugaiid;
    	    danwei.push(xindanwei);
    		//console.log(danwei)
    		
    	      $.ajax({
	            type: 'POST',
	            url: getContextPath()+'/task/updateTask2',
	            dataType: 'json',
	            contentType: "application/json", 
	            data:JSON.stringify(danwei),
	            success: function (json) {
	            	if(json==0){
	            		
	            	}else{
	            		location.reload([true]);
		            	 //$('#mainContent').DataTable().row.add().draw(false);     //新增行立即显示
	            	}
	            }
	        }); 
    	      quxiao2();
    }
    
    
    function xgsaverenwudan(){
    	var danwei= new Array();
    	var lianxibiao= new Array();
    	$("#xglianxibiaoge tbody").find("tr").each(function(){
    		var tdArr = $(this).children();
    		var name = tdArr.eq(0).find("input").val();
    	    var way = tdArr.eq(1).find("input").val();
    	   
    	    var xinlianxibiao={
    	    		eId:undefined,
    				eMan:undefined,
    				eTel:undefined
    	    }
    	    xinlianxibiao.eId=null;
    	    xinlianxibiao.eMan=name;
    	    xinlianxibiao.eTel=way;
    	    lianxibiao.push(xinlianxibiao);
    	   // console.log(lianxibiao)
    	})
    	
    		var yijiji=$("#xgyijileixing").find("option:selected").val();
           	var erji=$("#xgerjileixing").find("option:selected").val();
    		var taskName=$("#xgtaskName").val();
        	var taskbianhao=$("#xgtaskbianhao").val();
        	var moshi=$("#xgmoshi").find("option:selected").val();
        	var gongsi=$("#xggongsi").find("option:selected").val();
        	var shejijieduan=$("#xgshejijieduan").find("option:selected").val();
        	var yezhudanwei=$("#xgyezhudanwei").val();
        	var jine=$("#xgjine").val();
        	var hetonge=$("#xghetonge").val();
        	var zandingjin=$("#xgzandingjin").val();
        	var startTime=$("#xgstartTime").val();
        	var endTime=$("#xgendTime").val();
        	var zhuban=$("#xgzhuban").val();
        	var zhubanjine=$("#xgzhubanjine").val();
        	var xieban1=$("#xgxieban1").find("option:selected").val();
        	var xieban1jine=$("#xgxiebanjine").val();
        	var xieban2=$("#xgxieban2").find("option:selected").val();
        	var xieban2jine=$("#xgxieban2jine").val();
        	var xieban3=$("#xgxieban3").find("option:selected").val();
        	var xieban3jine=$("#xgxieban3jine").val();
        	var gaikuang=$("#xggaikuang").val();
        	
    	    var xindanwei={
    	    		prjType1:undefined,
    	    		prjType2:undefined,
    	    		prjNo:undefined,
    	    		prjName:undefined,
	            	prjManagementModel:undefined,
	            	prjCompany:undefined,
	            	jsPhases:undefined,
	            	prjOwnerUnit:undefined,
	            	workContent:undefined,
	            	prjEstimateMoney:undefined,
	            	contractMoney:undefined,
	            	provisionalSum:undefined,
	            	prjStartTime:undefined,
	            	prjEndTime:undefined,
	            	mainDepartment:undefined,
	            	mainDepartmentMoney:undefined,
	            	assistDepartment1:undefined,
	            	assistDepartment1Money:undefined,
	            	assistDepartment2:undefined,
	            	assistDepartment2Money:undefined,
	            	assistDepartment3:undefined,
	            	assistDepartment3Money:undefined,
	            	enterprise:undefined,
	            	prjId:undefined,
   			}
    	    xindanwei.prjType1=yijiji;
    	    xindanwei.prjType2=erji;
    	    xindanwei.prjNo=taskbianhao;
    	    xindanwei.prjName=taskName;
    	    xindanwei.prjManagementModel=moshi;
    	    xindanwei.prjCompany=gongsi;
    	    xindanwei.jsPhases=shejijieduan;
    	    xindanwei.prjOwnerUnit=yezhudanwei;
    	    xindanwei.workContent=gaikuang;
    	    xindanwei.prjEstimateMoney=jine;
    	    xindanwei.contractMoney=hetonge;
    	    xindanwei.provisionalSum=zandingjin;
    	    xindanwei.prjStartTime=startTime;
    	    xindanwei.prjEndTime=endTime;
    	    xindanwei.mainDepartment=zhuban;
    	    xindanwei.mainDepartmentMoney=zhubanjine;
    	    xindanwei.assistDepartment1=xieban1;
    	    xindanwei.assistDepartment1Money=xieban1jine;
    	    xindanwei.assistDepartment2=xieban2;
    	    xindanwei.assistDepartment2Money=xieban2jine;
    	    xindanwei.assistDepartment3=xieban3;
    	    xindanwei.assistDepartment3Money=xieban3jine;
    	    xindanwei.enterprise=lianxibiao;
    	    xindanwei.prjId=xiugaiid;
    	    danwei.push(xindanwei);
    		//console.log(danwei)
    		
    	      $.ajax({
	            type: 'POST',
	            url: getContextPath()+'/task/updateTask',
	            dataType: 'json',
	            contentType: "application/json", 
	            data:JSON.stringify(danwei),
	            success: function (json) {
	            	console.log(json);
	            	if(json==0){
	            		
	            	}else{
	            		location.reload([true]);
		            	 //$('#mainContent').DataTable().row.add().draw(false);     //新增行立即显示
	            	}
	            }
	        }); 
    	      quxiao2();
    }
    
    
    
  //查看单个具体信息
  	$('#mainContent').delegate('#lookDetall','click', function () {

        $("#diyi").removeClass("active");
        $("#disi").addClass("active");
        $("#diyi a").show();
        $("#disi a").show();
        $("#home").removeClass("active");
        $("#settings").addClass("active");

  		var dom = $(this).parents('tr');
		var data=$('#mainContent').DataTable().row(dom).data();
  		//console.log(data)
  		
		 $.ajax({
            type: 'POST',
            url: getContextPath()+'/task/ selectTaskById',
            dataType: 'json',
            data: {
            	id:data.prjId
            },
            success: function (json) {
            	//console.log(json)
            	$("#looktaskName").text(json.prjName);
            	$("#looktaskbianhao").text(json.prjNo);
            	$("#lookmoshi").text(json.prjManagementModel);
            	$("#lookgongsi").text(json.prjCompany);
            	$("#lookleixing").text(json.prjType2);
            	$("#lookshejijieduan").text(json.jsPhases);
            	$("#lookyezhudanwei").text(json.prjOwnerUnit);
            	$("#lookjine").text(json.prjEstimateMoney);
            	$("#lookhetonge").text(json.contractMoney);
            	$("#lookzandingjin").text(json.provisionalSum);
            	$("#lookstartTime").text(json.prjStartTime);
            	$("#lookendTime").text(json.prjEndTime);
            	$("#lookzhuban").text(json.omName);
            	$("#lookzhubanjine").text(json.mainDepartmentMoney);
            	$("#lookxieban1").text(json.name1);
            	$("#lookxiebanjine").text(json.assistDepartment1Money);
            	$("#lookxieban2").text(json.name2);
            	$("#lookxieban2jine").text(json.assistDepartment2Money);
            	$("#lookxieban3").text(json.name3);
            	$("#lookxieban3jine").text(json.assistDepartment3Money);
            	$("#lookgaikuang").text(json.workContent);
            	
            	$("#looklianxibiaoge tbody").empty("");
            	for(var i=0;i<json.enterprise.length;i++){
            		$("#looklianxibiaoge").append("<tr><td>"
											    			+json.enterprise[i].eMan
											    			+"</td><td>"
											    			+json.enterprise[i].eTel
											    			+"</td></tr>")
            	}
            }
        }); 
  	})
    
  	//项目中止
  	$('#mainContent').delegate('#stopTask','click', function () {
  		var dom = $(this).parents('tr');
		var data=$('#mainContent').DataTable().row(dom).data();
  		$.ajax({
            type: 'POST',
            url: getContextPath()+'',
            dataType: 'json',
            data: {
            	id:data.prjId
            },
            success: function (json) {
            	console.log(json);
            	if(json==0){
            		
            	}else{
            		$('#mainContent').DataTable().row(dom).remove().draw(true); //删除行立即显示
            	}
            }
        }); 
  	})

  	//项目完结
  	$('#mainContent').delegate('#finishTask','click', function () {
  		var dom = $(this).parents('tr');
		var data=$('#mainContent').DataTable().row(dom).data();
  		$.ajax({
            type: 'POST',
            url: getContextPath()+'',
            dataType: 'json',
            data: {
            	id:data.prjId
            },
            success: function (json) {
            	console.log(json);
            	if(json==0){
            		
            	}else{
            		$('#mainContent').DataTable().row(dom).remove().draw(true); //删除行立即显示
            	}
            }
        }); 
  		
  	})
  	
  		
  
</script>

</html>