<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../../font2/iconfont.css">
    <link rel="stylesheet" href="../../font3/iconfont.css">
	<link href="../../style/bootstrap.min.css" rel="stylesheet">
    <link href="../../style/style.css" rel="stylesheet">
    <link href="../../toastr/toastr.css" rel="stylesheet">
    <link rel="stylesheet" href="../../style/jquery.dataTables.min.css">
    <link rel="stylesheet" href="../../style/jquery-editable-select.css">
    <style lang="">
        .UpperPart{
            display: flex;
            justify-content:space-between;
            border-bottom: 1px solid #ccc;
            padding-bottom: 12px;
        }
        .selected{
            background: rgba(247, 161, 3,0.2);
        }
        #mainContent th{
            cursor: pointer;
        }
        
        
		div input[type=radio]{
			width:20px;
			height:20px;
			margin-left: 8px;
		}
    </style>
</head>
<body>
    
    <!-- 面包屑 -->
    <div class="mianbao">
    	<ul class="breadcrumb">
    		<li><i class="iconfont icon-knowledgebase"></i></li>
            <li>生产管理</li>
            <li>合同履约</li>
			<li class="active">劳务分包合同</li>
		</ul>
    </div>

    <div>
           
        <!-- Tab panes -->
        <div>
          <!-- Modal选择分包合同 -->
		<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="choose_fb">
		    <div class="modal-dialog modal-lg" role="document" style="width:60%;">
		        <div class="modal-content">
		        <div class="modal-header">
		            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		            <h4 class="modal-title" id="myModalLabel"><b>选择分包合同</b></h4>
		        </div>
		        <div class="modal-body">
		                <div>     
		                    <form class="form-inline">
		                        <table class="table table-bordered table-condensed" id="fb_table">
		                            <thead>
		                            	<tr>
		                            		<th></th>
		                            		<th>分包合同名称</th>
		                                    <th>分包合同编号</th>
		                                    <th>甲方单位</th>
		                                    <th>合同起日期</th>
		                                    <th>合同讫日期</th>
		                            	</tr>
		                            </thead>
		                            <tbody>
		                                
		                            </tbody>
		                        </table> 
		                    </form>  
		                </div>
		        </div>
		        <div class="modal-footer">
		            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
		            <button type="button" class="btn btn-success" onclick="saveFbName()">保存</button>
		        </div>
		        </div>
		    </div>
		</div>
		<!-- model项目结束 -->
<!--选人 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="addGuanliren">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">选择实际负责人</h4>
            </div>
            <div class="modal-body">
                <form class="form-inline">
                    <div class="form-group">
                        <div>
                            <span>部门:</span>
                            <select style="width:180px;" id="bumen" class="form-control" >
                                
                            </select>
                        </div>
                    </div>
                </form>
                <div>
                     <table class="table table-bordered table-condensed"  id="bmmingzibiao" >
                     	<thead>
		   					<tr>
		   						<th></th>
		   						<th>姓名</th>
		   						<th>工号</th>
		   						<th>出生日期</th>
		   						<th>性别</th>
		   						<th>职务</th>
		   					</tr>
		   				</thead>
		   				<tbody></tbody>
                     </table>
              </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveGuanliren()" data-dismiss="modal">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 选人 modal结束 -->   

           <!-- 2 -->
           <form class="form-inline" id="form_fb" method="post" enctype="multipart/form-data">
                        <table class="table table-bordered table-condensed">
                        	<tr>
                                <td style="width:18%;">分包合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <!-- <select class="form-control" style="width:80%;"  id="fbContractName">
                                    </select> -->
                                    <input type="text" class="form-control" id="fbContractName2" disabled style="width:60%;">
                                    <button type="button" class="btn btn-primary weui-uploader__input" onclick="chooseFb2()">选择分包</button>
                                </td>
                                <td style="width:18%;">分包合同号</td>
                                <td>
                                	<select class="form-control" style="width:75%;"  id="fbContract2">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                            	<td class="jinqianyanse">分包合同金额</td>
                            	<td><input type="text" class="form-control" id="fb_money2" disabled style="width:60%;"></td>
                            	<td class="jinqianyanse">结算金额</td>
                            	<td><input type="text" class="form-control" id="fb_end_money2" style="width:75%;"></td>
                            </tr>
                            <tr>
                                <td class="jingyongkk">承接合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <!-- <select class="form-control" style="width:80%;" id="cjContractName">
                                    </select> -->
                                    <input type="text" class="form-control" style="width:60%;" disabled id="cjContractName2">
                                    <!-- <button type="button" class="btn btn-primary weui-uploader__input" onclick="select_cj3()">选择承接</button> -->
                                </td>
                                <td class="jingyongkk">承接合同编号</td>
                                <td>
                                	<input type="text" class="form-control" style="width:75%;" disabled id="cjContract2">
                                	<!-- <select class="form-control" style="width:60%;" id="cjContract">
                                    </select> -->
                                </td>
                            </tr>
                            <tr>
                                <td class="jingyongkk">任务单号</td>
                                <td><input type="text" class="form-control" style="width:60%;" id="prjCode2" disabled></td>
                                <!-- <td>审计结算类型</td>
                                <td>
                                    <select class="form-control" style="width:75%;" id="sj_type">
                                        <option value="中间结算">中间结算</option>
                                        <option value="最终结算">最终结算</option>
                                    </select>
                                </td> -->
                                <td>时间</td>
                                <td><input type="text" style="width:75%;" class="form-control" id="year"></td>
                            </tr>
                            <tr>
                            	<td>前期经营费用(元)</td>
                                <td><input type="text" style="width:60%;" class="form-control" id="qianqijyfy">
                                	<input type="checkbox" style="width:15px;height:15px;"  name="sfkouchu">是否扣除
                                </td>
                            </tr>
                            <!-- <tr>
                                <td style="width:15%;">项目名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:35%;">
                                    <select class="form-control" style="width:80%;"  id="prj_name">
                                    </select>
                                    <input type="text" class="form-control" id="prj_name" disabled  style="width:65%;">
                               		<button type="button"  class="btn btn-primary"  id="chosexm">选择项目</button>
                                </td>
                                <td style="width:15%;">任务单号</td>
                                <td style="width:35%;">
                                	<select class="form-control" style="width:65%;"  id="prj_no2">
                                		
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>分包合同  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" style="width:65%;" id="fb_name2">
                                    </select>
                                    <input type="text" class="form-control" id="fb_name2" disabled style="width:65%;">
                                    <button type="button" class="btn btn-primary weui-uploader__input" onclick="chooseFb2()">选择分包</button>
                                </td>
                                <td>承接合同  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" style="width:65%;"  id="cj_name2">
                                    </select>
                                    <input type="text" class="form-control" style="width:65%;" disabled id="cj_name2">
                                    <button type="button" class="btn btn-primary weui-uploader__input" onclick="select_cj2()">选择承接</button>
                                </td>
                            </tr> -->
                            <tr>
                                <td>内容概述</td>
                                <td colspan="3">
                                     <textarea class="form-control" rows="4" style="width:100%;" id="work_info2"></textarea>
                                </td>
                            </tr>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory">
							<thead>
								<tr>
	                                <td style="width:15%;">分包结算单:  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
	                                <td colspan="2">
	                                    <button type="button" class="btn btn-primary" onclick="new_accessory()">增加附件</button>
	                                </td>
                            	</tr>
							</thead>
							<tbody></tbody>
						</table>
						<!-- <table class="table table-bordered table-condensed" id="new_accessory1">
							<thead>
								<tr>
	                                <td style="width:15%;">法律顾问签字:  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
	                                <td colspan="2">
	                                    <button type="button" class="btn btn-primary" onclick="new_accessory1()">增加附件</button>
	                                </td>
                            	</tr>
							</thead>
							<tbody></tbody>
						</table> -->
                    </form>   
                    
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal2">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>新建分包结算申请</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" onclick="save2()">保存</button>
            <button type="button" class="btn btn-success" onclick="submit2()">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- model结束 -->
<!-- Modal选择分包合同 -->
		<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="choose_fb2">
		    <div class="modal-dialog modal-lg" role="document" style="width:60%;">
		        <div class="modal-content">
		        <div class="modal-header">
		            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		            <h4 class="modal-title" id="myModalLabel"><b>选择分包合同</b></h4>
		        </div>
		        <div class="modal-body">
		                <div>     
		                    <form class="form-inline">
		                        <table class="table table-bordered table-condensed" id="fb_table2">
		                            <thead>
		                            	<tr>
		                            		<th></th>
		                            		<th>分包合同名称</th>
		                                    <th>分包合同编号</th>
		                                    <th>甲方单位</th>
		                                    <th>合同起日期</th>
		                                    <th>合同讫日期</th>
		                            	</tr>
		                            </thead>
		                            <tbody>
		                                
		                            </tbody>
		                        </table> 
		                    </form>  
		                </div>
		        </div>
		        <div class="modal-footer">
		            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
		            <button type="button" class="btn btn-success" onclick="saveFbName2()">保存</button>
		        </div>
		        </div>
		    </div>
		</div>
		<!-- model项目结束 -->
<!-- Modal项目 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="xiangmumd">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>选择项目</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed" id="xiangmubiao">
                            <thead>
                            	<tr>
                            		<th></th>
                            		<th>编号</th>
                                    <th>项目名称</th>
                                    <th>项目所属公司</th>
                                    <th>项目类型</th>
                                    <th>甲方单位</th>
                            	</tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table> 
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" id="quedingxm">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- model项目结束 -->
<!-- Modal选择承接合同 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="choose_cj2">
    <div class="modal-dialog modal-lg" role="document" style="width:60%;">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>选择承接合同</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed" id="cj_table2">
                            <thead>
                            	<tr>
                            		<th></th>
                            		<th>承接合同名称</th>
                                    <th>承接合同编号</th>
                                    <th>甲方单位</th>
                                    <th>合同起日期</th>
                                    <th>合同讫日期</th>
                            	</tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table> 
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" onclick="saveCjName2()">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- model项目结束 -->


        </div>
    </div>
    <!-- 2 -->
    <!-- Modal选择承接合同 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="choose_fb3">
    <div class="modal-dialog modal-lg" role="document" style="width:60%;">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>选择分包合同</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed" id="fb_table3">
                            <thead>
                            	<tr>
                            		<th></th>
                            		<th>分包合同名称</th>
                                    <th>分包合同编号</th>
                                    <th>甲方单位</th>
                                    <th>合同起日期</th>
                                    <th>合同讫日期</th>
                            	</tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table> 
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" onclick="saveFbName3()">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- model项目结束 -->
<!--选人 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="addGuanliren2">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">选择项目负责人</h4>
            </div>
            <div class="modal-body">
                <form class="form-inline">
                    <div class="form-group">
                        <div>
                            <span>部门:</span>
                            <select style="width:180px;" id="bumen2" class="form-control" >
                                
                            </select>
                        </div>
                    </div>
                </form>
                <div>
                     <table class="table table-bordered table-condensed"  id="bmmingzibiao2" >
                     	<thead>
		   					<tr>
		   						<th></th>
		   						<th>姓名</th>
		   						<th>工号</th>
		   						<th>出生日期</th>
		   						<th>性别</th>
		   						<th>职务</th>
		   					</tr>
		   				</thead>
		   				<tbody></tbody>
                     </table>
              </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="savePrj()" data-dismiss="modal">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 选人 modal结束 -->
<!--选人 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="addGuanliren3">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">选择分包负责人</h4>
            </div>
            <div class="modal-body">
                <form class="form-inline">
                    <div class="form-group">
                        <div>
                            <span>部门:</span>
                            <select style="width:180px;" id="bumen3" class="form-control" >
                                
                            </select>
                        </div>
                    </div>
                </form>
                <div>
                     <table class="table table-bordered table-condensed"  id="bmmingzibiao3" >
                     	<thead>
		   					<tr>
		   						<th></th>
		   						<th>姓名</th>
		   						<th>工号</th>
		   						<th>出生日期</th>
		   						<th>性别</th>
		   						<th>职务</th>
		   					</tr>
		   				</thead>
		   				<tbody></tbody>
                     </table>
              </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveFb()" data-dismiss="modal">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 选人 modal结束 --> 




    <!-- Modal选择承接合同 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="choose_cj">
    <div class="modal-dialog modal-lg" role="document" style="width:60%;">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>选择承接合同</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed" id="cj_table">
                            <thead>
                            	<tr>
                            		<th></th>
                            		<th>承接合同名称</th>
                                    <th>承接合同编号</th>
                                    <th>甲方单位</th>
                                    <th>合同起日期</th>
                                    <th>合同讫日期</th>
                            	</tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table> 
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" onclick="saveCjName()">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- model项目结束 -->

  <!-- Modal选择承接合同 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="choose_cj3">
    <div class="modal-dialog modal-lg" role="document" style="width:60%;">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>选择承接合同</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline">
                        <table class="table table-bordered table-condensed" id="cj_table3">
                            <thead>
                            	<tr>
                            		<th></th>
                            		<th>承接合同名称</th>
                                    <th>承接合同编号</th>
                                    <th>甲方单位</th>
                                    <th>合同起日期</th>
                                    <th>合同讫日期</th>
                            	</tr>
                            </thead>
                            <tbody>
                                
                            </tbody>
                        </table> 
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" onclick="saveCjName3()">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- model项目结束 -->
    
</body>
<script src="../../js/jquery.js"></script>
<script src="../../js/common-scripts.js"></script>
<script src="../../js/jquery.dataTables.min.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/laydate/laydate.js"></script>
<script src="../../js/jquery-editable-select.js"></script>
<script src="../../toastr/toastr.js"></script>
<script src="../../js/jquery-form.min.js"></script>
<script src="../../js/quanxian.js"></script>
<script>
    $(document).ready( function () {
    	laydate.render({
            elem: '#year' //指定元素
        });
    	initSelect();
    	initFb3();
    	/* initUser(); */
    	
    	
    	
    	initDepartment();
    	initPrj();
    	initFb();
    	initCj();
    	initbumen();
    	
    	initTable();
    	   
    });
    function GetQueryString(name){
        var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if(r!=null)return  unescape(r[2]); return null;
   }
   // 调用方法
   	id=GetQueryString("prjId");
   
    var table1=$('#fb_table').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": null}, 
            { "data": "contractName"},
            { "data": "fbNo"}, 
            { "data": "ccName"}, 
            { "data": "contractStartTime"},
            { "data": "contractEndTime"}
        ],
        "columnDefs": [
						{
								 "class": "tcenter",
								    "targets": 0,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<input type="radio" name="fbName" style="width:16px;height:16px;">'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
   
    var table22=$('#xiangmubiao').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
					{ "data": null},
		            { "data": "prjNo"},
		            { "data": "prjName"},
		            { "data": "prjCompany"},
		            { "data": "prjType2"},
		            { "data": "ccName"},
		            
		        ],
		        "columnDefs": [
								{
										 "class": "tcenter",
										    "targets": 0,
										    "searchable": true,
										    "render": function(data, type, full) {
										  	  		return '<input type="radio" name="xiangmuName" style="width:16px;height:16px;">'
										        }
										  }
								],
        "order": [[1, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
    var table222=$('#cj_table2').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": null}, 
            { "data": "contractName"},
            { "data": "contractNo"}, 
            { "data": "ccName"}, 
            { "data": "contractStartTime"},
            { "data": "contractEndTime"}
        ],
        "columnDefs": [
						{
								 "class": "tcenter",
								    "targets": 0,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<input type="radio" name="cjName2" style="width:16px;height:16px;">'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
    var table2222=$('#fb_table2').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": null}, 
            { "data": "contractName"},
            { "data": "fbNo"}, 
            { "data": "ccName"}, 
            { "data": "contractStartTime"},
            { "data": "contractEndTime"}
        ],
        "columnDefs": [
						{
								 "class": "tcenter",
								    "targets": 0,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<input type="radio" name="fbName2" style="width:16px;height:16px;">'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
 
    
    var table4=$('#cj_table').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": null}, 
            { "data": "contractName"},
            { "data": "contractNo"}, 
            { "data": "ccName"}, 
            { "data": "contractStartTime"},
            { "data": "contractEndTime"}
        ],
        "columnDefs": [
						{
								 "class": "tcenter",
								    "targets": 0,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<input type="radio" name="cjName" style="width:16px;height:16px;">'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
    var table44=$('#fb_table3').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": null}, 
            { "data": "contractName"},
            { "data": "fbNo"}, 
            { "data": "ccName"}, 
            { "data": "contractStartTime"},
            { "data": "contractEndTime"}
        ],
        "columnDefs": [
						{
								 "class": "tcenter",
								    "targets": 0,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<input type="radio" name="fbName3" style="width:16px;height:16px;">'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
    
    var table444=$('#cj_table3').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 5,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": null}, 
            { "data": "contractName"},
            { "data": "contractNo"}, 
            { "data": "ccName"}, 
            { "data": "contractStartTime"},
            { "data": "contractEndTime"}
        ],
        "columnDefs": [
						{
								 "class": "tcenter",
								    "targets": 0,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<input type="radio" name="cjName3" style="width:16px;height:16px;">'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
    //选部门选人1
    var bmtableren=$('#bmmingzibiao').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
					{ "data": null}, 
		            { "data": "uName"}, 
		            { "data": "workId"},
		            { "data": "birthday"}, 
		            { "data": "sex"}, 
		            { "data": "dutyName"}, 
		        ],
		        "columnDefs": [
								{	
										 "class": "tcenter",
										    "targets": 0,
										    "searchable": true,
										    "render": function(data, type, full) {
										  	  		return '<input type="radio" name="mingzi" style="width:16px;height:16px;">'
										        }
										  }
								],
        "order": [[2, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});

    //选部门选人2
    var bmtableren=$('#bmmingzibiao2').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
					{ "data": null}, 
		            { "data": "uName"}, 
		            { "data": "workId"},
		            { "data": "birthday"}, 
		            { "data": "sex"}, 
		            { "data": "dutyName"}, 
		        ],
		        "columnDefs": [
								{	
										 "class": "tcenter",
										    "targets": 0,
										    "searchable": true,
										    "render": function(data, type, full) {
										  	  		return '<input type="radio" name="mingzi2" style="width:16px;height:16px;">'
										        }
										  }
								],
        "order": [[2, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});

    //选部门选人3
    var bmtableren=$('#bmmingzibiao3').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
					{ "data": null}, 
		            { "data": "uName"}, 
		            { "data": "workId"},
		            { "data": "birthday"}, 
		            { "data": "sex"}, 
		            { "data": "dutyName"}, 
		        ],
		        "columnDefs": [
								{	
										 "class": "tcenter",
										    "targets": 0,
										    "searchable": true,
										    "render": function(data, type, full) {
										  	  		return '<input type="radio" name="mingzi3" style="width:16px;height:16px;">'
										        }
										  }
								],
        "order": [[2, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});

    $("#state").on("change",function(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/fbScore/selectFbContractDoAppointScore',
            dataType: 'json',
            data: {
            	state:$("#state").val()
            },
            success: function (json) {
                $('#mainContent').dataTable().fnClearTable();
                $('#mainContent').DataTable().rows.add(json).draw(false);
            }
        });
    })
    
    function initTable2(){
   	 $("#state2").trigger("change");
   }
    
    function initTable3(){
   	 $("#state3").trigger("change");
   }
	
    $("#state2").on("change",function(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/fbOver/selectFbContractOver',
            dataType: 'json',
            data: {
            	state:$("#state2").val()
            },
            success: function (json) {
                $('#mainContent2').dataTable().fnClearTable();
                $('#mainContent2').DataTable().rows.add(json).draw(false);
            }
        });
    })
    

	
    $("#state3").on("change",function(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/fbOverWj/selectFbContractOverWj',
            dataType: 'json',
            data: {
            	state:$("#state3").val()
            },
            success: function (json) {
                $('#mainContent3').dataTable().fnClearTable();
                $('#mainContent3').DataTable().rows.add(json).draw(false);
            }
        });
    })


    //初始化承接合同名称和承接合同号
	 function initSelect(){
			$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/cj/selectNameAndNo',
	        dataType: 'json',
	        data: {
	        },
	        error: function (msg) {
	        	toastr.error("请求失败");
	        },
	        success: function (json) {
	        	$("#new_cj_name").html('');
	        	$("#new_cj_no").html('');
	        	/* $("#cjContractName").html('');
	        	$("#cjContract").html(''); */
	        	for(var i=0;i<json.length;i++){
	        		$("#new_cj_name").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
	        		$("#new_cj_no").append("<option value="+json[i].contractNo+">"+json[i].contractNo+"</option>");
	        		/* $("#cjContractName").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
	        		$("#cjContract").append("<option value="+json[i].contractNo+">"+json[i].contractNo+"</option>"); */
	        	}
	        	$('#new_cj_name').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByName',
	                    dataType: 'json',
	                    data: {
	                    	name:$('#new_cj_name').val()
	                    },
	                    success: function (json) {
	                    	$('#new_cj_no').val(json.contractNo);
	                    	$('#new_prj_no').val(json.taskCode);
	                    }
	          		});
	          	})
	          	$('#new_cj_no').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByNo',
	                    dataType: 'json',
	                    data: {
	                    	no:$('#new_cj_no').val()
	                    },
	                    success: function (json) {
	                    	$('#new_cj_name').val(json.contractName);
	                    	$('#new_prj_no').val(json.taskCode);
	                    }
	          		});
			  	})
			  	
			  	
	        }
			});
		}
    
    
    function initFb3(){
    	$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/subcontract/getFBNameAndNo',
	        dataType: 'json',
	        data: {
	        },
	        error: function (msg) {
	        	toastr.error("请求失败");
	        },
	        success: function (json) {
	        	console.log(json)
	        	$("#new_fb_name").html('');
	        	$("#new_fb_no").html('');
	        	$("#fbContractName").html('');
	        	$("#fbContract").html('');
	        	$("#fbContract2").html('');
	        	for(var i=0;i<json.length;i++){
	        		$("#new_fb_name").append("<option value="+json[i].contarctName+">"+json[i].contractName+"</option>");
	        		$("#new_fb_no").append("<option value="+json[i].fbNo+">"+json[i].fbNo+"</option>");
	        		/* $("#fbContractName").append("<option value="+json[i].contarctName+">"+json[i].contractName+"</option>"); */
	        		$("#fbContract").append("<option value="+json[i].fbNo+">"+json[i].fbNo+"</option>");
	        		$("#fbContract2").append("<option value="+json[i].fbNo+">"+json[i].fbNo+"</option>");
	        	}
	        	
	          	$('#new_fb_no').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/subcontract/getFBNameByNo',
	                    dataType: 'json',
	                    data: {
	                    	fbNo:$('#new_fb_no').val()
	                    },
	                    success: function (json) {
	                    	$('#new_fb_name').val(json.contractName);
	                    	$('#new_fb_department').val(json.ccName);
	                    }
	          		});
			  	})
			  	
	          	$('#fbContract').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/subcontract/getFBNameByNo',
	                    dataType: 'json',
	                    data: {
	                    	fbNo:$('#fbContract').val()
	                    },
	                    success: function (json) {
	                    	getAllPayMoney($('#fbContract').val());
	                    	$('#fbContractName').val(json.contractName);
	                    	$("#contractMoney").val(json.contractMoney);
	                    	$("#provisionalMoney").val(json.temporaryMoney);
	                    	$("#cjContractName").val(json.cjContractName);
	                    	$("#cjContract").val(json.cjContractCode);
	                    	$("#prjCode").val(json.workNo);
	                    	selectAllPrjLeader(json.workNo);
	                    }
	          		});
			  	})
	        	$('#fbContract2').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/subcontract/getFBNameByNo',
	                    dataType: 'json',
	                    data: {
	                    	fbNo:$('#fbContract2').val()
	                    },
	                    success: function (json) {
	                    	$('#fbContractName2').val(json.contractName);
	                    	$("#cjContractName2").val(json.cjContractName);
	                    	$("#cjContract2").val(json.cjContractCode);
	                    	$("#prjCode2").val(json.workNo);
	                    }
	          		});
			  	})
			  	
	        }
    	});
    }
    
    function selectAllPrjLeader(obj){
		 $.ajax({
	           type: 'POST',
	         	url: getContextPath()+'/task/selectPrjLeaderByPrjNo',
	           dataType: 'json',
	           data: {
	        	   nos:obj
	           },
	           success: function (json) {
	              var leader=json.leader;
	              $("#prjChargePerson").val(leader);
	           }
	       });
	}

    
  //初始化提交部门
	function initDepartment(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/cooperator/selectCooperatorIdAndName',
            dataType: 'json',
            data: {

            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
            	$("#contractNameYi").html("");
                for(var i=0;i<json.length;i++){
                	$("#contractNameYi").append("<option value="+json[i].ccId+">"+json[i].ccName+"</option>");
                }
                $("#contractNameYi").trigger("change");
            }
		});
	}
  
    $("#contractNameYi").on("change",function(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/cooperator/selectOneCooperator',
            dataType: 'json',
            data: {
				id:$("#contractNameYi").val()
            },
            success: function (json) {
            	$("#fbChargePerson").val(json.legalPersonName);
            }
		});
    })
    
	//初始化实际负责人部门
	function initbumen(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/organizationManagement/getOrgIdAndName',
            dataType: 'json',
            data: {
            },
            success: function (json) {
            	for(var i=0;i<json.length;i++){
	            	$("#bumen").append("<option value='"+json[i].omId+"'>" + json[i].omName+ "</option>");
	            	$("#bumen2").append("<option value='"+json[i].omId+"'>" + json[i].omName+ "</option>");
	            	$("#bumen3").append("<option value='"+json[i].omId+"'>" + json[i].omName+ "</option>");
            	}
            	$("#bumen").trigger('change');
            	$("#bumen2").trigger('change');
            	$("#bumen3").trigger('change');
            }
        });
	}
	
	$("#bumen").change(function(){
		var bumen=$("#bumen").val();
		$('#addGuanliren').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserByomId",
			dataTyepe:"json",
			async:false,
			data:{ 
				omId:bumen 
				},
			success:function(json){
				$('#bmmingzibiao').dataTable().fnClearTable();
                $('#bmmingzibiao').DataTable().rows.add(json).draw(false);
			}
		})
	})
	//保存添加保管人
	function saveGuanliren(){
		var tr=$("input[name='mingzi']:checked").parents("tr");
		var data=$("#bmmingzibiao").DataTable().row(tr).data();
		//console.log(data)
		$("#leader").val(data.uName);
	}
	
	$("#bumen2").change(function(){
		var bumen=$("#bumen2").val();
		$('#addGuanliren2').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserByomId",
			dataTyepe:"json",
			async:false,
			data:{ 
				omId:bumen 
				},
			success:function(json){
				$('#bmmingzibiao2').dataTable().fnClearTable();
                $('#bmmingzibiao2').DataTable().rows.add(json).draw(false);
			}
		})
	})
	//保存添加保管人
	function savePrj(){
		var tr=$("input[name='mingzi2']:checked").parents("tr");
		var data=$("#bmmingzibiao2").DataTable().row(tr).data();
		//console.log(data)
		$("#prjChargePerson").val(data.uName);
	}
	
	$("#bumen3").change(function(){
		var bumen=$("#bumen3").val();
		$('#addGuanliren3').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserByomId",
			dataTyepe:"json",
			async:false,
			data:{ 
				omId:bumen 
				},
			success:function(json){
				$('#bmmingzibiao3').dataTable().fnClearTable();
                $('#bmmingzibiao3').DataTable().rows.add(json).draw(false);
			}
		})
	})
	//保存添加保管人
	function saveFb(){
		var tr=$("input[name='mingzi3']:checked").parents("tr");
		var data=$("#bmmingzibiao3").DataTable().row(tr).data();
		//console.log(data)
		$("#fbChargePerson").val(data.uName);
	}
	
	
  
    
    function save(){
    	var cj_name=$("#new_cj_name").val();
    	var cj_no=$("#new_cj_no").val();
    	var prj_no=$("#new_prj_no").val();
    	var fb_name=$("#new_fb_name").val();
    	var fb_no=$("#new_fb_no").val();
    	var fb_department=$("#new_fb_department").val();
    	var leader=$("#leader").val();
    	var score=$("input[name='pj']:checked").val();
    	var score2=$("input[name='pj2']:checked").val();
    	var score3=$("input[name='pj3']:checked").val();
    	var score4=$("input[name='pj4']:checked").val();
    	var score5=$("input[name='pj5']:checked").val();
    	var score6=$("input[name='pj6']:checked").val();
    	var all_score=$("input[name='pj7']:checked").val();
    	
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/fbScore/addFbContractDoAppointScoreBySave',
            dataType: 'json',
            data: {
            	taskListCode:prj_no,
            	cjContractCode:cj_no,
            	cjContractName:cj_name,
            	fbContractCode:fb_no,
            	fbContractName:fb_name,
            	fbDepartment:fb_department,
            	actualChargePerson:leader,
            	scoreMaterialSituation:score,
            	scoreManageAbility:score2,
            	scoreQualityControl:score3,
            	scoreCompanyReputation:score4,
            	scoreJinduControl:score5,
            	safetyCivilizationEnvironment:score6,
            	allScore:all_score
            },
            success: function (json) {
            	if(json>0){
            		$("#myModal").modal("hide");
            		toastr.success("保存成功")
            	}else{
            		toastr.error("保存失败")
            	}
            }
    	});
    }
    
    function submit(){
    	var cj_name=$("#new_cj_name").val();
    	var cj_no=$("#new_cj_no").val();
    	var prj_no=$("#new_prj_no").val();
    	var fb_name=$("#new_fb_name").val();
    	var fb_no=$("#new_fb_no").val();
    	var fb_department=$("#new_fb_department").val();
    	var leader=$("#leader").val();
    	var score=$("input[name='pj']:checked").val();
    	var score2=$("input[name='pj2']:checked").val();
    	var score3=$("input[name='pj3']:checked").val();
    	var score4=$("input[name='pj4']:checked").val();
    	var score5=$("input[name='pj5']:checked").val();
    	var score6=$("input[name='pj6']:checked").val();
    	var all_score=$("input[name='pj7']:checked").val();
    	
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/fbScore/addFbContractDoAppointScoreBySubmit',
            dataType: 'json',
            data: {
            	taskListCode:prj_no,
            	cjContractCode:cj_no,
            	cjContractName:cj_name,
            	fbContractCode:fb_no,
            	fbContractName:fb_name,
            	fbDepartment:fb_department,
            	actualChargePerson:leader,
            	scoreMaterialSituation:score,
            	scoreManageAbility:score2,
            	scoreQualityControl:score3,
            	scoreCompanyReputation:score4,
            	scoreJinduControl:score5,
            	safetyCivilizationEnvironment:score6,
            	allScore:all_score
            },
            success: function (json) {
            	if(json>0){
            		$("#myModal").modal("hide");
            		toastr.success("提交成功")
            	}else{
            		toastr.error("提交失败")
            	}
            }
    	});
    }
    

    
    console.log(id)
    function initTable(){
    	$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/fbOver/selectFbContractOverById',
	        dataType: 'json',
	        data:{
	        	id:id
	        },
	        success: function (json) {
	        	console.log(json)
	        	data=json;
	        	$("#fbContractName2").val(data.fbName);
	        	$("#fbContract2").val(data.fbContract);
	        	$("#fb_money2").val(data.fbMoney)
	        	$("#fb_end_money2").val(data.fbEndMoney)
	        	$("#cjContractName2").val(data.cjName);
	        	$("#cjContract2").val(data.cjContract);
	        	$("#prjCode2").val(data.prjCode);
	        	//$("#sj_type").find("option:selected").val(data.settlementType);//审计结算类型
	        	$("#year").val(data.settlementTime);
	        	$("#qianqijyfy").val(data.qianqijyMoney)
	        	if(data.isKouchu=="是"){
	        		$("input[type='checkbox']").attr("checked",true)
	        	}else{
	        		$("input[type='checkbox']").attr("checked",false)
	        	}
	        	$("#work_info2").val(data.workInfo);
	        	$.ajax({
	                type: 'POST',
	                url: getContextPath()+'/accessory/selectAccessoryById',
	                dataType: 'json',
	                async:false,
	                data: {
	                	id:id
	                },
	                success: function (json) {
	                	console.log(json)
	                	$("#new_accessory tbody").html('');
	                	$("#new_accessory1 tbody").html('');
	    				for(var j=0;j<json.length;j++){
	    					//$("#look_accessory tbody").append("<tr><td>附件"+(j+1)+"</td><td>"+accessory[j].acName+"</td><td><button type='button' data="+accessory[j].acUrl+" class='btn btn-primary' onclick='downLoadFile(this)'>下载附件</button></td></tr>")
	    					if(json[j].aType=="合同文本"){
	    		            	   $("#new_accessory tbody").append("<tr>"+
	    	      	   										"<td>附件</td>"+
	    	      	   									"<td style='width:70%;'><a   href='"+getLocalPath()+"/oa_file/"+json[j].acUrl+"' style='color:blue;' target='view_window'>"+json[j].acName+"</a></td>"+
	    	      	  			         	    		"<td ><button type='button' class='btn btn-danger' data1='"+json[j].aId+"' data2='"+json[j].acUrl+"' onclick='deletefile(this)'>删除附件</button></td>"+
	    							            	    "</tr>");
	    	            	   }
	    	            	/* if(accessory[j].aType=="法律顾问签字"){
	    		            	   $("#new_accessory1 tbody").append("<tr>"+
	    	      	   										"<td>附件</td>"+
	    							            	    	"<td colspan='2'><input type='text' class='form-control' style='width:70%;' value='"+accessory[j].acName+"' disabled></td>"+
	    							            	    	"<td><button type='button' class='btn btn-primary' data='"+accessory[j].acUrl+"' onclick='downLoadFile(this)'>下载附件</button></td>"+
	    							            	    "</tr>");
	    	            	   } */
	                	}
	                }
	      		});
	        	
	        }
	    });
    }
  //删除附件
	function deletefile(obj){
		var id=$(obj).attr("data1");
		var name=$(obj).parents("tr").find("td").eq(1).text();
		var url=$(obj).attr("data2");
		$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/accessory/deleteAccessoryByIdAndName',
	        dataType: 'json',
	        data: {
	        	aId:id,
	        	acName:name,
	        	acUrl:url
	        },
	        success: function (json) {
	        	if(json==0){
	        		toastr.error("删除失败");
	        	}else{
	        		toastr.success("删除成功");
	        		$(obj).parent().parent().remove();
	        		//$('#change').modal('hide');
	        	}
	        }
		});
	}
    
    function getLocalPath(){
		var pathArray = window.location.pathname.split('/');
		var secondLevelLocation = pathArray[1];
		var loginUrl = window.location.protocol + "//"  + window.location.host ;
		return loginUrl;
	}
    
    function new_accessory(){
			var length=$("#new_accessory tr").length;
			$("#new_accessory tbody").append("<tr><td>新附件</td><td><input type='file' id='file"+length+"' name='file' class='form-control'></td><td><button type='button' class='btn btn-danger' onclick='removeThis(this)'>移除</button></td></tr>")
	}
    function new_accessory1(){
		var length=$("#new_accessory1 tr").length;
		$("#new_accessory1 tbody").append("<tr><td>新附件</td><td><input type='file' id='file"+length+"' name='file1' class='form-control'></td><td><button type='button' class='btn btn-danger' onclick='removeThis(this)'>移除</button></td></tr>")
}
    
    function new_accessory2(){
		var length=$("#new_accessory2 tr").length;
		$("#new_accessory2 tbody").append("<tr><td>新附件</td><td><input type='file' id='file"+length+"' name='file' class='form-control'></td><td><button type='button' class='btn btn-danger' onclick='removeThis(this)'>移除</button></td></tr>")
	}
    function new_accessory3(){
		var length=$("#new_accessory3 tr").length;
		$("#new_accessory3 tbody").append("<tr><td>新附件</td><td><input type='file' id='file"+length+"' name='file1' class='form-control'></td><td><button type='button' class='btn btn-danger' onclick='removeThis(this)'>移除</button></td></tr>")
	}
    
    function removeThis(obj){
    	var tr=$(obj).parent().parent();
  		$(tr).remove();
    }
    
    function  liuchengGaibian(){
    	var fbName=$("#fbContractName2").val();
    	var fbNo=$("#fbContract2").val();
    	var cjName=$("#cjContractName2").val();
    	var cjNo=$("#cjContract2").val();
    	var prjNo=$("#prjCode2").val();
    	/* var sj_type=$("#sj_type").val(); */
    	var fbMoney=$("#fb_money2").val();
    	var fbEndMoney=$("#fb_end_money2").val();
    	if(fbEndMoney==""){
    		fbEndMoney=0;
    	}
    	var year=$("#year").val();
    	var work_info2=$("#work_info2").val();
    	var qianqijyfy=$("#qianqijyfy").val();//前期经营费用
    	if(qianqijyfy==""){
    		qianqijyfy=0;
    	}
    	var isKouchu="";
    	if($("input[type='checkbox']").is(':checked')){//为true是选中
    		isKouchu="是";
    	}else{
    		isKouchu="否";
    	}
    	
    	var result;
    	var options={
    			type: 'POST',
                url: getContextPath()+'/fbOver/updateFbContractOver',
                dataType: 'json',
                async:false,
                data: {
                	fcoId:id,
                	prjCode:prjNo,
                	cjContract:cjNo,
                	cjName:cjName,
                	fbContract:fbNo,
                	fbName:fbName,
                	/* settlementType:sj_type, */
                	fbMoney:fbMoney,
                	fbEndMoney:fbEndMoney,
                	settlementTime:year,
                	workInfo:work_info2,
                	qianqijyMoney:qianqijyfy,
                	isKouchu:isKouchu
                },
                success: function (json) {
                	result=json;
                	if(json>0){
                		$("#myModal2").modal("hide");
                		toastr.success("修改成功")
                	}else{
                		toastr.error("修改失败")
                	}
                }
    	}
    	$("#form_fb").ajaxSubmit(options);
    	return result;
    }
    
    function  submit2(){
    	var prj_name=$("#prj_name").val();
    	var prj_no=$("#prj_no2").val();
    	var fb_name=$("#fb_name2").val();
    	var cj_name=$("#cj_name2").val();
    	var sj_type=$("#sj_type").val();
    	var year=$("#year").val();
    	var work_info2=$("#work_info2").val();
    	
    	var options={
    			type: 'POST',
                url: getContextPath()+'/fbOver/addFbContractOverBySubmit',
                dataType: 'json',
                data: {
                	prjCode:prj_no,
                	prjName:prj_name,
                	cjContract:cj_name,
                	fbContract:fb_name,
                	settlementType:sj_type,
                	settlementTime:year,
                	workInfo:work_info2
                },
                success: function (json) {
                	if(json>0){
                		$("#myModal2").modal("hide");
                		toastr.success("提交成功")
                	}else{
                		toastr.error("提交失败")
                	}
                }
    	}
    	$("#form_fb").ajaxSubmit(options);
    }
    
    function downLoadFile(obj){
			var filePath=$(obj).attr("data");
			var fileName=$(obj).parents("tr").find("td").eq(1).text();
			window.location.href=encodeURI(getContextPath()+"/FileDownLoad?fileName="+fileName+"&filePath="+filePath);
	}
    
    function save3(){
    	var options={
    			type: 'POST',
                url: getContextPath()+'/fbOverWj/addFbContractOverWjBySave',
                dataType: 'json',
                data: {
                	fbContractName:$("#fbContractName").val(),
                	fbContract:$("#fbContract").val(),
                	prjCode:$("#prjCode").val(),
                	prjChargePerson:$("#prjChargePerson").val(),
                	cjContractName:$("#cjContractName").val(),
                	cjContract:$("#cjContract").val(),
                	contractNameYi:$("#contractNameYi").val(),
                	fbChargePerson:$("#fbChargePerson").val(),
                	prjProbablyText:$("#prjProbablyText").val(),
                	contractMoney:$("#contractMoney").val(),
                	provisionalMoney:$("#provisionalMoney").val(),
                	overWorkMoney:$("#overWorkMoney").val(),
                	overWorkExplain:$("#overWorkExplain").val(),
                	allPayMoney:$("#allPayMoney").val(),
                	doAppointScore:$("#doAppointScore").val()
                },
                success: function (json) {
                	if(json>0){
                		$("#myModal3").modal("hide");
                		toastr.success("保存成功")
                	}else{
                		toastr.error("保存失败")
                	}
                }
    	}
    	$("#form_fb2").ajaxSubmit(options);
    }

    function submit3(){
    	var options={
    			type: 'POST',
                url: getContextPath()+'/fbOverWj/addFbContractOverWjBySubmit',
                dataType: 'json',
                data: {
                	fbContractName:$("#fbContractName").val(),
                	fbContract:$("#fbContract").val(),
                	prjCode:$("#prjCode").val(),
                	prjChargePerson:$("#prjChargePerson").val(),
                	cjContractName:$("#cjContractName").val(),
                	cjContract:$("#cjContract").val(),
                	contractNameYi:$("#contractNameYi").val(),
                	fbChargePerson:$("#fbChargePerson").val(),
                	prjProbablyText:$("#prjProbablyText").val(),
                	contractMoney:$("#contractMoney").val(),
                	provisionalMoney:$("#provisionalMoney").val(),
                	overWorkMoney:$("#overWorkMoney").val(),
                	overWorkExplain:$("#overWorkExplain").val(),
                	allPayMoney:$("#allPayMoney").val(),
                	doAppointScore:$("#doAppointScore").val()
                },
                success: function (json) {
                	if(json>0){
                		$("#myModal3").modal("hide");
                		toastr.success("提交成功")
                	}else{
                		toastr.error("提交失败")
                	}
                }
    	}
    	$("#form_fb2").ajaxSubmit(options);
    }
    
    function look3(obj){
    	var tr=$(obj).parents("tr");
    	var data=$("#mainContent3").DataTable().row(tr).data();
    	
    	$("#look_fbContractName").text(data.fbContractName);
    	$("#look_fbContract").text(data.fbContract);
    	$("#look_prjCode").text(data.prjCode);
    	$("#look_prjChargePerson").text(data.prjChargePerson);
    	$("#look_cjContractName").text(data.cjContractName);
    	$("#look_cjContract").text(data.cjContract);
    	$("#look_contractNameYi").text(data.contractNameYi);
    	$("#look_fbChargePerson").text(data.fbChargePerson);
    	$("#look_prjProbablyText").text(data.prjProbablyText);
    	$("#look_contractMoney").text(data.contractMoney);
    	$("#look_provisionalMoney").text(data.provisionalMoney);
    	$("#look_overWorkMoney").text(data.overWorkMoney);
    	$("#look_overWorkExplain").text(data.overWorkExplain);
    	$("#look_allPayMoney").text(data.allPayMoney);
    	$("#look_doAppointScore").text(data.doAppointScore);
    	
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/work/selectDepartmentAndPerson',
            dataType: 'json',
            async:false,
            data: {
            	id:data.fcowId
            },
            success: function (json) {
            	var accessory=json.accessory;
            	$("#look_accessory3 tbody").html('');
            	$("#look_accessory4 tbody").html('');
				for(var j=0;j<accessory.length;j++){
					if(accessory[j].aType=="合同文本"){
		            	   $("#look_accessory3 tbody").append("<tr>"+
	      	   										"<td>附件</td>"+
							            	    	"<td colspan='2'><input type='text' class='form-control' style='width:70%;' value='"+accessory[j].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data='"+accessory[j].acUrl+"' onclick='downLoadFile(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	            	if(accessory[j].aType=="法律顾问签字"){
		            	   $("#look_accessory4 tbody").append("<tr>"+
	      	   										"<td>附件</td>"+
							            	    	"<td colspan='2'><input type='text' class='form-control' style='width:70%;' value='"+accessory[j].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data='"+accessory[j].acUrl+"' onclick='downLoadFile(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
            	}
            }
  		});
    	
    	$("#allMsg3").modal("show");
    }
    
    function exportThis(){
    	var state=$("#state3").val();
    	window.location.href=encodeURI(getContextPath()+'/fbOverWj/exportFbOverWj?state='+state);
    }
    
    
  //选择项目
	$("#chosexm").click(function(){
		$("#xiangmumd").modal("show");
		 $.ajax({
	            type: 'POST',
	            url: getContextPath()+'/task/selectPrjNameAndWorkNo',
	            dataType: 'json',
	            async:false,
	            data: {
	            },
	            success: function (json) {
	            	//console.log(json)
	                $('#xiangmubiao').dataTable().fnClearTable();
	                $('#xiangmubiao').DataTable().rows.add(json).draw(false);
	            }
	        });
	})
	$("#quedingxm").click(function(){
		var prjname=$("input[name='xiangmuName']:checked").parent().next().next().text();
		var prjNo=$("input[name='xiangmuName']:checked").parent().next().text();
		$("#prj_name").val(prjname);
		$("#prj_no2").val(prjNo);
		$("#xiangmumd").modal("hide");
	})
    
    function initPrj(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/task/selectPrjNameAndWorkNo',
            dataType: 'json',
            data: {
            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
                for(var i=0;i<json.length;i++){
                	//$("#prj_name").append("<option value="+json[i].prjName+">"+json[i].prjName+"</option>");
                	$("#prj_no2").append("<option value="+json[i].prjNo+">"+json[i].prjNo+"</option>");
                }
                
                
                $('#prj_no2').editableSelect().on('select.editable-select', function (e, dom) {
		          		$.ajax({
		                    type: 'POST',
		                    url: getContextPath()+'/task/selectCjByTaskNo',
		                    dataType: 'json',
		                    data: {
		                    	no:$('#prj_no2').val()
		                    },
		                    success: function (json) {
		                    	var task=json.task;
		                    	$('#prj_name').val(task.prjName);
		                    }
		          		})
                })
                
            }
    	})
    }
    
    function initCj(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/cj/selectIdAndName',
            dataType: 'json',
            data: {
            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
            	for(var i=0;i<json.length;i++){
            		$("#cj_name2").append("<option value="+json[i].cjId+">"+json[i].contractName+"</option>")
            	}
            }
    	})
    }
    
    function initFb(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/subcontract/getFBNameAndNo',
            dataType: 'json',
            data: {
            },
            error: function (msg) {
            	toastr.error("请求失败");
            },
            success: function (json) {
            	for(var i=0;i<json.length;i++){
            		$("#fb_name2").append("<option value="+json[i].fbId+">"+json[i].contractName+"</option>")
            	}
            }
    	})
    }
    
    function select_cj(){
   	 $.ajax({
	            type: 'POST',
	            url: getContextPath()+'/cj/selectNameAndNo',
	            dataType: 'json',
	            async:false,
	            data: {
	            },
	            success: function (json) {
	                $('#cj_table').dataTable().fnClearTable();
	                $('#cj_table').DataTable().rows.add(json).draw(false);
	            }
	        });
   			$("#choose_cj").modal("show");
   }
    
    function saveCjName(){
    	var tr=$("input[name='cjName']:checked").parents("tr");
    	var data=$("#cj_table").DataTable().row(tr).data();
    	if(data==null){
    		toastr.error("请选择")
    		return;
    	}
    	$("#new_cj_name").val(data.contractName);
    	$("#new_cj_no").val(data.contractNo);
    	$("#new_prj_no").val(data.taskCode);
    	$("#choose_cj").modal("hide");
    }
    
    //履约评价选择分包
    function chooseFb(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/subcontract/getFBNameAndNo',
            dataType: 'json',
            async:false,
            data: {
            },
            success: function (json) {
                $('#fb_table').dataTable().fnClearTable();
                $('#fb_table').DataTable().rows.add(json).draw(false);
            }
        });
    	$("#choose_fb").modal("show");
    }

    function saveFbName(){
    	var tr=$("input[name='fbName']:checked").parents("tr");
    	var prjname=$("input[name='fbName']:checked").parent().next().text();
		var prjNo=$("input[name='fbName']:checked").parent().next().next().text();
		var jiafang=$("input[name='fbName']:checked").parent().next().next().next().text();
    	$('#new_fb_name').val(prjname);
    	$('#new_fb_no').val(prjNo);
    	$("#new_fb_department").val(jiafang)
    	$("#choose_fb").modal("hide");
    }
    
  //分包结算申请选择分包
    function chooseFb2(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/subcontract/getFBNameAndNo',
            dataType: 'json',
            async:false,
            data: {
            },
            success: function (json) {
                $('#fb_table2').dataTable().fnClearTable();
                $('#fb_table2').DataTable().rows.add(json).draw(false);
            }
        });
    	$("#choose_fb2").modal("show");
    }
    function saveFbName2(){
    	var tr=$("input[name='fbName2']:checked").parents("tr");
    	var data=$('#fb_table2').DataTable().row(tr).data();
    	$('#fbContractName2').val(data.contractName);
    	$('#fbContract2').val(data.fbNo);
    	$("#cjContractName2").val(data.cjContractName);
    	$("#cjContract2").val(data.cjContractCode);
    	$("#prjCode2").val(data.workNo);
    	$("#choose_fb2").modal("hide");
    }
    
  //分包结算申请选择承接
    function select_cj2(){
      	 $.ajax({
   	            type: 'POST',
   	            url: getContextPath()+'/cj/selectNameAndNo',
   	            dataType: 'json',
   	            async:false,
   	            data: {
   	            },
   	            success: function (json) {
   	                $('#cj_table2').dataTable().fnClearTable();
   	                $('#cj_table2').DataTable().rows.add(json).draw(false);
   	            }
   	        });
      			$("#choose_cj2").modal("show");
      }
       
       function saveCjName2(){
       	var tr=$("input[name='cjName2']:checked").parents("tr");
       	var data=$("#cj_table2").DataTable().row(tr).data();
       	if(data==null){
       		toastr.error("请选择")
       		return;
       	}
       	$("#cj_name2").val(data.contractName);
       	$("#choose_cj2").modal("hide");
       }
    
  //合同履约选择分包
    function chooseFb3(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/subcontract/getFBNameAndNo',
            dataType: 'json',
            async:false,
            data: {
            },
            success: function (json) {
                $('#fb_table3').dataTable().fnClearTable();
                $('#fb_table3').DataTable().rows.add(json).draw(false);
            }
        });
    	$("#choose_fb3").modal("show");
    }

    function saveFbName3(){
    	var tr=$("input[name='fbName3']:checked").parents("tr");
    	var data=$('#fb_table3').DataTable().row(tr).data();
    	$('#fbContractName').val(data.contractName);
    	$('#fbContract').val(data.fbNo);
    	getAllPayMoney(data.fbNo);
    	$("#contractMoney").val(data.contractMoney);
    	$("#provisionalMoney").val(data.temporaryMoney);
    	$("#cjContractName").val(data.cjContractName);
    	$("#cjContract").val(data.cjContractCode);
    	$("#prjCode").val(data.workNo);
    	selectAllPrjLeader(data.workNo)
    	$("#choose_fb3").modal("hide");
    }
    
    function getAllPayMoney(obj){
    	$.ajax({
	            type: 'POST',
	            url: getContextPath()+'/pay/getTotalPayMoney',
	            dataType: 'json',
	            data: {
	            	no:obj
	            },
	            success: function (json) {
	                $("#allPayMoney").val(json.alreadyAccumulateMoney)
	            }
	        });
    }
    
    
    //合同履约选择承接
    function select_cj3(){
      	 $.ajax({
   	            type: 'POST',
   	            url: getContextPath()+'/cj/selectNameAndNo',
   	            dataType: 'json',
   	            async:false,
   	            data: {
   	            },
   	            success: function (json) {
   	                $('#cj_table3').dataTable().fnClearTable();
   	                $('#cj_table3').DataTable().rows.add(json).draw(false);
   	            }
   	        });
      			$("#choose_cj3").modal("show");
      }
       
       function saveCjName3(){
       	var tr=$("input[name='cjName3']:checked").parents("tr");
       	var data=$("#cj_table3").DataTable().row(tr).data();
       	if(data==null){
       		toastr.error("请选择")
       		return;
       	}
       	$("#cjContractName").val(data.contractName);
       	$("#cjContract").val(data.contractNo);
       	$("#prjCode").val(data.taskCode);
       	$("#choose_cj3").modal("hide");
       }
       
       function gotoCj(obj){
	    	dom=$(obj).parents("tr");
			var data=$('#mainContent').DataTable().row(dom).data();
			//var t = encodeURI(encodeURI(data.prjId));
			//console.log(data)
			 $.ajax({
				type:"POST",
				url:getContextPath()+"/cj/selectCjByCjNo",
				dataTyepe:"json",
				async:false,
				data:{ 
					no:data.cjContractCode
					},
				success:function(json){
					//console.log(json)
					$(obj).attr("href",'../shengchanGuanli/ContractManagement.html?cjId='+json.cjId+'');
				}
			})  
	    }
       
       function gotoFb(obj){
       	dom=$(obj).parents("tr");
   		var data=$('#mainContent').DataTable().row(dom).data();
   		//console.log(data)
   		$.ajax({
               type: 'POST',
               url: getContextPath()+'/subcontract/getFBNameByNo',
               dataType: 'json',
               async:false,
               data: {
               	fbNo:data.fbContractCode
               },
               success: function (json) {
               	//console.log(json);
               	$(obj).attr('href', '../shengchanGuanli/SubcontractManagement.html?prjId='+json.fbId+'');
               }
     		});
       }
       
       function gotoPrj2(obj){
       	dom=$(obj).parents("tr");
   		var data=$('#mainContent2').DataTable().row(dom).data();
   		//console.log(data);
   		//var t = encodeURI(encodeURI(data.prjId));
   		$.ajax({
   			type:"POST",
   			url:getContextPath()+"/task/selectIdByNameAndNo",
   			dataTyepe:"json",
   			async:false,
   			data:{ 
   				name:data.prjName,
   				no:data.prjCode
   				},
   			success:function(json){
   				$(obj).attr('href', '../shengchanGuanli/TaskManagement.html?prjId='+json.prjId+'&prjNo='+data.prjCode+'');
   			}
   		})
       }
       
       function gotoCj2(obj){
	    	dom=$(obj).parents("tr");
			var data=$('#mainContent2').DataTable().row(dom).data();
			//var t = encodeURI(encodeURI(data.prjId));
			//console.log(data)
			$(obj).attr("href",'../shengchanGuanli/ContractManagement.html?cjId='+data.cjContract+''); 
	    }
       
       function gotoFb2(obj){
          	dom=$(obj).parents("tr");
      		var data=$('#mainContent2').DataTable().row(dom).data();
      		console.log(data)
      		$(obj).attr('href', '../shengchanGuanli/SubcontractManagement.html?prjId='+data.fbContract+'');
          }
       
       function gotoFb3(obj){
          	dom=$(obj).parents("tr");
      		var data=$('#mainContent3').DataTable().row(dom).data();
      		//console.log(data)
      		$.ajax({
                  type: 'POST',
                  url: getContextPath()+'/subcontract/getFBNameByNo',
                  dataType: 'json',
                  async:false,
                  data: {
                  	fbNo:data.fbContract
                  },
                  success: function (json) {
                  	//console.log(json);
                  	$(obj).attr('href', '../shengchanGuanli/SubcontractManagement.html?prjId='+json.fbId+'');
                  }
        		}); 
          }
       
       function gotoCj3(obj){
	    	dom=$(obj).parents("tr");
			var data=$('#mainContent').DataTable().row(dom).data();
			//var t = encodeURI(encodeURI(data.prjId));
			console.log(data)
			$.ajax({
				type:"POST",
				url:getContextPath()+"/cj/selectCjByCjNo",
				dataTyepe:"json",
				async:false,
				data:{ 
					no:data.cjContractCode
					},
				success:function(json){
					//console.log(json)
					$(obj).attr("href",'../shengchanGuanli/ContractManagement.html?cjId='+json.cjId+'');
				}
			})
	    }
       
</script>
</html>