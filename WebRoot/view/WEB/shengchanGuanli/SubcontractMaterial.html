<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../../font2/iconfont.css">
    <link rel="stylesheet" href="../../font3/iconfont.css">
	<link href="../../style/bootstrap.min.css" rel="stylesheet">
    <link href="../../style/style.css" rel="stylesheet">
    <link href="../../toastr/toastr.css" rel="stylesheet">
    <link rel="stylesheet" href="../../style/jquery.dataTables.min.css">
    <link rel="stylesheet" href="../../style/jquery-editable-select.css">
    <style lang="">
        .UpperPart{
            display: flex;
            justify-content:space-between;
            border-bottom: 1px solid #ccc;
            padding-bottom: 12px;
        }
        .selected{
            background: rgba(247, 161, 3,0.2);
        }
        #mainContent th{
            cursor: pointer;
        }
        div input[type=radio]{
			width:20px;
			height:20px;
			margin-left: 8px;
		}
    </style>
</head>
<body>
    
    <!-- 面包屑 -->
    <div class="mianbao">
    	<ul class="breadcrumb">
    		<li><i class="iconfont icon-knowledgebase"></i></li>
            <li>生产管理</li>
            <li>合同履约</li>
			<li class="active">材料分包合同</li>
		</ul>
    </div>

    <div>
        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist" style="background:#fff;">
            <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">履约评价</a></li>
            <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">采购结算申请</a></li>
            <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">采购合同履约</a></li>
        </ul>     
        <!-- Tab panes -->
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="home">
                <div class="zhuti-content">
                    <div class="UpperPart">
                        <div class="UpperPartL">
                            
                        </div>
                        <div class="UpperPartR">
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">填报履约评价表</button>
                        </div>
            <!-- Modal -->
            <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal">
                <div class="modal-dialog modal-lg" role="document" style="width:60%;">
                    <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel"><b>填报履约评价表</b></h4>
                    </div>
                    <div class="modal-body">
                            <div>     
                                <form class="form-inline">
                                    <table class="table table-bordered table-condensed" id="newTable">
                                        <tr>   
                                            <td style="width:15%;">项目名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                            <td style="width:40%;">
                                                <select class="form-control" id="prjName" style="width:60%;">
                                                </select>
                                            </td>
                                            <td style="width:15%;">任务单号</td>
                                            <td style="width:30%;">
                                            	<!-- <input type="text" id="taskNo" class="form-control" disabled> -->
                                            	<select class="form-control" id="taskNo" style="width:70%;">
                                                    
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>项目负责人</td>
                                            <td>
                                                <select class="form-control" id="prjfuzeren" style="width:60%;"  id="editable-select">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select>
                                            </td>
                                            <td>部门</td>
                                            <td>
                                                <select class="form-control" style="width:70%;"  id="department">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>材料采购合同编号</td>
                                            <td><input type="text" id="clcgbianhao" class="form-control" disabled style="width:60%;"></td>
                                            <td>合同累计金额</td>
                                            <td><input type="text" id="hetongleijiMoney" class="form-control" style="width:70%;"></td>
                                        </tr>
                                        <tr>
                                            <td>合同实际结算金额</td>
                                            <td><input type="text" id="hetongshijijiesuanMoney" class="form-control" style="width:60%;"></td>
                                            <td>付款方式</td>
                                            <td>
                                            	<input type="text" id="fukuantype" class="form-control" style="width:70%;">
                                                <!-- <select class="form-control" id="fukuantype" style="width:180px;">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select> -->
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>实际负责人  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                            <td>
                                            	<input type="text" id="shijifuzeren" class="form-control" disabled style="width:60%;">
                                    			<button type="button" class="btn btn-default" data-toggle="modal" data-target="#addGuanliren">选择实际负责人</button>
                                                <!-- <select class="form-control" id="shijifuzeren" style="width:180px;">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select> -->
                                            </td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td rowspan="6">评价内容  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                            <td>产品质量及易用情况（25%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="pj1" value="90">90
                                                <input type="radio" name="pj1" value="75">75
                                                <input type="radio" name="pj1" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>交货周期（20%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="pj2" value="90">90
                                                <input type="radio" name="pj2" value="75">75
                                                <input type="radio" name="pj2" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>材料合格证书检测报告完备（15%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="pj3" value="90">90
                                                <input type="radio" name="pj3" value="75">75
                                                <input type="radio" name="pj3" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>咨询及对顾客使用、维护的指导情况等售后服务（15%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="pj4" value="90">90
                                                <input type="radio" name="pj4" value="75">75
                                                <input type="radio" name="pj4" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>付款方式（15%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="pj5" value="90">90
                                                <input type="radio" name="pj5" value="75">75
                                                <input type="radio" name="pj5" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>安全文明与环保（10%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="pj6" value="90">90
                                                <input type="radio" name="pj6" value="75">75
                                                <input type="radio" name="pj6" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>综合评价</td>
                                            <td colspan="3">
                                                <input type="radio" name="pj7" value="90">90
                                                <input type="radio" name="pj7" value="75">75
                                                <input type="radio" name="pj7" value="60">60
                                            </td>
                                        </tr>
                                    </table>
                                </form> 
                            </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-default" onclick="savelypingjia()">保存</button>
                        <button type="button" class="btn btn-success" onclick="submitlypingjia()">提交</button>
                    </div>
                    </div>
                </div>
            </div>
            <!-- model结束 -->

<!--选人 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="addGuanliren">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">选择实际负责人</h4>
            </div>
            <div class="modal-body">
                <form class="form-inline">
                    <div class="form-group">
                        <div>
                            <span>部门:</span>
                            <select style="width:180px;" id="bumen" class="form-control" >
                                
                            </select>
                            <span>人员:</span>
                            <select style="width:180px;" id="guanliren" class="form-control" >
                                
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="saveGuanliren()" data-dismiss="modal">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 选人 modal结束 -->

            <!-- 修改Modal -->
            <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="change">
                <div class="modal-dialog modal-lg" role="document" style="width:60%;">
                    <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel"><b>修改履约评价表</b></h4>
                    </div>
                    <div class="modal-body">
                            <div>     
                                <form class="form-inline">
                                    <table class="table table-bordered table-condensed" id="editTable">
                                        <tr>   
                                            <td style="width:15%;">项目名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                            <td style="width:40%;">
                                                <select class="form-control" id="xgprjName" style="width:60%;">
                                                    
                                                </select>
                                            </td>
                                            <td style="width:15%;">任务单号</td>
                                            <td style="width:30%;">
                                            	<!-- <input type="text" id="xgtaskNo" class="form-control" disabled> -->
                                            	<select class="form-control" id="xgtaskNo" style="width:70%;">
                                                    
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>项目负责人</td>
                                            <td>
                                                <select class="form-control" id="xgprjfuzeren" style="width:60%;">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select>
                                            </td>
                                            <td>部门</td>
                                            <td>
                                                <select class="form-control" style="width:70%;"  id="xgdepartment">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>材料采购合同编号</td>
                                            <td><input type="text" id="xgclcgbianhao" class="form-control" disabled style="width:60%;"></td>
                                            <td>合同累计金额</td>
                                            <td><input type="text" id="xghetongleijiMoney" class="form-control" style="width:70%;"></td>
                                        </tr>
                                        <tr>
                                            <td>合同实际结算金额</td>
                                            <td><input type="text" id="xghetongshijijiesuanMoney" class="form-control" style="width:60%;"></td>
                                            <td>付款方式</td>
                                            <td>
                                            	<input type="text" id="xgfukuantype" class="form-control" style="width:70%;">
                                                <!-- <select class="form-control" style="width:180px;">
                                                    <option>1</option>
                                                    <option>2</option>
                                                    <option>3</option>
                                                    <option>4</option>
                                                    <option>5</option>
                                                </select> -->
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>实际负责人  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                            <td>
                                            	<input type="text" id="xgshijifuzeren" class="form-control" disabled style="width:60%;">
                                    			<button type="button" class="btn btn-default" data-toggle="modal" data-target="#xgaddGuanliren">选择实际负责人</button>
                                            </td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td rowspan="6">评价内容  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                            <td>产品质量及易用情况（25%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="xgpj1" value="90">90
                                                <input type="radio" name="xgpj1" value="75">75
                                                <input type="radio" name="xgpj1" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>交货周期（20%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="xgpj2" value="90">90
                                                <input type="radio" name="xgpj2" value="75">75
                                                <input type="radio" name="xgpj2" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>材料合格证书检测报告完备（15%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="xgpj3" value="90">90
                                                <input type="radio" name="xgpj3" value="75">75
                                                <input type="radio" name="xgpj3" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>咨询及对顾客使用、维护的指导情况等售后服务（15%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="xgpj4" value="90">90
                                                <input type="radio" name="xgpj4" value="75">75
                                                <input type="radio" name="xgpj4" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>付款方式（15%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="xgpj5" value="90">90
                                                <input type="radio" name="xgpj5" value="75">75
                                                <input type="radio" name="xgpj5" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>安全文明与环保（10%）</td>
                                            <td colspan="2">
                                                <input type="radio" name="xgpj6" value="90">90
                                                <input type="radio" name="xgpj6" value="75">75
                                                <input type="radio" name="xgpj6" value="60">60
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>综合评价</td>
                                            <td colspan="3">
                                                <input type="radio" name="xgpj7" value="90">90
                                                <input type="radio" name="xgpj7" value="75">75
                                                <input type="radio" name="xgpj7" value="60">60
                                            </td>
                                        </tr>
                                    </table>
                                </form> 
                            </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-default" onclick="checkSave()">保存</button>
                        <button type="button" class="btn btn-success" onclick="checkSubmit()">提交</button>
                    </div>
                    </div>
                </div>
            </div>
            <!-- 修改model结束 -->
            
<!--修改选人 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="xgaddGuanliren">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">修改实际负责人</h4>
            </div>
            <div class="modal-body">
                <form class="form-inline">
                    <div class="form-group">
                        <div>
                            <span>部门:</span>
                            <select style="width:180px;" id="xgbumen" class="form-control" >
                                
                            </select>
                            <span>人员:</span>
                            <select style="width:180px;" id="xgguanliren" class="form-control" >
                                
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="savexgGuanliren()" data-dismiss="modal">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 修改印章管理人结束 -->
            

                    </div>
                    <div class="LowerPart" style="margin-top:3px;">
                        <table class="table table-bordered table-condensed" id="mainContent">
                            <thead>
                                <tr>
                                    <th>材料采购合同编号</th>
                                    <th>任务单号</th>
                                    <th>项目名称</th>
                                    <th>项目负责人</th>
                                    <th>部门</th>
                                    <th>合同累计金额</th>
                                    <th>合同实际结算金额</th>
                                    <th>付款方式</th>
                                    <th style="width:75px;">操作</th>
                                </tr>
                            </thead>
                            <tbody>
                            
                            </tbody>  
                        </table>
<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg1">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>所有信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered table-condensed">
                        <tr>   
                            <td style="width:100px;">项目名称</td>
                            <td id="lookprjName"></td>
                            <td style="width:100px;">任务单号</td>
                            <td id="looktaskNo"></td>
                        </tr>
                        <tr>
                            <td>项目负责人</td>
                            <td id="lookprjfuzeren"></td>
                            <td>部门</td>
                            <td id="lookdepartment"></td>
                        </tr>
                        <tr>
                            <td>材料采购合同编号</td>
                            <td id="lookclcgbianhao"></td>
                            <td>合同累计金额</td>
                            <td id="lookhetongleijiMoney"></td>
                        </tr>
                        <tr>
                            <td>合同实际结算金额</td>
                            <td id="lookhetongshijijiesuanMoney"></td>
                            <td>付款方式</td>
                            <td id="lookfukuantype"></td>
                        </tr>
                        <tr>
                            <td>实际负责人</td>
                            <td id="lookshijifuzeren"></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td rowspan="6">评价内容</td>
                            <td>产品质量及易用情况（25%）</td>
                            <td colspan="2" id="lookpj1"></td>
                        </tr>
                        <tr>
                            <td>交货周期（20%）</td>
                            <td colspan="2" id="lookpj2"></td>
                        </tr>
                        <tr>
                            <td>材料合格证书检测报告完备（15%）</td>
                            <td colspan="2" id="lookpj3"></td>
                        </tr>
                        <tr>
                            <td>咨询及对顾客使用、维护的指导情况等售后服务（15%）</td>
                            <td colspan="2" id="lookpj4"></td>
                        </tr>
                        <tr>
                            <td>付款方式（15%）</td>
                            <td colspan="2" id="lookpj5"></td>
                        </tr>
                        <tr>
                            <td>安全文明与环保（10%）</td>
                            <td colspan="2" id="lookpj6"></td>
                        </tr>
                        <tr>
                            <td>综合评价</td>
                            <td colspan="3" id="lookpj7"></td>
                        </tr>
                    </table>
                    <!-- 历史信息表格 -->
				    <table style="width:100%;" class="table table-bordered table-condensed" id="lookHistory">
                        <thead>
                            <tr>
                                <th colspan="6">历史信息</th>
                            </tr>
                            <tr>
                                <td>材料采购合同编号</td>
                                <td>任务单号</td>
                                <td>项目名称</td>
                                <td>修改时间</td>
                                <td>操作</td>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </form> 
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- allMsg结束 -->
<!-- 历史详细信息 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="History">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>历史信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered table-condensed">
                        <tr>   
                            <td style="width:100px;">项目名称</td>
                            <td id="HistoryprjName"></td>
                            <td style="width:100px;">任务单号</td>
                            <td id="HistorytaskNo"></td>
                        </tr>
                        <tr>
                            <td>项目负责人</td>
                            <td id="Historyprjfuzeren"></td>
                            <td>部门</td>
                            <td id="Historydepartment"></td>
                        </tr>
                        <tr>
                            <td>材料采购合同编号</td>
                            <td id="Historyclcgbianhao"></td>
                            <td>合同累计金额</td>
                            <td id="HistoryhetongleijiMoney"></td>
                        </tr>
                        <tr>
                            <td>合同实际结算金额</td>
                            <td id="HistoryhetongshijijiesuanMoney"></td>
                            <td>付款方式</td>
                            <td id="Historyfukuantype"></td>
                        </tr>
                        <tr>
                            <td>实际负责人</td>
                            <td id="Historyshijifuzeren"></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td rowspan="6">评价内容</td>
                            <td>产品质量及易用情况（25%）</td>
                            <td colspan="2" id="Historypj1"></td>
                        </tr>
                        <tr>
                            <td>交货周期（20%）</td>
                            <td colspan="2" id="Historypj2"></td>
                        </tr>
                        <tr>
                            <td>材料合格证书检测报告完备（15%）</td>
                            <td colspan="2" id="Historypj3"></td>
                        </tr>
                        <tr>
                            <td>咨询及对顾客使用、维护的指导情况等售后服务（15%）</td>
                            <td colspan="2" id="Historypj4"></td>
                        </tr>
                        <tr>
                            <td>付款方式（15%）</td>
                            <td colspan="2" id="Historypj5"></td>
                        </tr>
                        <tr>
                            <td>安全文明与环保（10%）</td>
                            <td colspan="2" id="Historypj6"></td>
                        </tr>
                        <tr>
                            <td>综合评价</td>
                            <td colspan="3" id="Historypj7"></td>
                        </tr>
                    </table>
                </form> 
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- 历史信息结束 -->



                    </div>
                </div>
            </div>

            <div role="tabpanel" class="tab-pane" id="profile">
    <div class="zhuti-content">
        <div class="UpperPart">
            <div class="UpperPartL">
                
            </div>
            <div class="UpperPartR">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal2">新建采购结算申请</button>
            </div>
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal2">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>新建采购结算申请</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form id="cgjs_form" class="form-inline"  method="post" enctype="multipart/form-data">
                        <table class="table table-bordered table-condensed">
                            <tr>
                            	<td style="width:20%;">采购合同名  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:30%;">
                                	<!-- <input type="text" class="form-control" id="cghetong" disabled> -->
                                    <select class="form-control" style="width:70%;" id="cghetong">
                                    
                                    </select> 
                                </td>
                                <td style="width:20%;">采购合同号  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:30%;">
                                    <select class="form-control" style="width:70%;" id="cghetonghao2">
                                    
                                    </select> 
                                </td>
                            </tr>
                            <tr>
                                <td>项目名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                	<input type="text" id="prjName2" class="form-control" disabled style="width:70%;">
                                    <!-- <select class="form-control" style="width:180px;"  id="prjName2" disabled>
                                    </select> -->
                                </td>
                                <td style="width:100px;">任务单号</td>
                                <td>
                                	<input type="text" id="taskNo2" class="form-control" disabled style="width:70%;"> 
                                	<!-- <select class="form-control" style="width:180px;"  id="taskNo2" disabled>
                                    </select> -->
                                </td>
                            </tr>
                            <tr>
                                <td>承接合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" style="width:70%;"  id="cjhetong">
                                        
                                    </select>
                                </td>
                                <td>承接合同编号  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" style="width:70%;"  id="cjhetonghao">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>审计结算类型</td>
                                <td>
                                    <select class="form-control" style="width:70%;" id="jiesuantype">
                                        <option>中间结算</option>
                                        <option>最终结算</option>
                                    </select>
                                </td>
                                <td>时间</td>
                                <td><input type="text" class="form-control" id="year" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>内容概述</td>
                                <td colspan="3">
                                    <div class="form-group">
                                        <textarea class="form-control" id="gaishu" rows="4" style="width:100%;"></textarea>
                                    </div> 
                                </td>
                            </tr>
                        </table>
						<table class="table table-bordered table-condensed" id="cgjs_accessory">
							<thead>
								<tr>
	                                <td style="width:15%;">法律顾问签字:  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
	                                <td colspan="3">
	                                	<button type="button" class="btn btn-primary weui-uploader__input" onclick="addcgjsFile()">添加附件</button>
	                                </td>
	                            </tr>
							</thead>
							<tbody>
							</tbody>
						</table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default" onclick="savecgjiesuan()">保存</button>
            <button type="button" class="btn btn-success" onclick="submitcgjiesuan()">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- model结束 -->

<!-- 修改Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="change2">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>修改采购结算申请</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form id="cgjs_form2" class="form-inline"  method="post" enctype="multipart/form-data">
                        <table class="table table-bordered table-condensed">
                            <tr>
                            	<td style="width:20%;">采购合同名  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:30%;">
                                	<!-- <input type="text" class="form-control" id="xgcghetong"  disabled> -->
                                    <select class="form-control" id="xgcghetong" style="width:70%;">
                                    </select> 
                                </td>
                                <td style="width:20%;">采购合同号  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:30%;">
                                	<!-- <input type="text" class="form-control" id="xgcghetong"  disabled> -->
                                    <select class="form-control" id="xgcghetonghao2" style="width:70%;">
                                    </select> 
                                </td>
                            </tr>
                            <tr>
                            	<td>项目名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                	<input type="text" id="xgprjName2" class="form-control" disabled style="width:70%;">
                                    <!-- <select class="form-control" style="width:180px;"  id="xgprjName2" disabled>
                                    </select> -->
                                </td>
                                <td style="width:100px;">任务单号</td>
                                <td>
                                	<input type="text" id="xgtaskNo2" class="form-control" disabled style="width:70%;"> 
                                	<!-- <select class="form-control" style="width:180px;"  id="xgtaskNo2" disabled>
                                    </select> -->	
                                </td>
                            </tr>
                            <tr>
                                <td>承接合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" style="width:70%;"  id="xgcjhetong" >
                                    </select>
                                </td>
                                <td>承接合同编号  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control"  id="xgcjhetonghao" style="width:70%;">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                           		<td style="width:100px;">采购结算申请单号  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                	<input type="text" class="form-control" id="xgcgjshao"  disabled style="width:70%;">
                                </td>
                                <td>审计结算类型</td>
                                <td>
                                    <select class="form-control" id="xgjiesuantype" style="width:70%;">
                                        <option>中间结算</option>
                                        <option>最终结算</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>时间</td>
                                <td><input type="text" id="xgyear" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>内容概述</td>
                                <td colspan="3">
                                        <textarea class="form-control" id="xggaishu" rows="4" style="width:100%;"></textarea>
                                </td>
                            </tr>
                        </table>
                        <table class="table table-bordered table-condensed" id="cgjs_accessory2">
							<thead>
								<tr>
	                                <td style="width:15%;">法律顾问签字:  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
	                                <td colspan="3">
	                                	<button type="button" class="btn btn-primary weui-uploader__input" onclick="addcgjsFile2()">添加附件</button>
	                                </td>
	                            </tr>
							</thead>
							<tbody>
							</tbody>
						</table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default" onclick="checkSavecgjiesuan()">保存</button>
            <button type="button" class="btn btn-success" onclick="checkSubmitcgjiesuan()">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- 修改model结束 -->

        </div>
        <div class="LowerPart" style="margin-top:3px;">
            <table class="table table-bordered table-condensed" id="mainContent2">
                <thead>
                    <tr>
                        <th>任务单号</th>
                        <th>项目名称</th>
                        <th>采购合同</th>
                        <th>承接合同</th>
                        <th>审计结算类型</th>
                        <th>时间</th>
                        <th style="width:75px;">操作</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>   
            </table>
<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg2">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>所有信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered table-condensed">
                        <tr>
                            <td style="width:100px;">采购合同名</td>
                            <td id="lookcghetong"></td>
                            <td style="width:100px;">采购合同号</td>
                            <td id="lookcghetonghao2"></td>
                        </tr>
                        <tr>
                            <td>项目名称</td>
                            <td id="lookprjName2"></td>
                            <td style="width:100px;">任务单号</td>
                            <td id="looktaskNo2"></td>
                        </tr>
                        <tr>
                            <td>承接合同名</td>
                            <td id="lookcjhetong"></td>
                            <td>承接合同号</td>
                            <td id="lookcjhetonghao"></td>
                        </tr>
                        <tr>
                        	<td style="width:100px;">采购结算申请单号</td>
                            <td id="lookcgjshao"></td>
                            <td>审计结算类型</td>
                            <td id="lookjiesuantype"></td>
                        </tr>
                        <tr>
                            <td>时间</td>
                            <td id="lookyear"></td>
                        </tr>
                        <tr>
                            <td>内容概述</td>
                            <td colspan="3" id="lookgaishu"></td>
                        </tr>
                    </table>
                    <table class="table table-bordered table-condensed" id="look_cgjs_accessory">
					</table>
                     <!-- 历史信息表格 -->
				    <table style="width:100%;" class="table table-bordered table-condensed" id="lookHistory2">
                        <thead>
                            <tr>
                                <th colspan="6">历史信息</th>
                            </tr>
                            <tr>
                                <td>任务单号</td>
                                <td>项目名称</td>
                                <td>采购合同</td>
                                <td>修改时间</td>
                                <td>操作</td>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </form>  
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- 结束 -->
<!-- 采购结算申请历史所有信息 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="History2">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>历史所有信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered table-condensed">
                        <tr>
                        	 <td style="width:100px;">采购合同名</td>
                            <td id="Historycghetong"></td>
                             <td style="width:100px;">采购合同号</td>
                            <td id="Historycghetonghao2"></td>
                        </tr>
                        <tr>
                            <td style="width:100px;">项目名称</td>
                            <td id="HistoryprjName2"></td>
                            <td style="width:100px;">任务单号</td>
                            <td id="HistorytaskNo2"></td>
                        </tr>
                        <tr>
                            <td>承接合同名</td>
                            <td id="Historycjhetong"></td>
                            <td>承接合同号</td>
                            <td id="Historycjhetonghao"></td>
                        </tr>
                        <tr>
                        	<td style="width:100px;">采购结算申请单号</td>
                            <td id="Historycgjshao"></td>
                            <td>审计结算类型</td>
                            <td id="Historyjiesuantype"></td>
                        </tr>
                        <tr>
                            <td>时间</td>
                            <td id="Historyyear"></td>
                        </tr>
                        <tr>
                            <td>内容概述</td>
                            <td colspan="3" id="Historygaishu"></td>
                        </tr>
                    </table>
                    <table class="table table-bordered table-condensed" id="History_cgjs_accessory">
					</table>
                </form>  
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- allMsg结束 -->
        </div>
    </div>
            </div>

            <div role="tabpanel" class="tab-pane" id="messages">
                <div class="zhuti-content">
        <div class="UpperPart">
            <div class="UpperPartL">
                
            </div>
            <div class="UpperPartR">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal3">新建采购合同履约申请表</button>
                <button type="button" class="btn btn-primary" id="daochu">导出打印</button>
            </div>
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal3">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>新建采购合同履约申请表</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form id="new_form" class="form-inline"  method="post" enctype="multipart/form-data">
                        <table class="table table-bordered table-condensed">
                            <tr>
                                <td style="width:20%;">采购合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:30%;">
                                    <select class="form-control" style="width:70%;"  id="cghetongming">
                                        
                                    </select>
                                </td>
                                <td style="width:20%;">采购合同号</td>
                                <td style="width:30%;">
                                	<!-- <input type="text" id="cghetonghao" class="form-control" disabled> -->
                                	<select class="form-control" style="width:70%;"  id="cghetonghao">
                                        
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>任务单号</td>
                                <td><input type="text" id="renwudanhao" class="form-control" disabled style="width:70%;"></td>
                                <td>项目负责人</td>
                                <td>
                                    <select class="form-control" id="prjperson3" style="width:70%;">
                                        <option>1</option>
                                        <option>2</option>
                                        <option>3</option>
                                        <option>4</option>
                                        <option>5</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:100px;">承接合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" id="cjhetongming" style="width:70%;">
                                        
                                    </select>
                                </td>
                                <td>承接合同编号</td>
                                <td>
                                	<!-- <input type="text" id="cjhetongbianhao" class="form-control" disabled> -->
                                	<select class="form-control" id="cjhetongbianhao" style="width:70%;">
                                        
                                    </select>
                                </td>
                            </tr>
                            
                            <tr>
                                <td>合同乙方</td>
                                <td>
                                    <select class="form-control" id="yifang" style="width:70%;">
                                        
                                    </select>
                                </td>
                                <td>分包负责人</td>
                                <td><input type="text" id="fbperson" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>合同金额</td>
                                <td><input type="text" id="hetongMoney" class="form-control" style="width:70%;"></td>
                                <td>暂定金</td>
                                <td><input type="text" id="zandingMoney" class="form-control"  style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>结算金额</td>
                                <td><input type="text" id="jiesuanMoney" class="form-control" style="width:70%;"></td>
                                <td>结算说明</td>
                                <td><input type="text" id="jiesuandesc" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>累计付款</td>
                                <td><input type="text" id="ljfukuan" class="form-control" style="width:70%;"></td>
                                <td>履约评级</td>
                                <td><input type="text" id="lypingji" class="form-control"  style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>项目概况、工作内容、实际工期</td>
                                <td colspan="3">
                                    <div class="form-group">
                                        <textarea class="form-control" id="prjgaikuang" rows="4" style="width:100%;"></textarea>
                                    </div> 
                                </td>
                            </tr>
						<!-- <tr>
                                <td>附件</td>
                                <td colspan="3"><input type="file" class="form-control"></td>
                            </tr> -->
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory">
                        	<thead>
                        		<tr>
                                	<td style="width:15%;">合同文本  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory2">
                        	<thead>
                        		<tr>
                                	<td style="width:15%;">法律顾问签字 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile2()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default" onclick="savecgly()">保存</button>
            <button type="button" class="btn btn-success" onclick="submitcgly()">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- model结束 -->

<!-- 修改Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="change3">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>修改合同履约申请表</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form id="edit_form" class="form-inline" method="post" enctype="multipart/form-data">
                        <table class="table table-bordered table-condensed">
                            <tr>
                                <td style="width:20%;">采购合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td style="width:30%;">
                                    <select class="form-control" style="width:70%;"  id="xgcghetongming">
                                        
                                    </select>
                                </td>
                                <td style="width:20%;">采购合同号</td>
                                <td style="width:30%;">
                                	<!-- <input type="text" class="form-control" disabled> -->
                                	<select class="form-control" style="width:70%;"  id="xgcghetonghao">
                                        
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>任务单号</td>
                                <td><input type="text" class="form-control" id="xgrenwudanhao" disabled></td>
                                <td>项目负责人</td>
                                <td>
                                    <select class="form-control" id="xgprjperson3" style="width:70%;">
                                        <option>1</option>
                                        <option>2</option>
                                        <option>3</option>
                                        <option>4</option>
                                        <option>5</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:100px;">承接合同名称  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                <td>
                                    <select class="form-control" id="xgcjhetongming" style="width:70%;">
                                        
                                    </select>
                                </td>
                                <td>承接合同编号</td>
                                <td>	
                                	<!-- <input type="text" class="form-control" disabled> -->
                                	<select class="form-control" id="xgcjhetongbianhao" style="width:70%;">
                                        
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>合同乙方</td>
                                <td>
                                    <select class="form-control" id="xgyifang" style="width:70%;">
                                        
                                    </select>
                                </td>
                                <td>分包负责人</td>
                                <td><input type="text" id="xgfbperson" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>合同金额</td>
                                <td><input type="text" id="xghetongMoney" class="form-control" style="width:70%;"></td>
                                <td>暂定金</td>
                                <td><input type="text" id="xgzandingMoney" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>结算金额</td>
                                <td><input type="text" id="xgjiesuanMoney" class="form-control" style="width:70%;"></td>
                                <td>结算说明</td>
                                <td><input type="text" id="xgjiesuandesc" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>累计付款</td>
                                <td><input type="text" id="xgljfukuan" class="form-control" style="width:70%;"></td>
                                <td>履约评级</td>
                                <td><input type="text" id="xglypingji" class="form-control" style="width:70%;"></td>
                            </tr>
                            <tr>
                            	<td>采购合同履约申请单号</td>
                                <td><input type="text" id="xgcglydanhao" class="form-control" disabled style="width:70%;"></td>
                            </tr>
                            <tr>
                                <td>项目概况、工作内容、实际工期</td>
                                <td colspan="3">
                                        <textarea class="form-control" id="xgprjgaikuang" rows="4" style="width:100%;"></textarea>
                                </td>
                            </tr>
<!--                             <tr>
                                <td>附件</td>
                                <td colspan="3"><input type="file" class="form-control"></td>
                            </tr> -->
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory">
                        	<thead>
                        		<tr>
                                	<td style="width:15%;">合同文本  <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                               	 	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile3()">添加附件</button></td>
                           		</tr>
                        	</thead>
                        	<tbody>
                        	</tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory2">
                        	<thead>
                        		<tr>
                                	<td style="width:15%;">法律顾问签字 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile4()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default" onclick="checkcglySave()">保存</button>
            <button type="button" class="btn btn-success" onclick="checkcglySubmit()">提交</button>
        </div>
        </div>
    </div>
</div>
<!-- 修改model结束 -->

        </div>
        <div class="LowerPart" style="margin-top:3px;">
            <table class="table table-bordered table-condensed" id="mainContent3">
                <thead>
                    <tr>
                        <th>采购合同号</th>
                        <th>采购合同名称</th>
                        <th>任务单号</th>
                        <th>承接合同编号</th>
                        <th>承接合同名称</th>
                        <th>合同金额</th>
                        <th style="width:75px;">操作</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>   
            </table>
<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg3">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>所有信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered table-condensed">
                        <tr>
                            <td>采购合同名称</td>
                            <td id="lookcghetongming"></td>
                            <td style="width:100px;">采购合同号</td>
                            <td id="lookcghetonghao"></td>
                        </tr>
                        <tr>
                            <td>任务单号</td>
                            <td id="lookrenwudanhao"></td>
                            <td>项目负责人</td>
                            <td id="lookprjperson3"></td>
                        </tr>
                        <tr>
                            <td style="width:100px;">承接合同名称</td>
                            <td id="lookcjhetongming"></td>
                            <td>承接合同编号</td>
                            <td id="lookcjhetongbianhao"></td>
                        </tr>
                        <tr>
                            <td>合同乙方</td>
                            <td id="lookyifang"></td>
                            <td>分包负责人</td>
                            <td id="lookfbperson"></td>
                        </tr>
                        <tr>
                            <td>合同金额</td>
                            <td id="lookhetongMoney"></td>
                            <td>暂定金</td>
                            <td id="lookzandingMoney"></td>
                        </tr>
                        <tr>
                            <td>结算金额</td>
                            <td id="lookjiesuanMoney"></td>
                            <td>结算说明</td>
                            <td id="lookjiesuandesc"></td>
                        </tr>
                        <tr>
                            <td>累计付款</td>
                            <td id="lookljfukuan"></td>
                            <td>履约评级</td>
                            <td id="looklypingji"></td>
                        </tr>
                        <tr>
                           	<td>采购合同履约申请单号</td>
                            <td id="lookcglydanhao"></td>
                        </tr>
                        <tr>
                            <td>项目概况、工作内容、实际工期</td>
                            <td colspan="3" id="lookprjgaikuang"></td>
                        </tr>
<!--                         <tr>
                            <td>附件</td>
                            <td colspan="3">asrasrasr</td>
                        </tr> -->
                    </table>
					<table class="table table-bordered table-condensed"  id="look_all_table">
				                        		
				    </table>
				    <table class="table table-bordered table-condensed"  id="look_all_table2">
				                        		
				    </table>
				    <!-- 历史信息表格 -->
				    <table style="width:100%;" class="table table-bordered table-condensed" id="lookHistory3">
                        <thead>
                            <tr>
                                <th colspan="6">历史信息</th>
                            </tr>
                            <tr>
                                <td>采购合同号</td>
                                <td>采购合同名称</td>
                                <td>任务单号</td>
                                <td>修改时间</td>
                                <td>操作</td>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </form>  
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- allMsg结束 -->
<!-- 采购合同履约历史信息开始 -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="History3">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>历史所有信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered table-condensed">
                        <tr>
                            <td>采购合同名称</td>
                            <td id="Historycghetongming"></td>
                            <td style="width:100px;">采购合同号</td>
                            <td id="Historycghetonghao"></td>
                        </tr>
                        <tr>
                            <td>任务单号</td>
                            <td id="Historyrenwudanhao"></td>
                            <td>项目负责人</td>
                            <td id="Historyprjperson3"></td>
                        </tr>
                        <tr>
                            <td style="width:100px;">承接合同名称</td>
                            <td id="Historycjhetongming"></td>
                            <td>承接合同编号</td>
                            <td id="Historycjhetongbianhao"></td>
                        </tr>
                        <tr>
                            <td>合同乙方</td>
                            <td id="Historyyifang"></td>
                            <td>分包负责人</td>
                            <td id="Historyfbperson"></td>
                        </tr>
                        <tr>
                            <td>合同金额</td>
                            <td id="HistoryhetongMoney"></td>
                            <td>暂定金</td>
                            <td id="HistoryzandingMoney"></td>
                        </tr>
                        <tr>
                            <td>结算金额</td>
                            <td id="HistoryjiesuanMoney"></td>
                            <td>结算说明</td>
                            <td id="Historyjiesuandesc"></td>
                        </tr>
                        <tr>
                            <td>累计付款</td>
                            <td id="Historyljfukuan"></td>
                            <td>履约评级</td>
                            <td id="Historylypingji"></td>
                        </tr>
                        <tr>
                           	<td>采购合同履约申请单号</td>
                            <td id="Historycglydanhao"></td>
                        </tr>
                        <tr>
                            <td>项目概况、工作内容、实际工期</td>
                            <td colspan="3" id="Historyprjgaikuang"></td>
                        </tr>
<!--                         <tr>
                            <td>附件</td>
                            <td colspan="3">asrasrasr</td>
                        </tr> -->
                    </table>
					<table class="table table-bordered table-condensed"  id="History_all_table">
				                        		
				    </table>
				    <table class="table table-bordered table-condensed"  id="History_all_table2">
				                        		
				    </table>
                </form>  
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- 历史结束 -->
        </div>
    </div>
            </div>
        </div>
    </div>
</body>
<script src="../../js/jquery.js"></script>
<script src="../../js/common-scripts.js"></script>
<script src="../../js/jquery.dataTables.min.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/laydate/laydate.js"></script>
<script src="../../js/jquery-editable-select.js"></script>
<script src="../../js/jquery-form.min.js"></script>
<script src="../../toastr/toastr.js"></script>
<script>
    $(document).ready( function () {
    	initTable();
    	initSelect();
    	initbumen();
    	
    	initTable2();
    	initSelect2();
    	cjhetongNameSelect();
    	
    	initTable3();
    	initSelectCG();
    	initSelectCJ();
    	inityifang();
    	laydate.render({
            elem: '#year' //指定元素
        });
    	$('#editable-select').editableSelect({ 
            effects: 'slide' 
        });
        $('#editable-select2').editableSelect({ 
            effects: 'slide' 
        });
        $('#editable-select3').editableSelect({ 
            effects: 'slide' 
        });
        $('#editable-select4').editableSelect({ 
            effects: 'slide' 
        });
	});
 <!-- 履约评价 -->
    var table=$('#mainContent').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "materialContractCode"},
            { "data": "taskNo"}, 
            { "data": "prjName"}, 
            { "data": "prjPerson"}, 
            { "data": "department"}, 
            { "data": "contractAllMoney"}, 
            { "data": "contractEndMoney"}, 
            { "data": "payMode"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 8,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="looklypingjia(this)" data-toggle="modal" data-target="#allMsg1"   id="lookDetall"></i><i class="iconfont icon-xiugai iconxiugai" style="font-size:18px;cursor:pointer;" title="合同变更" onclick="checkLypingjia(this)" data-toggle="modal" data-target="#change"  id="Changedanwei"></i>'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
	});
    <!-- 履约评价的历史表格 -->
    var table1=$('#lookHistory').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "materialContractCode"}, 
            { "data": "taskNo"}, 
            { "data": "prjName"}, 
            { "data": "makeTime"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 4,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="lookHistorylypingjia(this)" data-toggle="modal" data-target="#History"  id="lookDetall"></i>'
								        }
								  }
						],
        "order": [[1, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
	});
    
 <!-- 采购结算申请 -->
    var table2=$('#mainContent2').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "taskNo"},
            { "data": "prjName"}, 
            { "data": "cgContract"}, 
            { "data": "cjContract"}, 
            { "data": "auditSettlementType"}, 
            { "data": "settlementTime"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 6,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="lookcgjiesuan(this)" data-toggle="modal" data-target="#allMsg2"   id="lookDetall"></i><i class="iconfont icon-xiugai iconxiugai" style="font-size:18px;cursor:pointer;" title="合同变更" onclick="checkcgjiesuan(this)" data-toggle="modal" data-target="#change2"  id="Changedanwei"></i>'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
	});
    <!-- 采购结算申请的历史表格 -->
    var table22=$('#lookHistory2').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "taskNo"}, 
            { "data": "prjName"}, 
            { "data": "cgContract"}, 
            { "data": "makeTime"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 4,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="lookHistorycgjiesuan(this)" data-toggle="modal" data-target="#History2"  id="lookDetall"></i>'
								        }
								  }
						],
        "order": [[1, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
	});
    
    <!-- 采购合同履约 -->
    var table3=$('#mainContent3').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "cgNo"},
            { "data": "cgContract"}, 
            { "data": "taskNo"}, 
            { "data": "cjNo"}, 
            { "data": "cjContract"}, 
            { "data": "contractMoney"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 6,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="lookcgly(this)" data-toggle="modal" data-target="#allMsg3"   id="lookDetall"></i><i class="iconfont icon-xiugai iconxiugai" style="font-size:18px;cursor:pointer;" title="合同变更" onclick="checkcgly(this)" data-toggle="modal" data-target="#change3"  id="Changedanwei"></i>'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
	});
    <!-- 采购合同履约的历史表格 -->
    var table33=$('#lookHistory3').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "cgNo"}, 
            { "data": "cgContract"}, 
            { "data": "taskNo"}, 
            { "data": "makeTime"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 4,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="lookHistorycgly(this)" data-toggle="modal" data-target="#History3"  id="lookDetall"></i>'
								        }
								  }
						],
        "order": [[1, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
	});
  //初始化采购合同履约
	function initTable3(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/materialPerformance/selectmaterialPerformanceByStatus',
            dataType: 'json',
            data: {
            	status:2,
            },
            success: function (json) {
                $('#mainContent3').dataTable().fnClearTable();
                $('#mainContent3').DataTable().rows.add(json).draw(false);
            }
        });
    }
    
    
  
	//初始化采购合同名和采购合同号
    function initSelectCG(){
		$.ajax({
        type: 'POST',
        url: getContextPath()+'/cgcontract/getCGNameAndNo',
        dataType: 'json',
        data: {
        },
        error: function (msg) {
        	toastr.error("请求失败");
        },
        success: function (json) {
        	console.log(json)
        	$("#cghetongming").html('');
        	$("#cghetonghao").html('');
        	$("#xgcghetongming").html('');
        	$("#xgcghetonghao").html('');
        	for(var i=0;i<json.length;i++){
        		$("#cghetongming").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
        		$("#cghetonghao").append("<option value="+json[i].cgNo+">"+json[i].cgNo+"</option>");
        		$("#xgcghetongming").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
        		$("#xgcghetonghao").append("<option value="+json[i].cgNo+">"+json[i].cgNo+"</option>");
        	}
        	$('#cghetongming').editableSelect().on('select.editable-select', function (e, dom) {
        		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNoByName',
                    dataType: 'json',
                    data: {
                    	contractName:$('#cghetongming').val()
                    },
                    success: function (json) {
                    	console.log(json)
                    	for(var i=0;i<json.length;i++){
	                    	$('#cghetonghao').val(json[i].cgNo);
	                    	$('#renwudanhao').val(json[i].workNo);
                    	}
                    }
          		});
          	})
          	$('#cghetonghao').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNameByNo',
                    dataType: 'json',
                    data: {
                    	cgNo:$('#cghetonghao').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
	                    	$('#cghetongming').val(json[i].contractName);
	                    	$('#renwudanhao').val(json[i].workNo);
                    	}
                    }
          		});
		  	})
		  	
		  	 $('#xgcghetongming').editableSelect().on('select.editable-select', function (e, dom) {
        		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNoByName',
                    dataType: 'json',
                    data: {
                    	contractName:$('#xgcghetongming').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
		                    $('#xgcghetonghao').val(json[i].cgNo);
		                    $('#xgrenwudanhao').val(json[i].workNo);
                    	}
                    }
          		});
          	})
          	$('#xgcghetonghao').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNameByNo',
                    dataType: 'json',
                    data: {
                    	cgNo:$('#xgcghetonghao').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
		                    $('#xgcghetongming').val(json[i].contractName);
		                    $('#xgrenwudanhao').val(json[i].workNo);
                    	}
                    }
          		});
		  	}) 
        }
		});
	}
  
  //初始化承接合同名称和承接合同号
	 function initSelectCJ(){
			$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/cj/selectNameAndNo',
	        dataType: 'json',
	        data: {
	        },
	        error: function (msg) {
	        	toastr.error("请求失败");
	        },
	        success: function (json) {
	        	$("#cjhetongming").html('');
	        	$("#cjhetongbianhao").html('');
	        	$("#xgcjhetongming").html('');
	        	$("#xgcjhetongbianhao").html('');
	        	for(var i=0;i<json.length;i++){
	        		$("#cjhetongming").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
	        		$("#cjhetongbianhao").append("<option value="+json[i].contractNo+">"+json[i].contractNo+"</option>");
	        		$("#xgcjhetongming").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
	        		$("#xgcjhetongbianhao").append("<option value="+json[i].contractNo+">"+json[i].contractNo+"</option>");
	        	}
	        	$('#cjhetongming').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByName',
	                    dataType: 'json',
	                    data: {
	                    	name:$('#cjhetongming').val()
	                    },
	                    success: function (json) {
	                    	$('#cjhetongbianhao').val(json.contractNo);
	                    }
	          		});
	          	})
	          	$('#cjhetongbianhao').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByNo',
	                    dataType: 'json',
	                    data: {
	                    	no:$('#cjhetongbianhao').val()
	                    },
	                    success: function (json) {
	                    	$('#cjhetongming').val(json.contractName);
	                    }
	          		});
			  	})
			  	
			  	 $('#xgcjhetongming').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByName',
	                    dataType: 'json',
	                    data: {
	                    	name:$('#xgcjhetongming').val()
	                    },
	                    success: function (json) {
	                    	$('#xgcjhetongbianhao').val(json.contractNo);
	                    }
	          		});
	          	})
	          	$('#xgcjhetongbianhao').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByNo',
	                    dataType: 'json',
	                    data: {
	                    	no:$('#xgcjhetongbianhao').val()
	                    },
	                    success: function (json) {
	                    	$('#xgcjhetongming').val(json.contractName);
	                    }
	          		});
			  	}) 
	        }
			});
		}
	
	
  
	
  //初始化乙方
    function inityifang(){
	    $.ajax({
	        type: 'POST',
	        url: getContextPath()+'/supplier/selectIdAndName',
	        dataType: 'json',
	        data: {
	        },
	        success: function (json) {
	        	$("#yifang").html('');
	        	$("#xgyifang").html('');
	        	 for(var i=0;i<json.length;i++){
	        		$("#yifang").append( "<option value='" + json[i].spId + "'>"
		                    + json[i].spName + "</option>")
		            $("#xgyifang").append( "<option value='" + json[i].spId + "'>"
		                    + json[i].spName + "</option>")
	        	}
	        }
	    });
	}
	
  //添加保存采购合同履约
	function savecgly(){
		var cghetongming=$("#cghetongming").val();
		var cghetonghao=$("#cghetonghao").val();
		var renwudanhao=$("#renwudanhao").val();
		var prjperson3=$("#prjperson3").val();
		var cjhetongming=$("#cjhetongming").val();
		var cjhetongbianhao=$("#cjhetongbianhao").val();
		var yifang=$("#yifang").val();
		var fbperson=$("#fbperson").val();
		var hetongMoney=$("#hetongMoney").val();
		var zandingMoney=$("#zandingMoney").val();
		var jiesuanMoney=$("#jiesuanMoney").val();
		var jiesuandesc=$("#jiesuandesc").val();
		var ljfukuan=$("#ljfukuan").val();
		var lypingji=$("#lypingji").val();
		var prjgaikuang=$("#prjgaikuang").val();
		
		var options={
	            type: 'POST',
	            url: getContextPath()+'/materialPerformance/addmaterialPerformanceSave',
	            dataType: 'json',
	            data: { 
	            	cgContract:cghetongming,
	            	cgNo:cghetonghao,
	            	taskNo:renwudanhao,
	            	prjPerson:prjperson3,
	            	cjContract:cjhetongming,
	            	cjNo:cjhetongbianhao,
	            	contractYi:yifang,
	            	fbPerson:fbperson,
	            	contractMoney:hetongMoney,
	            	provisionalMoney:zandingMoney,
	            	settlementMoney:jiesuanMoney,
	            	settlementDesc:jiesuandesc,
	            	accumulativePaymentMoney:ljfukuan,
	            	performanceGrade:lypingji,
	            	performanceDesc:prjgaikuang,
	            },
	            success: function (json) {
	            	console.log(json);
	            	if(json.result>0){
						$("#myModal3").modal("hide")
						toastr.success("添加成功")
						initTable3();
					}else{
						toastr.error("添加失败")
					}
	            }
	        };
			$("#new_form").ajaxSubmit(options);
	}
	//添加提交采购合同履约
	function submitcgly(){
		var cghetongming=$("#cghetongming").val();
		var cghetonghao=$("#cghetonghao").val();
		var renwudanhao=$("#renwudanhao").val();
		var prjperson3=$("#prjperson3").val();
		var cjhetongming=$("#cjhetongming").val();
		var cjhetongbianhao=$("#cjhetongbianhao").val();
		var yifang=$("#yifang").val();
		var fbperson=$("#fbperson").val();
		var hetongMoney=$("#hetongMoney").val();
		var zandingMoney=$("#zandingMoney").val();
		var jiesuanMoney=$("#jiesuanMoney").val();
		var jiesuandesc=$("#jiesuandesc").val();
		var ljfukuan=$("#ljfukuan").val();
		var lypingji=$("#lypingji").val();
		var prjgaikuang=$("#prjgaikuang").val();
		
		var options={
	            type: 'POST',
	            url: getContextPath()+'/materialPerformance/addmaterialPerformanceSubmit',
	            dataType: 'json',
	            data: { 
	            	cgContract:cghetongming,
	            	cgNo:cghetonghao,
	            	taskNo:renwudanhao,
	            	prjPerson:prjperson3,
	            	cjContract:cjhetongming,
	            	cjNo:cjhetongbianhao,
	            	contractYi:yifang,
	            	fbPerson:fbperson,
	            	contractMoney:hetongMoney,
	            	provisionalMoney:zandingMoney,
	            	settlementMoney:jiesuanMoney,
	            	settlementDesc:jiesuandesc,
	            	accumulativePaymentMoney:ljfukuan,
	            	performanceGrade:lypingji,
	            	performanceDesc:prjgaikuang,
	            },
	            success: function (json) {
	            	console.log(json);
	            	if(json.result>0){
						$("#myModal3").modal("hide")
						toastr.success("添加成功")
						initTable3();
					}else{
						toastr.error("添加失败")
					}
	            }
	        };
			$("#new_form").ajaxSubmit(options);
	}
	
	//修改回显
	var xgpId;
	function checkcgly(obj){
		var dom=$(obj).parents('tr');
		var data=$('#mainContent3').DataTable().row(dom).data();
		console.log(data)
		xgpId=data.pId;
		$("#xgcghetongming").val(data.cgContract);
		$("#xgcghetonghao").val(data.cgNo);
		$("#xgrenwudanhao").val(data.taskNo);
		$("#xgprjperson3").val(data.prjPerson);
		$("#xgcjhetongming").val(data.cjContract);
		$("#xgcjhetongbianhao").val(data.cjNo);
		$("#xgyifang").val(data.contractYi);
		$("#xgfbperson").val(data.fbPerson);
		$("#xghetongMoney").val(data.contractMoney);
		$("#xgzandingMoney").val(data.provisionalMoney);
		$("#xgjiesuanMoney").val(data.settlementMoney);
		$("#xgjiesuandesc").val(data.settlementDesc);
		$("#xgljfukuan").val(data.accumulativePaymentMoney);
		$("#xglypingji").val(data.performanceGrade);
		$("#xgcglydanhao").val(data.pNo)
		$("#xgprjgaikuang").val(data.performanceDesc);
		
		/* $.ajax({
			type:"post",
			url:getContextPath()+"/materialPerformance/selectAccessoryById",
			dataType:"json",
			async:false,
			data:{
				id:data.pId,
			},
			success:function(json){
				//console.log(json);
				$("#edit_accessory tbody").empty();
	               for(var i=0;i<json.length;i++){
	            	   $("#edit_accessory tbody").append("<tr>"+
         	   												"<td>合同文本"+(i+1)+"</td>"+
									            	    	"<td ><input type='text' class='form-control' style='width:70%;' value='"+json[i].acName+"' disabled></td>"+
									            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+json[i].aId+"' data2='"+json[i].acUrl+"' onclick='deletefile(this)'>删除附件</button></td>"+
									            	    "</tr>");
	               }
			}
		}) */
	}
	//删除附件
	function deletefile(obj){
		var id=$(obj).attr("data1");
		var name=$(obj).parents("tr").find("td").eq(1).find("input").val();
		var url=$(obj).attr("data2");
		$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/materialPerformance/deleteAccessory',
	        dataType: 'json',
	        data: {
	        	aId:id,
	        	acName:name,
	        	acUrl:url
	        },
	        success: function (json) {
	        	if(json==0){
	        		toastr.error("删除失败");
	        	}else{
	        		toastr.success("删除成功");
	        		$(obj).parent().parent().remove();
	        	}
	        }
		});
	}
  
	//修改保存采购合同履约
	function checkcglySave(){
		var xgcghetongming=$("#xgcghetongming").val();
		var xgcghetonghao=$("#xgcghetonghao").val();
		var xgrenwudanhao=$("#xgrenwudanhao").val();
		var xgprjperson3=$("#xgprjperson3").val();
		var xgcjhetongming=$("#xgcjhetongming").val();
		var xgcjhetongbianhao=$("#xgcjhetongbianhao").val();
		var xgyifang=$("#xgyifang").val();
		var xgfbperson=$("#xgfbperson").val();
		var xghetongMoney=$("#xghetongMoney").val();
		var xgzandingMoney=$("#xgzandingMoney").val();
		var xgjiesuanMoney=$("#xgjiesuanMoney").val();
		var xgjiesuandesc=$("#xgjiesuandesc").val();
		var xgljfukuan=$("#xgljfukuan").val();
		var xglypingji=$("#xglypingji").val();
		var xgcglydanhao=$("#xgcglydanhao").val();
		var xgprjgaikuang=$("#xgprjgaikuang").val();
		
		
		var options2={
	            type: 'POST',
	            url: getContextPath()+'/materialPerformance/updatematerialPerformanceSave',
	            dataType: 'json',
	            data: { 
	            	pId:xgpId,
	            	cgContract:xgcghetongming,
	            	cgNo:xgcghetonghao,
	            	taskNo:xgrenwudanhao,
	            	prjPerson:xgprjperson3,
	            	cjContract:xgcjhetongming,
	            	cjNo:xgcjhetongbianhao,
	            	contractYi:xgyifang,
	            	fbPerson:xgfbperson,
	            	contractMoney:xghetongMoney,
	            	provisionalMoney:xgzandingMoney,
	            	settlementMoney:xgjiesuanMoney,
	            	settlementDesc:xgjiesuandesc,
	            	accumulativePaymentMoney:xgljfukuan,
	            	performanceGrade:xglypingji,
	            	pNo:xgcglydanhao,
	            	performanceDesc:xgprjgaikuang,
	            },
	            success: function (json) {
	            	console.log(json);
	            	if(json.result>0){
						$("#change3").modal("hide")
						toastr.success("修改成功")
						initTable3();
					}else{
						toastr.error("修改失败")
					}
	            }
	        };
			$("#edit_form").ajaxSubmit(options2);
	}
	
	//修改提交采购合同履约
	function checkcglySubmit(){
		var xgcghetongming=$("#xgcghetongming").val();
		var xgcghetonghao=$("#xgcghetonghao").val();
		var xgrenwudanhao=$("#xgrenwudanhao").val();
		var xgprjperson3=$("#xgprjperson3").val();
		var xgcjhetongming=$("#xgcjhetongming").val();
		var xgcjhetongbianhao=$("#xgcjhetongbianhao").val();
		var xgyifang=$("#xgyifang").val();
		var xgfbperson=$("#xgfbperson").val();
		var xghetongMoney=$("#xghetongMoney").val();
		var xgzandingMoney=$("#xgzandingMoney").val();
		var xgjiesuanMoney=$("#xgjiesuanMoney").val();
		var xgjiesuandesc=$("#xgjiesuandesc").val();
		var xgljfukuan=$("#xgljfukuan").val();
		var xglypingji=$("#xglypingji").val();
		var xgcglydanhao=$("#xgcglydanhao").val();
		var xgprjgaikuang=$("#xgprjgaikuang").val();
		
		
		var options2={
	            type: 'POST',
	            url: getContextPath()+'/materialPerformance/updatematerialPerformanceSubmit',
	            dataType: 'json',
	            data: { 
	            	pId:xgpId,
	            	cgContract:xgcghetongming,
	            	cgNo:xgcghetonghao,
	            	taskNo:xgrenwudanhao,
	            	prjPerson:xgprjperson3,
	            	cjContract:xgcjhetongming,
	            	cjNo:xgcjhetongbianhao,
	            	contractYi:xgyifang,
	            	fbPerson:xgfbperson,
	            	contractMoney:xghetongMoney,
	            	provisionalMoney:xgzandingMoney,
	            	settlementMoney:xgjiesuanMoney,
	            	settlementDesc:xgjiesuandesc,
	            	accumulativePaymentMoney:xgljfukuan,
	            	performanceGrade:xglypingji,
	            	pNo:xgcglydanhao,
	            	performanceDesc:xgprjgaikuang,
	            },
	            success: function (json) {
	            	console.log(json);
	            	if(json.result>0){
						$("#change3").modal("hide")
						toastr.success("修改成功")
						initTable3();
					}else{
						toastr.error("修改失败")
					}
	            }
	        };
			$("#edit_form").ajaxSubmit(options2);
	}
	
	
	//查看详细信息
	var pNo;
	function lookcgly(obj){
		var dom=$(obj).parents('tr');
		var data=$('#mainContent3').DataTable().row(dom).data();
		console.log(data)
		pNo=data.pNo;
		
		$("#lookcghetongming").text(data.cgContract);
		$("#lookcghetonghao").text(data.cgNo);
		$("#lookrenwudanhao").text(data.taskNo);
		$("#lookprjperson3").text(data.prjPerson);
		$("#lookcjhetongming").text(data.cjContract);
		$("#lookcjhetongbianhao").text(data.cjNo);
		$("#lookyifang").text(data.spName);
		$("#lookfbperson").text(data.fbPerson);
		$("#lookhetongMoney").text(data.contractMoney);
		$("#lookzandingMoney").text(data.provisionalMoney);
		$("#lookjiesuanMoney").text(data.settlementMoney);
		$("#lookjiesuandesc").text(data.settlementDesc);
		$("#lookljfukuan").text(data.accumulativePaymentMoney);
		$("#looklypingji").text(data.performanceGrade);
		$("#lookcglydanhao").text(data.pNo)
		$("#lookprjgaikuang").text(data.performanceDesc);
		
		initTableHistory3();
		
		$.ajax({
			type:"post",
			url:getContextPath()+"/materialPerformance/selectAccessoryById",
			dataType:"json",
			async:false,
			data:{
				id:data.pId,
			},
			success:function(json){
				console.log(json);
				$("#look_all_table").empty();
				$("#look_all_table2").empty();
	               for(var i=0;i<json.length;i++){
	            	   if(json[i].aType=="合同文本"){
		            	   $("#look_all_table").append("<tr>"+
	      	   										"<td style='width:15%;'>合同文本</td>"+
							            	    	"<td><input type='text' class='form-control' style='width:70%;' value='"+json[i].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	            	   if(json[i].aType=="法律顾问签字"){
		            	   $("#look_all_table2").append("<tr>"+
	      	   										"<td style='width:15%;'>法律顾问签字</td>"+
							            	    	"<td><input type='text' class='form-control' style='width:70%;' value='"+json[i].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	               }
			}
		})
		
	}
	//下载附件
	function download_all(obj){
		var url=$(obj).attr("data1");
		var name=$(obj).parents("tr").find("td").eq(1).find("input").val();
		window.location.href=encodeURI(getContextPath()+"/FileDownLoad?fileName="+name+"&filePath="+url);
	}
  
	//初始化历史列表
	function initTableHistory3(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/materialPerformance/selectHistoryByNo',
            dataType: 'json',
            data: {
            	no:pNo,
            },
            success: function (json) {
            	//console.log(json)
                $('#lookHistory3').dataTable().fnClearTable();
                $('#lookHistory3').DataTable().rows.add(json).draw(false);
            }
        });
    }
	//查看历史详细信息
	function lookHistorycgly(obj){
		var dom=$(obj).parents('tr');
		var data=$('#lookHistory3').DataTable().row(dom).data();
		console.log(data)
		$('#History3').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		
		$("#Historycghetongming").text(data.cgContract);
		$("#Historycghetonghao").text(data.cgNo);
		$("#Historyrenwudanhao").text(data.taskNo);
		$("#Historyprjperson3").text(data.prjPerson);
		$("#Historycjhetongming").text(data.cjContract);
		$("#Historycjhetongbianhao").text(data.cjNo);
		$("#Historyyifang").text(data.spName);
		$("#Historyfbperson").text(data.fbPerson);
		$("#HistoryhetongMoney").text(data.contractMoney);
		$("#HistoryzandingMoney").text(data.provisionalMoney);
		$("#HistoryjiesuanMoney").text(data.settlementMoney);
		$("#Historyjiesuandesc").text(data.settlementDesc);
		$("#Historyljfukuan").text(data.accumulativePaymentMoney);
		$("#Historylypingji").text(data.performanceGrade);
		$("#Historycglydanhao").text(data.pNo)
		$("#Historyprjgaikuang").text(data.performanceDesc);
		
		$.ajax({
			type:"post",
			url:getContextPath()+"/materialPerformance/selectAccessoryById",
			dataType:"json",
			async:false,
			data:{
				id:data.pId,
			},
			success:function(json){
				console.log(json);
				$("#History_all_table").empty();
				$("#History_all_table2").empty();
	               for(var i=0;i<json.length;i++){
	            	   if(json[i].aType=="合同文本"){
		            	   $("#History_all_table").append("<tr>"+
	      	   										"<td style='width:15%;'>合同文本</td>"+
							            	    	"<td><input type='text' class='form-control' style='width:70%;' value='"+json[i].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	            	   if(json[i].aType=="法律顾问签字"){
		            	   $("#History_all_table2").append("<tr>"+
	      	   										"<td style='width:15%;'>法律顾问签字</td>"+
							            	    	"<td><input type='text' class='form-control' style='width:70%;' value='"+json[i].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	               }
			}
		})
	}
	
	
	
    
    function addFile(){
		$("#new_accessory tbody").append("<tr><td>新附件</td><td><input type='file' name='file'  style='width:70%;' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除附件</button></td></tr>");
	}
    function addFile2(){
		$("#new_accessory2 tbody").append("<tr><td>新附件</td><td><input type='file' name='file2'  style='width:70%;' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除附件</button></td></tr>");
	}
	function addFile3(){
		$("#edit_accessory tbody").append("<tr><td>新附件</td><td><input type='file' name='file'  style='width:70%;' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除附件</button></td></tr>");
	}
	function addFile4(){
		$("#edit_accessory2 tbody").append("<tr><td>新附件</td><td><input type='file' name='file2'  style='width:70%;' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除附件</button></td></tr>");
	}
	
	function removeFile(obj){
  		var tr=$(obj).parents("tr");
  		$(tr).remove();
  	}
    
	//导出
	$("#daochu").click(function(){
		window.location.href=encodeURI(getContextPath()+'/materialPerformance/exportmaterialPerformance');
	})
    
	
	
	
   <!--*************************************** 采购结算申请 *****************************************************-->
  //初始化采购结算申请
	function initTable2(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/materialPurchaseSettlement/selectmaterialPurchaseSettlement',
            dataType: 'json',
            data: {
            	status:2,
            },
            success: function (json) {
                $('#mainContent2').dataTable().fnClearTable();
                $('#mainContent2').DataTable().rows.add(json).draw(false);
            }
        });
    }
  
  
	function addcgjsFile(){
		$("#cgjs_accessory tbody").append("<tr><td>新附件</td><td><input type='file' name='file'  style='width:70%;' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除附件</button></td></tr>");
	}
	function addcgjsFile2(){
		$("#cgjs_accessory2 tbody").append("<tr><td>新附件</td><td><input type='file' name='file'  style='width:70%;' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除附件</button></td></tr>");
	}
	
	function download_all(obj){
		var url=$(obj).attr("data1");
		var name=$(obj).parents("tr").find("td").eq(1).find("input").val();
		
		window.location.href=encodeURI(getContextPath()+"/FileDownLoad?fileName="+name+"&filePath="+url);
	}
	
    //初始化采购合同
    function initSelect2(){
		$.ajax({
        type: 'POST',
        url: getContextPath()+'/cgcontract/getCGNameAndNo',
        dataType: 'json',
        data: {
        },
        error: function (msg) {
        	toastr.error("请求失败");
        },
        success: function (json) {
        	console.log(json)
        	$("#cghetong").html('');
        	$("#cghetonghao2").html('');
        	$('#xgcghetong').html('');
        	$('#xgcghetonghao2').html('');
        	for(var i=0;i<json.length;i++){
        		$("#cghetong").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
        		$("#xgcghetong").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
        		$("#cghetonghao2").append("<option value="+json[i].cgNo+">"+json[i].cgNo+"</option>");
        		$("#xgcghetonghao2").append("<option value="+json[i].cgNo+">"+json[i].cgNo+"</option>");
        	}
        	$('#cghetong').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNoByName',
                    dataType: 'json',
                    data: {
                    	contractName:$('#cghetong').val()
                    },
                    success: function (json) {
                    	//console.log(json)
                    	for(var i=0;i<json.length;i++){
	                    	$('#prjName2').val(json[i].prjName);
	                    	$('#taskNo2').val(json[i].workNo);
	                    	$("#cghetonghao2").val(json[i].cgNo)
                    	}
                    }
          		});
		  	})
		  	
		  	$('#cghetonghao2').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNameByNo',
                    dataType: 'json',
                    data: {
                    	cgNo:$('#cghetonghao2').val()
                    },
                    success: function (json) {
                    	//console.log(json)
                    	for(var i=0;i<json.length;i++){
	                    	$('#prjName2').val(json[i].prjName);
	                    	$('#taskNo2').val(json[i].workNo);
	                    	$('#cghetong').val(json[i].contractName);
                    	}
                    }
          		});
		  	})
		  	
		  	$('#xgcghetong').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNoByName',
                    dataType: 'json',
                    data: {
                    	contractName:$('#xgcghetong').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
	                    	$('#xgprjName2').val(json[i].prjName);
	                    	$('#xgtaskNo2').val(json[i].workNo);
	                    	$("#xgcghetonghao2").val(json[i].cgNo)
                    	}
                    }
          		});
		  	})
		  	$('#xgcghetonghao2').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/cgcontract/getCGNameByNo',
                    dataType: 'json',
                    data: {
                    	cgNo:$('#xgcghetonghao2').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
	                    	$('#xgprjName2').val(json[i].prjName);
	                    	$('#xgtaskNo2').val(json[i].workNo);
	                    	$('#xgcghetong').val(json[i].contractName);
                    	}
                    }
          		});
		  	})
        }
		});
	}
	
    
  //初始化承接合同名称和承接合同号
	 function cjhetongNameSelect(){
			$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/cj/selectNameAndNo',
	        dataType: 'json',
	        data: {
	        },
	        error: function (msg) {
	        	toastr.error("请求失败");
	        },
	        success: function (json) {
	        	$("#cjhetong").html('');
	        	$("#cjhetonghao").html('');
	        	$("#xgcjhetong").html('');
	        	$("#xgcjhetonghao").html('');
	        	for(var i=0;i<json.length;i++){
	        		$("#cjhetong").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
	        		$("#cjhetonghao").append("<option value="+json[i].contractNo+">"+json[i].contractNo+"</option>");
	        		$("#xgcjhetong").append("<option value="+json[i].contractName+">"+json[i].contractName+"</option>");
	        		$("#xgcjhetonghao").append("<option value="+json[i].contractNo+">"+json[i].contractNo+"</option>");
	        	}
	        	$('#cjhetong').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByName',
	                    dataType: 'json',
	                    data: {
	                    	name:$('#cjhetong').val()
	                    },
	                    success: function (json) {
	                    	$('#cjhetonghao').val(json.contractNo);
	                    }
	          		});
	          	})
	          	$('#cjhetonghao').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByNo',
	                    dataType: 'json',
	                    data: {
	                    	no:$('#cjhetonghao').val()
	                    },
	                    success: function (json) {
	                    	$('#cjhetong').val(json.contractName);
	                    }
	          		});
			  	})
			  	
			  	 $('#xgcjhetong').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByName',
	                    dataType: 'json',
	                    data: {
	                    	name:$('#xgcjhetong').val()
	                    },
	                    success: function (json) {
	                    	$('#xgcjhetonghao').val(json.contractNo);
	                    }
	          		});
	          	})
	          	$('#xgcjhetonghao').editableSelect().on('select.editable-select', function (e, dom) {
	          		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/cj/selectCjContractByNo',
	                    dataType: 'json',
	                    data: {
	                    	no:$('#xgcjhetonghao').val()
	                    },
	                    success: function (json) {
	                    	$('#xgcjhetong').val(json.contractName);
	                    }
	          		});
			  	}) 
	        }
			});
		}
    
    
    //添加采购申请保存
    function savecgjiesuan(){
    	var prjName2=$("#prjName2").val();
    	var taskNo2=$("#taskNo2").val();
    	var cghetong=$("#cghetong").val();
    	var cghetonghao=$("#cghetonghao2").val();
    	var cjhetong=$("#cjhetong").val();
    	var cjhetonghao=$("#cjhetonghao").val();
    	var jiesuantype=$("#jiesuantype").val();
    	var year=$("#year").val();
    	var gaishu=$("#gaishu").val();
    	if(prjName2==''){
    		toastr.error("项目名为空");
    		return;
    	}
    	
    	var options={
	        type: 'POST',
	        url: getContextPath()+'/materialPurchaseSettlement/addmaterialPurchaseSettlementSave',
	        dataType: 'json',
	        data: {
	        	taskNo:taskNo2,
	        	prjName:prjName2,
	        	cgContract:cghetong,
	        	cgNo:cghetonghao,
	        	cjContract:cjhetong,
	        	cjNo:cjhetonghao,
	        	auditSettlementType:jiesuantype,
	        	settlementTime:year,
	        	purchaseSettlementDesc:gaishu,
	        },
	        success: function (json) {
	        	//console.log(json)
	        	if(json.result>0){
	        		$("#myModal2").modal('hide')
	        		toastr.success("添加成功")
	        		initTable2();
	        	}else{
	        		toastr.error("添加失败")
	        	}
	        }
	    };
    	$("#cgjs_form").ajaxSubmit(options);
    }
    
  //添加采购申请提交
    function submitcgjiesuan(){
    	var prjName2=$("#prjName2").val();
    	var taskNo2=$("#taskNo2").val();
    	var cghetong=$("#cghetong").val();
    	var cghetonghao=$("#cghetonghao2").val();
    	var cjhetong=$("#cjhetong").val();
    	var cjhetonghao=$("#cjhetonghao").val();
    	var jiesuantype=$("#jiesuantype").val();
    	var year=$("#year").val();
    	var gaishu=$("#gaishu").val();
    	if(prjName2==''){
    		toastr.error("项目名为空");
    		return;
    	}
    	
    	var options={
	        type: 'POST',
	        url: getContextPath()+'/materialPurchaseSettlement/addmaterialPurchaseSettlementSubmit',
	        dataType: 'json',
	        data: {
	        	taskNo:taskNo2,
	        	prjName:prjName2,
	        	cgContract:cghetong,
	        	cgNo:cghetonghao,
	        	cjContract:cjhetong,
	        	cjNo:cjhetonghao,
	        	auditSettlementType:jiesuantype,
	        	settlementTime:year,
	        	purchaseSettlementDesc:gaishu,
	        },
	        success: function (json) {
	        	//console.log(json)
	        	if(json.result>0){
	        		$("#myModal2").modal('hide')
	        		toastr.success("添加成功")
	        		initTable2();
	        	}else{
	        		toastr.error("添加失败")
	        	}
	        }
	    };
    	$("#cgjs_form").ajaxSubmit(options);
    }
    
    
    
    //修改回显
    var xgcgId;
    function checkcgjiesuan(obj){
    	var dom=$(obj).parents('tr');
		var data=$('#mainContent2').DataTable().row(dom).data();
		//console.log(data)
		xgcgId=data.cpId;
		
		$("#xgprjName2").val(data.prjName);
    	$("#xgtaskNo2").val(data.taskNo);
    	$("#xgcghetong").val(data.cgContract);
    	$("#xgcghetonghao2").val(data.cgNo);
    	$("#xgcgjshao").val(data.cgjsNo)
    	$("#xgcjhetong").val(data.cjContract);
    	$("#xgcjhetonghao").val(data.cjNo);
    	$("#xgjiesuantype").val(data.auditSettlementType);
    	$("#xgyear").val(data.settlementTime);
    	$("#xggaishu").val(data.purchaseSettlementDesc);
    }
    
    //修改保存
    function checkSavecgjiesuan(){
    	var xgprjName2=$("#xgprjName2").val();
    	var xgtaskNo2=$("#xgtaskNo2").val();
    	var xgcghetong=$("#xgcghetong").val();
    	var xgcghetonghao=$("#xgcghetonghao2").val();
    	var xgcgjsNo=$("#xgcgjshao").val();
    	var xgcjhetong=$("#xgcjhetong").val();
    	var xgcjhetonghao=$("#xgcjhetonghao").val();
    	var xgjiesuantype=$("#xgjiesuantype").val();
    	var xgyear=$("#xgyear").val();
    	var xggaishu=$("#xggaishu").val();
    	if(xgprjName2==''){
    		toastr.error("项目名为空");
    		return;
    	}
    	
    	var options={
	        type: 'POST',
	        url: getContextPath()+'/materialPurchaseSettlement/updatematerialPurchaseSettlementSave',
	        dataType: 'json',
	        data: {
	        	cpId:xgcgId,
	        	taskNo:xgtaskNo2,
	        	prjName:xgprjName2,
	        	cgContract:xgcghetong,
	        	cgNo:xgcghetonghao,
	        	cgjsNo:xgcgjsNo,
	        	cjContract:xgcjhetong,
	        	cjNo:xgcjhetonghao,
	        	auditSettlementType:xgjiesuantype,
	        	settlementTime:xgyear,
	        	purchaseSettlementDesc:xggaishu,
	        },
	        success: function (json) {
	        	//console.log(json)
	        	if(json.result>0){
	        		$("#change2").modal('hide')
	        		toastr.success("修改成功")
	        		initTable2();
	        	}else{
	        		toastr.error("修改失败")
	        	}
	        }
	    };
	    $("#cgjs_form2").ajaxSubmit(options);
    }
    
  //修改提交
    function checkSubmitcgjiesuan(){
    	var xgprjName2=$("#xgprjName2").val();
    	var xgtaskNo2=$("#xgtaskNo2").val();
    	var xgcghetong=$("#xgcghetong").val();
    	var xgcghetonghao=$("#xgcghetonghao2").val();
    	var xgcgjsNo=$("#xgcgjshao").val();
    	var xgcjhetong=$("#xgcjhetong").val();
    	var xgcjhetonghao=$("#xgcjhetonghao").val();
    	var xgjiesuantype=$("#xgjiesuantype").val();
    	var xgyear=$("#xgyear").val();
    	var xggaishu=$("#xggaishu").val();
    	if(xgprjName2==''){
    		toastr.error("项目名为空");
    		return;
    	}
    	
    	var options={
	        type: 'POST',
	        url: getContextPath()+'/materialPurchaseSettlement/updatematerialPurchaseSettlementSubmit',
	        dataType: 'json',
	        data: {
	        	cpId:xgcgId,
	        	taskNo:xgtaskNo2,
	        	prjName:xgprjName2,
	        	cgContract:xgcghetong,
	        	cgNo:xgcghetonghao,
	        	cgjsNo:xgcgjsNo,
	        	cjContract:xgcjhetong,
	        	cjNo:xgcjhetonghao,
	        	auditSettlementType:xgjiesuantype,
	        	settlementTime:xgyear,
	        	purchaseSettlementDesc:xggaishu,
	        },
	        success: function (json) {
	        	//console.log(json)
	        	if(json.result>0){
	        		$("#change2").modal('hide')
	        		toastr.success("修改成功")
	        		initTable2();
	        	}else{
	        		toastr.error("修改失败")
	        	}
	        }
	    };
    	$("#cgjs_form2").ajaxSubmit(options);
    }
    
    //查看详细信息
    var no;
    function lookcgjiesuan(obj){
    	var dom=$(obj).parents('tr');
		var data=$('#mainContent2').DataTable().row(dom).data();
		//console.log(data)
		no=data.cgjsNo;
		
		$("#lookprjName2").text(data.prjName);
    	$("#looktaskNo2").text(data.taskNo);
    	$("#lookcghetong").text(data.cgContract);
    	$("#lookcghetonghao2").text(data.cgNo);
    	$("#lookcgjshao").text(data.cgjsNo)
    	$("#lookcjhetong").text(data.cjContract);
    	$("#lookcjhetonghao").text(data.cjNo);
    	$("#lookjiesuantype").text(data.auditSettlementType);
    	$("#lookyear").text(data.settlementTime);
    	$("#lookgaishu").text(data.purchaseSettlementDesc);
    	
    	initTableHistory2();
    	
    	$.ajax({
			type:"post",
			url:getContextPath()+"/materialPurchaseSettlement/selectAccessoryById",
			dataType:"json",
			async:false,
			data:{
				id:data.cpId,
			},
			success:function(json){
				//console.log(json);
				$("#look_cgjs_accessory").empty();
	               for(var i=0;i<json.length;i++){
	            	   if(json[i].aType=="法律顾问签字"){
		            	   $("#look_cgjs_accessory").append("<tr>"+
	      	   										"<td style='width:15%;'>法律顾问签字</td>"+
							            	    	"<td><input type='text' class='form-control' style='width:100%;' value='"+json[i].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	               }
			}
		})
    }
  //初始化历史列表
	function initTableHistory2(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/materialPurchaseSettlement/selectHistoryByNo',
            dataType: 'json',
            data: {
            	no:no,
            },
            success: function (json) {
            	//console.log(json)
                $('#lookHistory2').dataTable().fnClearTable();
                $('#lookHistory2').DataTable().rows.add(json).draw(false);
            }
        });
    }
    
  //查看历史详细信息
  function lookHistorycgjiesuan(obj){
	 	var dom=$(obj).parents('tr');
	 	var data=$('#lookHistory2').DataTable().row(dom).data();
		console.log(data)
		$('#History2').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		
		$("#HistoryprjName2").text(data.prjName);
	  	$("#HistorytaskNo2").text(data.taskNo);
	  	$("#Historycghetong").text(data.cgContract);
	  	$("#Historycghetonghao2").text(data.cgNo);
	  	$("#Historycgjshao").text(data.cgjsNo)
	  	$("#Historycjhetong").text(data.cjContract);
	  	$("#Historycjhetonghao").text(data.cjNo);
	  	$("#Historyjiesuantype").text(data.auditSettlementType);
	  	$("#Historyyear").text(data.settlementTime);
	  	$("#Historygaishu").text(data.purchaseSettlementDesc);
	  	
	  	$.ajax({
			type:"post",
			url:getContextPath()+"/materialPurchaseSettlement/selectAccessoryById",
			dataType:"json",
			async:false,
			data:{
				id:data.cpId,
			},
			success:function(json){
				//console.log(json);
				$("#History_cgjs_accessory").empty();
	               for(var i=0;i<json.length;i++){
	            	   if(json[i].aType=="法律顾问签字"){
		            	   $("#History_cgjs_accessory").append("<tr>"+
	      	   										"<td style='width:15%;'>法律顾问签字</td>"+
							            	    	"<td><input type='text' class='form-control' style='width:100%;' value='"+json[i].acName+"' disabled></td>"+
							            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
							            	    "</tr>");
	            	   }
	               }
			}
		})
	  }
  
  
  
  
    
    
<!-- **************************************履约评价******************************************** -->
    
    //初始化履约评价
	function initTable(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/MaterialSubcontract/selectmSubcontractByStatus',
            dataType: 'json',
            data: {
            	status:2,
            },
            success: function (json) {
                $('#mainContent').dataTable().fnClearTable();
                $('#mainContent').DataTable().rows.add(json).draw(false);
            }
        });
    }

	
	 //初始化项目名和任务单号
    function initSelect(){
		$.ajax({
        type: 'POST',
        url: getContextPath()+'/task/selectPrjNameAndWorkNo',
        dataType: 'json',
        data: {
        },
        error: function (msg) {
        	toastr.error("请求失败");
        },
        success: function (json) {
        	$("#prjName").html('');
        	$("#taskNo").html('');
        	$("#xgprjName").html('');
        	$("#xgtaskNo").html('');
        	for(var i=0;i<json.length;i++){
        		$("#prjName").append("<option value="+json[i].prjName+">"+json[i].prjName+"</option>");
        		$("#taskNo").append("<option value="+json[i].prjNo+">"+json[i].prjNo+"</option>");
        		$("#xgprjName").append("<option value="+json[i].prjName+">"+json[i].prjName+"</option>");
        		$("#xgtaskNo").append("<option value="+json[i].prjNo+">"+json[i].prjNo+"</option>");
        	}
        	$('#prjName').editableSelect().on('select.editable-select', function (e, dom) {
        		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/task/selectTaskPrjNo',
                    dataType: 'json',
                    data: {
                    	prjName:$('#prjName').val()
                    },
                    success: function (json) {
                    	//console.log(json)
                    	for(var i=0;i<json.length;i++){
	                    	$('#taskNo').val(json[i].prjNo);
                    	}
                    }
          		});
          	})
          	$('#taskNo').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/task/selectTaskPrjName',
                    dataType: 'json',
                    data: {
                    	prjNo:$('#taskNo').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
	                    	$('#prjName').val(json[i].prjName);
                    	}
                    }
          		});
		  	})
		  	
		  	 $('#xgprjName').editableSelect().on('select.editable-select', function (e, dom) {
        		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/task/selectTaskPrjNo',
                    dataType: 'json',
                    data: {
                    	prjName:$('#xgprjName').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
	                    	$('#xgtaskNo').val(json[i].prjNo);
                    	}
                    }
          		});
          	})
          	$('#xgtaskNo').editableSelect().on('select.editable-select', function (e, dom) {
          		$.ajax({
                    type: 'POST',
                    url: getContextPath()+'/task/selectTaskPrjName',
                    dataType: 'json',
                    data: {
                    	prjNo:$('#xgtaskNo').val()
                    },
                    success: function (json) {
                    	for(var i=0;i<json.length;i++){
	                    	$('#xgprjName').val(json[i].prjName);
                    	}
                    }
          		});
		  	}) 
        }
		});
	}
	
	
	
	//初始化实际负责人部门
	function initbumen(){
		$.ajax({
            type: 'POST',
            url: getContextPath()+'/organizationManagement/getOrgIdAndName',
            dataType: 'json',
            data: {
            },
            success: function (json) {
            	//console.log(json);
            	for(var i=0;i<json.length;i++){
	            	$("#bumen").append("<option value='"+json[i].omId+"'>" + json[i].omName+ "</option>");
	            	$("#xgbumen").append("<option value='"+json[i].omId+"'>" + json[i].omName+ "</option>");
            	}
            	$("#bumen").trigger('change');
	        	$("#xgbumen").trigger('change');
            }
        });
	}
	
	$("#bumen").change(function(){
		var bumen=$("#bumen").val();
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserByomId",
			dataType:"json",
			async:false,
			data:{ 
				omId:bumen 
				},
			success:function(json){
				$("#guanliren").empty();
				for(var i=0;i<json.length;i++){
					$("#guanliren").append("<option value='" + json[i].userId + "'>"
		                    + json[i].uName + "</option>")
				}
			}
		})
	})
	//保存添加用印管理人
	function saveGuanliren(){
		var bumen=$("#bumen").val();
		var guanliren=$("#guanliren").val();
		$('#addGuanliren').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		if(guanliren==''){
			toastr.error("用章管理人为空");
			return;
		}
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserById",
			dataType:"json",
			async:false,
			data:{ 
				userId:guanliren 
				},
			success:function(json){
				//console.log(json)
				$("#shijifuzeren").empty('');
				$("#shijifuzeren").val(json.uName)
			}
		})
	}
	
	
	$("#xgbumen").change(function(){
		var xgbumen=$("#xgbumen").val();
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserByomId",
			dataType:"json",
			 async:false,
			data:{ 
				omId:xgbumen 
				},
			success:function(json){
				$("#xgguanliren").empty();
				for(var i=0;i<json.length;i++){
					$("#xgguanliren").append("<option value='" + json[i].userId + "'>"
		                    + json[i].uName + "</option>")
				}
			}
		})
	})
	//保存修改用印管理人
	function savexgGuanliren(){
		var xgbumen=$("#xgbumen").val();
		var xgguanliren=$("#xgguanliren").val();
		$('#xgaddGuanliren').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		if(xgguanliren==''){
			toastr.error("用章管理人为空");
			return;
		}
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserById",
			dataType:"json",
			async:false,
			data:{ 
				userId:xgguanliren 
				},
			success:function(json){
				//console.log(json)
				$("#xgshijifuzeren").empty('');
				$("#xgshijifuzeren").val(json.uName)
			}
		})
	}
	//回显修改管理人
	function initSelectOnEdit(obj){
		var xgbumen=$("#xgbumen").val();
		$.ajax({
			type:"POST",
			url:getContextPath()+"/user/selectUserByomId",
			dataType:"json",
			 async:false,
			data:{ 
				omId:xgbumen 
				},
			success:function(json){
				$("#xgguanliren").empty();
				for(var i=0;i<json.length;i++){
					$("#xgguanliren").append("<option value='" + json[i].userId + "'>"
		                    + json[i].uName + "</option>")
				}
				$("#xgguanliren").val(obj);
			}
		})
	}
	
	
	
	
	
	//保存履约评价
	function savelypingjia(){
		var prjName=$("#prjName").val();
		var taskNo=$("#taskNo").val();
		var prjfuzeren=$("#prjfuzeren").val();
		var department=$("#department").val();
		var clcgbianhao=$("#clcgbianhao").val();
		var hetongleijiMoney=$("#hetongleijiMoney").val();
		var hetongshijijiesuanMoney=$("#hetongshijijiesuanMoney").val();
		var fukuantype=$("#fukuantype").val();
		var bumen=$("#bumen").val();
		var shijifuzeren=$("#guanliren").val();
		var pj1=$('input:radio[name="pj1"]:checked').val();
		var pj2=$('input:radio[name="pj2"]:checked').val();
		var pj3=$('input:radio[name="pj3"]:checked').val();
		var pj4=$('input:radio[name="pj4"]:checked').val();
		var pj5=$('input:radio[name="pj5"]:checked').val();
		var pj6=$('input:radio[name="pj6"]:checked').val();
		var pj7=$('input:radio[name="pj7"]:checked').val();
		
		if(prjName==''){
    		toastr.error("项目名为空");
    		return;
    	}
		if($("#shijifuzeren").val()==''){
    		toastr.error("实际负责人为空");
    		return;
    	}
		
		$.ajax({
			type: 'POST',
            url: getContextPath()+'/MaterialSubcontract/addmSubcontractSave',
            dataType: 'json',
            data: { 
            	prjName:prjName,
            	taskNo:taskNo,
            	prjPerson:prjfuzeren,
            	department:department,
            	materialContractCode:clcgbianhao,
            	contractAllMoney:hetongleijiMoney,
            	contractEndMoney:hetongshijijiesuanMoney,
            	payMode:fukuantype,
            	omId:bumen,
            	actualChargePerson:shijifuzeren,
            	scoreProductQualityEase:pj1,
            	scoreGiveProductionTime:pj2,
            	scoreMaterialReport:pj3,
            	scoreCustomerUse:pj4,
            	scorePayModeEvaluate:pj5,
            	scoreSafetyCivilizationEnvironment:pj6,
            	allScore:pj7,
            	
            },
            success: function (json) {
            	console.log(json);
            	if(json==0){
					toastr.error("添加失败")
				}else if(json>0){
					//location.reload([true]);
					$("#myModal").modal("hide")
					toastr.success("添加成功")
					initTable();
				} 
            }
		}) 
		
	}
	
	
	//提交履约评价
	function submitlypingjia(){
		var prjName=$("#prjName").val();
		var taskNo=$("#taskNo").val();
		var prjfuzeren=$("#prjfuzeren").val();
		var department=$("#department").val();
		var clcgbianhao=$("#clcgbianhao").val();
		var hetongleijiMoney=$("#hetongleijiMoney").val();
		var hetongshijijiesuanMoney=$("#hetongshijijiesuanMoney").val();
		var fukuantype=$("#fukuantype").val();
		var bumen=$("#bumen").val();
		var shijifuzeren=$("#guanliren").val();
		var pj1=$('input:radio[name="pj1"]:checked').val();
		var pj2=$('input:radio[name="pj2"]:checked').val();
		var pj3=$('input:radio[name="pj3"]:checked').val();
		var pj4=$('input:radio[name="pj4"]:checked').val();
		var pj5=$('input:radio[name="pj5"]:checked').val();
		var pj6=$('input:radio[name="pj6"]:checked').val();
		var pj7=$('input:radio[name="pj7"]:checked').val();
		
		if(prjName==''){
    		toastr.error("项目名为空");
    		return;
    	}
		if($("#shijifuzeren").val()==''){
    		toastr.error("实际负责人为空");
    		return;
    	}
		
		$.ajax({
			type: 'POST',
            url: getContextPath()+'/MaterialSubcontract/addmSubcontractSubmit',
            dataType: 'json',
            data: { 
            	prjName:prjName,
            	taskNo:taskNo,
            	prjPerson:prjfuzeren,
            	department:department,
            	materialContractCode:clcgbianhao,
            	contractAllMoney:hetongleijiMoney,
            	contractEndMoney:hetongshijijiesuanMoney,
            	payMode:fukuantype,
            	omId:bumen,
            	actualChargePerson:shijifuzeren,
            	scoreProductQualityEase:pj1,
            	scoreGiveProductionTime:pj2,
            	scoreMaterialReport:pj3,
            	scoreCustomerUse:pj4,
            	scorePayModeEvaluate:pj5,
            	scoreSafetyCivilizationEnvironment:pj6,
            	allScore:pj7,
            	
            },
            success: function (json) {
            	console.log(json);
            	if(json==0){
					toastr.error("添加失败")
				}else if(json>0){
					//location.reload([true]);
					$("#myModal").modal("hide")
					toastr.success("添加成功")
					initTable();
				} 
            }
		}) 
		
	}
	
	
	
	//修改回显
	var xiugiaId;
	function checkLypingjia(obj){
		$("input:radio").removeAttr("checked");
		var dom=$(obj).parents('tr');
		var data=$('#mainContent').DataTable().row(dom).data();
		console.log(data)
		xiugiaId=data.ceId;
		
		$("#xgprjName").val(data.prjName);
		$("#xgtaskNo").val(data.taskNo);
		$("#xgprjfuzeren").val(data.prjPerson);
		$("#xgdepartment").val(data.department);
		$("#xgclcgbianhao").val(data.materialContractCode);
		$("#xghetongleijiMoney").val(data.contractAllMoney);
		$("#xghetongshijijiesuanMoney").val(data.contractEndMoney);
		$("#xgfukuantype").val(data.payMode);
		$("#xgshijifuzeren").val(data.uName);
		
		var pj1=data.scoreProductQualityEase;
		var td_dom=$("#editTable").find("tbody tr").eq(5).find("td").eq(2).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj1==value){
				$(this).prop("checked","checked");
			}
		}) 
		var pj2=data.scoreGiveProductionTime;
		var td_dom=$("#editTable").find("tbody tr").eq(6).find("td").eq(1).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj2==value){
				$(this).prop("checked","checked");
			}
		})
		var pj3=data.scoreMaterialReport;
		var td_dom=$("#editTable").find("tbody tr").eq(7).find("td").eq(1).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj3==value){
				$(this).prop("checked","checked");
			}
		})
		var pj4=data.scoreCustomerUse;
		var td_dom=$("#editTable").find("tbody tr").eq(8).find("td").eq(1).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj4==value){
				$(this).prop("checked","checked");
			}
		})
		var pj5=data.scorePayModeEvaluate;
		var td_dom=$("#editTable").find("tbody tr").eq(9).find("td").eq(1).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj5==value){
				$(this).prop("checked","checked");
			}
		})
		var pj6=data.scoreSafetyCivilizationEnvironment;
		var td_dom=$("#editTable").find("tbody tr").eq(10).find("td").eq(1).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj6==value){
				$(this).prop("checked","checked");
			}
		})
		var pj7=data.allScore;
		var td_dom=$("#editTable").find("tbody tr").eq(11).find("td").eq(1).find("input");
		$(td_dom).each(function(){
			var value=$(this).val();
			if(pj7==value){
				$(this).prop("checked","checked");
			}
		})
	}
	
	//修改保存
	function checkSave(){
		var xgprjName=$("#xgprjName").val();
		var xgtaskNo=$("#xgtaskNo").val();
		var xgprjfuzeren=$("#xgprjfuzeren").val();
		var xgdepartment=$("#xgdepartment").val();
		var xgclcgbianhao=$("#xgclcgbianhao").val();
		var xghetongleijiMoney=$("#xghetongleijiMoney").val();
		var xghetongshijijiesuanMoney=$("#xghetongshijijiesuanMoney").val();
		var xgfukuantype=$("#xgfukuantype").val();
		var xgbumen=$("#xgbumen").val();
		var xgshijifuzeren=$("#xgguanliren").val();
		var xgpj1=$('input:radio[name="xgpj1"]:checked').val();
		var xgpj2=$('input:radio[name="xgpj2"]:checked').val();
		var xgpj3=$('input:radio[name="xgpj3"]:checked').val();
		var xgpj4=$('input:radio[name="xgpj4"]:checked').val();
		var xgpj5=$('input:radio[name="xgpj5"]:checked').val();
		var xgpj6=$('input:radio[name="xgpj6"]:checked').val();
		var xgpj7=$('input:radio[name="xgpj7"]:checked').val();
		
		if(xgprjName==''){
    		toastr.error("项目名为空");
    		return;
    	}
		if($("#xgshijifuzeren").val()==''){
    		toastr.error("实际负责人为空");
    		return;
    	}
		
		$.ajax({
			type: 'POST',
            url: getContextPath()+'/MaterialSubcontract/updatemSubcontractSave',
            dataType: 'json',
            data: { 
            	ceId:xiugiaId,
            	prjName:xgprjName,
            	taskNo:xgtaskNo,
            	prjPerson:xgprjfuzeren,
            	department:xgdepartment,
            	materialContractCode:xgclcgbianhao,
            	contractAllMoney:xghetongleijiMoney,
            	contractEndMoney:xghetongshijijiesuanMoney,
            	payMode:xgfukuantype,
            	omId:xgbumen,
            	actualChargePerson:xgshijifuzeren,
            	scoreProductQualityEase:xgpj1,
            	scoreGiveProductionTime:xgpj2,
            	scoreMaterialReport:xgpj3,
            	scoreCustomerUse:xgpj4,
            	scorePayModeEvaluate:xgpj5,
            	scoreSafetyCivilizationEnvironment:xgpj6,
            	allScore:xgpj7,
            	
            },
            success: function (json) {
            	//console.log(json);
            	if(json==0){
					toastr.error("修改失败")
				}else if(json>0){
					//location.reload([true]);
					$("#change").modal("hide")
					toastr.success("修改成功")
					initTable();
				} 
            }
		})
	}
	
	
	//修改提交
	function checkSubmit(){
		var xgprjName=$("#xgprjName").val();
		var xgtaskNo=$("#xgtaskNo").val();
		var xgprjfuzeren=$("#xgprjfuzeren").val();
		var xgdepartment=$("#xgdepartment").val();
		var xgclcgbianhao=$("#xgclcgbianhao").val();
		var xghetongleijiMoney=$("#xghetongleijiMoney").val();
		var xghetongshijijiesuanMoney=$("#xghetongshijijiesuanMoney").val();
		var xgfukuantype=$("#xgfukuantype").val();
		var xgbumen=$("#xgbumen").val();
		var xgshijifuzeren=$("#xgguanliren").val();
		var xgpj1=$('input:radio[name="xgpj1"]:checked').val();
		var xgpj2=$('input:radio[name="xgpj2"]:checked').val();
		var xgpj3=$('input:radio[name="xgpj3"]:checked').val();
		var xgpj4=$('input:radio[name="xgpj4"]:checked').val();
		var xgpj5=$('input:radio[name="xgpj5"]:checked').val();
		var xgpj6=$('input:radio[name="xgpj6"]:checked').val();
		var xgpj7=$('input:radio[name="xgpj7"]:checked').val();
		
		if(xgprjName==''){
    		toastr.error("项目名为空");
    		return;
    	}
		if($("#xgshijifuzeren").val()==''){
    		toastr.error("实际负责人为空");
    		return;
    	}
		
		$.ajax({
			type: 'POST',
            url: getContextPath()+'/MaterialSubcontract/updatemSubcontractSubmit',
            dataType: 'json',
            data: { 
            	ceId:xiugiaId,
            	prjName:xgprjName,
            	taskNo:xgtaskNo,
            	prjPerson:xgprjfuzeren,
            	department:xgdepartment,
            	materialContractCode:xgclcgbianhao,
            	contractAllMoney:xghetongleijiMoney,
            	contractEndMoney:xghetongshijijiesuanMoney,
            	payMode:xgfukuantype,
            	omId:xgbumen,
            	actualChargePerson:xgshijifuzeren,
            	scoreProductQualityEase:xgpj1,
            	scoreGiveProductionTime:xgpj2,
            	scoreMaterialReport:xgpj3,
            	scoreCustomerUse:xgpj4,
            	scorePayModeEvaluate:xgpj5,
            	scoreSafetyCivilizationEnvironment:xgpj6,
            	allScore:xgpj7,
            	
            },
            success: function (json) {
            	//console.log(json);
            	if(json==0){
					toastr.error("修改失败")
				}else if(json>0){
					//location.reload([true]);
					$("#change").modal("hide")
					toastr.success("修改成功")
					initTable();
				} 
            }
		})
	}
	
	
	//查看详细信息
	var code;
	function looklypingjia(obj){
		var dom=$(obj).parents('tr');
		var data=$('#mainContent').DataTable().row(dom).data();
		console.log(data)
		code=data.materialContractCode
		
		$("#lookprjName").text(data.prjName);
		$("#looktaskNo").text(data.taskNo);
		$("#lookprjfuzeren").text(data.prjPerson);
		$("#lookdepartment").text(data.department);
		$("#lookclcgbianhao").text(data.materialContractCode);
		$("#lookhetongleijiMoney").text(data.contractAllMoney);
		$("#lookhetongshijijiesuanMoney").text(data.contractEndMoney);
		$("#lookfukuantype").text(data.payMode);
		$("#lookshijifuzeren").text(data.uName);
		
		$("#lookpj1").text(data.scoreProductQualityEase);
		$("#lookpj2").text(data.scoreGiveProductionTime)
		$("#lookpj3").text(data.scoreMaterialReport)
		$("#lookpj4").text(data.scoreCustomerUse)
		$("#lookpj5").text(data.scorePayModeEvaluate)
		$("#lookpj6").text(data.scoreSafetyCivilizationEnvironment)
		$("#lookpj7").text(data.allScore)
		
		initTableHistory();
	}
	
	//初始化历史列表
	function initTableHistory(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/MaterialSubcontract/selectHistoryBypayCode',
            dataType: 'json',
            data: {
            	code:code,
            },
            error: function (msg) {
                errMessage("请求失败");
            },
            success: function (json) {
            	console.log(json)
                $('#lookHistory').dataTable().fnClearTable();
                $('#lookHistory').DataTable().rows.add(json).draw(false);
            }
        });
    }
	
	//查看历史详细信息
	function lookHistorylypingjia(obj){
		var dom=$(obj).parents('tr');
		var data=$('#lookHistory').DataTable().row(dom).data();
		console.log(data)
		$('#History').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        }) 
        
        $("#HistoryprjName").text(data.prjName);
		$("#HistorytaskNo").text(data.taskNo);
		$("#Historyprjfuzeren").text(data.prjPerson);
		$("#Historydepartment").text(data.department);
		$("#Historyclcgbianhao").text(data.materialContractCode);
		$("#HistoryhetongleijiMoney").text(data.contractAllMoney);
		$("#HistoryhetongshijijiesuanMoney").text(data.contractEndMoney);
		$("#Historyfukuantype").text(data.payMode);
		$("#Historyshijifuzeren").text(data.uName);
		
		$("#Historypj1").text(data.scoreProductQualityEase);
		$("#Historypj2").text(data.scoreGiveProductionTime)
		$("#Historypj3").text(data.scoreMaterialReport)
		$("#Historypj4").text(data.scoreCustomerUse)
		$("#Historypj5").text(data.scorePayModeEvaluate)
		$("#Historypj6").text(data.scoreSafetyCivilizationEnvironment)
		$("#Historypj7").text(data.allScore)
        
	}
	
	
	
	
	
	
    function getCreat(bb){
        var EnterpriseRating= $(bb).parent().prev().text();
        var Remarks= $(bb).parent().prev().prev().text();
        var ContactPhone1= $(bb).parent().prev().prev().prev().text();
        var Contacts= $(bb).parent().prev().prev().prev().prev().text();
        var address= $(bb).parent().prev().prev().prev().prev().prev().text();
        var ProprietorUnit= $(bb).parent().prev().prev().prev().prev().prev().prev().text();
        var Code= $(bb).parent().prev().prev().prev().prev().prev().prev().prev().text();
        $("#CEnterprise-rating").val(EnterpriseRating);
        $("#CRemarks").val(Remarks);
        $("#CContact-phone1").val(ContactPhone1);
        $("#CContacts").val(Contacts);
        $("#Caddress").val(address);
        $("#CProprietor-unit").val(ProprietorUnit);
        $("#CCode").val(Code);
        rowIndex = bb.parentNode.parentNode.rowIndex; 
    }

    // $("#mainContent tbody tr").click(function (){
    //     $(this).addClass('selected')
    //     .siblings().removeClass('selected')
    //     .end();
    // })

    $(".quxiao").click(function(){
        if(confirm("确定要撤销吗？")){
            return true;
        }
        else{
            return false;
        }
    })

</script>
</html>