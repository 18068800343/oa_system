<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../../font2/iconfont.css">
	<link href="../../style/bootstrap.min.css" rel="stylesheet">
    <link href="../../style/style.css" rel="stylesheet">
    <link href="../../toastr/toastr.css" rel="stylesheet">
    <link rel="stylesheet" href="../../style/jquery.dataTables.min.css">
    <link rel="stylesheet" href="../../style/jquery-editable-select.css">
    <style lang="">
        *{
            font-size: 16px;
        }
        .UpperPart{
            display: flex;
            justify-content:space-between;
            border-bottom: 1px solid #ccc;
            padding-bottom: 12px;
        }
        .selected{
            background: rgba(247, 161, 3,0.2);
        }
        #addJYWD select{
            width:180px;
        }
    </style>
</head>
<body>
    
    <!-- 面包屑 -->
    <div class="mianbao">
    	<ul class="breadcrumb">
    		<li><i class="iconfont icon-knowledgebase"></i></li>
            <li>档案管理</li>
			<li class="active">经营文档资料</li>
		</ul>
    </div>

    <div class="zhuti-content">
        <div class="UpperPart">
            <div class="UpperPartL">
                
            </div>
            <div class="UpperPartR">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">新建</button>
            </div>
<!-- Modal -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="myModal">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>新建</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline" method="post" enctype="multipart/form-data">
                        <table class="table table-bordered" id="addJYWD">
                            <tr>
                                <td style="width:12%">项目名称</td>
                                <td style="width:35%">
                                    <select style="width:70%" class="form-control" id="prjName">
                                    </select>
                                </td>
                                <td style="width:12%">任务单号</td>
                                <td style="width:35%">
                                    <select style="width:70%" class="form-control" id="prjNo">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                            	<td>项目地区</td>
                                <td>
                                    <div class="docs-methods">
                                        <form class="form-inline">
                                            <div id="distpicker">
                                                <div class="form-group">
                                                    <div style="position: relative;">
                                                        <input id="prjArea" style="width:70%" class="form-control" readonly type="text" value="" data-toggle="city-picker">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </td>
                            	<td>项目类型</td>
                                <td>
                                	<input type="text" style="width:70%" id="prjType" class="form-control" disabled>
                                </td>
                            </tr>
                            <tr>
                                <td>填报人</td>
                                <td><input type="text" style="width:70%" id="fill_in_one" class="form-control"></td>
                                <td>关键词</td>
                                <td><input type="text" style="width:70%" id="key_word" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>招标代理</td>
                                <td><input type="text" style="width:70%" id="bidding_agent" class="form-control"></td>
                                <td>项目投标时间</td>
                                <td><input type="text" style="width:70%" id="year1" class="form-control" id="year1"></td>
                            </tr>
                            <tr>
                            	<td>是否中标</td>
                                <td>
                                    <select style="width:70%" class="form-control" id="isBidding">
                                        <option>是</option>
                                        <option>否</option>
                                    </select>
                                </td>
                                <td>参与开标单位数量</td>
                                <td><input type="text" style="width:70%" id="number" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>本公司报价</td>
                                <td><input type="text" style="width:70%" id="offer" class="form-control"></td>
                                <td>中标项目经理</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="prj_manager">
                                        <option>高经理</option>
                                        <option>李经理</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>项目总工</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="prj_general">
                                        <option >赵工</option>
                                        <option >钱工</option>
                                    </select>
                                </td>
                                <td>项目工起期</td>
                                <td><input type="text" style="width:70%" class="form-control" id="year2"></td>
                            </tr>
                            <tr>
                                <td>项目工止期</td>
                                <td><input type="text" style="width:70%" class="form-control" id="year3"></td>
                                <td>中标价</td>
                                <td><input type="text" style="width:70%" id="bidding_price" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>中标单位</td>
                                <td><input type="text" style="width:70%" id="bidding_unit" class="form-control"></td>
                                <td>投标限价</td>
                                <td><input type="text" style="width:70%" id="bid_price_limit" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>项目预算价</td>
                                <td><input type="text" style="width:70%" id="prj_budget_price" class="form-control"></td>
                                <td>评标办法</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="bid_evaluation_method">
                                        <option>合理低价法</option>
                                        <option>技术评分最低价法</option>
                                        <option>综合评分法</option>
                                        <option>经评审的最低价法</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory1">
                        	<thead>
                        		<tr>
                                	<td style="width:30%;">招标文件 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile1()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory2">
                        	<thead>
                        		<tr>
                                	<td style="width:30%;">技术文件 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile2()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory3">
                        	<thead>
                        		<tr>
                                	<td style="width:30%;">商务文件 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile3()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory4">
                        	<thead>
                        		<tr>
                                	<td style="width:30%;">中标通知书 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile4()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory5">
                        	<thead>
                        		<tr>
                                	<td style="width:30%;">验收证书 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile5()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="new_accessory6">
                        	<thead>
                        		<tr>
                                	<td style="width:30%;">开标记录 <i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="addFile6()">添加附件</button></td>
                            	</tr>
                        	</thead>
                        	<tbody></tbody>
                        </table>

                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th colspan="3">添加招标人</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>招标人</td>
                                    <td>
                                        <select class="form-control" id="tender" style="width:180px;">
                                        </select>
                                    </td>
                                    <td><button type="button" class="btn btn-primary" onclick="addTender(0)">添加</button></td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table table-bordered" id="new_Tender">
                            <thead>
                                <tr>
                                    <th colspan="3">添加的招标人</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-default" onclick="save()">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- model结束 -->

<!-- 修改Modal -->
<div class="modal fade bs-example-modal-lg" id="change" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>修改</b></h4>
        </div>
        <div class="modal-body">
                <div>     
                    <form class="form-inline" method="post" enctype="multipart/form-data">
                        <table class="table table-bordered" id="addJYWD">
                            <tr>
                                <td style="width:12%">项目名称</td>
                                <td style="width:35%">
                                    <select class="form-control" style="width:70%" id="edit_prjName">
                                    </select>
                                </td>
                                <td style="width:12%">任务单号</td>
                                <td style="width:35%">
                                    <select class="form-control" style="width:70%" id="edit_prjNo">
                                    </select>
                                </td>
                            </tr>
                            <tr>
                            	<td>项目地区</td>
                                <td>
                                	<input type="text" style="width:70%" id="edit_prjArea" class="form-control">
                                	<button type="button" class="btn btn-default" data-toggle="modal" data-target="#chooseCity">选择城市</button>
                                </td>
                            	<td>项目类型</td>
                                <td>
                                	<input type="text" style="width:70%" id="edit_prjType" class="form-control" disabled>
                                </td>
                            </tr>
                            <tr>
                                <td>填报人</td>
                                <td><input type="text" style="width:70%" id="edit_fill_in_one" class="form-control"></td>
                                <td>关键词</td>
                                <td><input type="text" style="width:70%" id="edit_key_word" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>招标代理</td>
                                <td><input type="text" style="width:70%" id="edit_bidding_agent" class="form-control"></td>
                                <td>项目投标时间</td>
                                <td><input type="text" style="width:70%" class="form-control" id="edit_year1"></td>
                            </tr>
                            <tr>
                            	<td>是否中标</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="edit_isBidding">
                                        <option>是</option>
                                        <option>否</option>
                                    </select>
                                </td>
                                <td>参与开标单位数量</td>
                                <td><input type="text" style="width:70%" id="edit_number" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>本公司报价</td>
                                <td><input type="text" style="width:70%" id="edit_offer" class="form-control"></td>
                                <td>中标项目经理</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="edit_prj_manager">
                                        <option>高经理</option>
                                        <option>李经理</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>项目总工</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="edit_prj_general">
                                        <option >赵工</option>
                                        <option >钱工</option>
                                    </select>
                                </td>
                                <td>项目工起期</td>
                                <td><input type="text" style="width:70%" class="form-control" id="edit_year2"></td>
                            </tr>
                            <tr>
                                <td>项目工止期</td>
                                <td><input type="text" style="width:70%" class="form-control" id="edit_year3"></td>
                                <td>中标价</td>
                                <td><input type="text" style="width:70%" id="edit_bidding_price" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>中标单位</td>
                                <td><input type="text" style="width:70%" id="edit_bidding_unit" class="form-control"></td>
                                <td>投标限价</td>
                                <td><input type="text" style="width:70%" id="edit_bid_price_limit" class="form-control"></td>
                            </tr>
                            <tr>
                                <td>项目预算价</td>
                                <td><input type="text" style="width:70%" id="edit_prj_budget_price" class="form-control"></td>
                                <td>评标办法</td>
                                <td>
                                    <select class="form-control" style="width:70%" id="edit_bid_evaluation_method">
                                        <option>合理低价法</option>
                                        <option>技术评分最低价法</option>
                                        <option>综合评分法</option>
                                        <option>经评审的最低价法</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory1">
                        	<thead>
                        		<!-- <tr>
                                	<td style="width:15%;">招标文件<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="edit_addFile1()">添加附件</button></td>
                            	</tr> -->
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory2">
                        	<thead>
                        		<!-- <tr>
                                	<td style="width:15%;">技术文件<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="edit_addFile2()">添加附件</button></td>
                            	</tr> -->
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory3">
                        	<thead>
                        		<!-- <tr>
                                	<td style="width:15%;">商务文件<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="edit_addFile3()">添加附件</button></td>
                            	</tr> -->
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory4">
                        	<thead>
                        		<!-- <tr>
                                	<td style="width:15%;">中标通知书<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="edit_addFile4()">添加附件</button></td>
                            	</tr> -->
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory5">
                        	<thead>
                        		<!-- <tr>
                                	<td style="width:15%;">验收证书<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="edit_addFile5()">添加附件</button></td>
                            	</tr> -->
                        	</thead>
                        	<tbody></tbody>
                        </table>
                        <table class="table table-bordered table-condensed" id="edit_accessory6">
                        	<thead>
                        		<!-- <tr>
                                	<td style="width:15%;">开标记录<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"><button type="button" class="btn btn-primary weui-uploader__input" onclick="edit_addFile6()">添加附件</button></td>
                            	</tr> -->
                        	</thead>
                        	<tbody></tbody>
                        </table>

                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th colspan="3">添加招标人</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>招标人</td>
                                    <td>
                                        <select class="form-control" id="edit_tender" style="width:180px;">
                                        </select>
                                    </td>
                                    <td><button type="button" class="btn btn-primary" onclick="addTender(1)">添加</button></td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table table-bordered" id="edit_table_Tender">
                            <thead>
                                <tr>
                                    <th colspan="3">添加的招标人</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </form>  
                </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-success" onclick="checkSave()">保存</button>
        </div>
        </div>
    </div>
</div>
<!-- 修改model结束 -->
<!--修改选择城市 modal -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="chooseCity">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">选择城市</h4>
            </div>
            <div class="modal-body">
                    <div class="docs-methods">
                         <form class="form-inline">
                             <div id="distpicker">
                                 <div class="form-group">
                                     <div style="position: relative;">
                                         <input id="edit_city_picker3" class="form-control" readonly type="text" value="" data-toggle="city-picker">
                                     </div>
                                 </div>
                             </div>
                         </form>
                     </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" onclick="savechooseCity()" data-dismiss="modal">确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 修改选择城市结束 -->

<!-- allMsg -->
<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" id="allMsg">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel"><b>所有信息</b></h4>
        </div>
        <div class="modal-body">
            <div>     
                <form class="form-inline">
                    <table class="table table-bordered" id="addJYWD">
                        <tr>
                            <td>项目名称</td>
                            <td id="lookprjName"></td>
                            <td>任务单号</td>
                            <td id="lookprjNo"></td>
                        </tr>
                        <tr>
                            <td>项目地区</td>
                            <td id="lookprjArea"></td>
                            <td>项目类型</td>
                            <td id="lookprjType"></td>
                        </tr>
                        <tr>
                            <td>填报人</td>
                            <td id="lookfill_in_one"></td>
                            <td>关键词</td>
                            <td id="lookkey_word"></td>
                        </tr>
                        <tr>
                            <td>招标代理</td>
                            <td id="lookbidding_agent"></td>
                            <td>项目投标时间</td>
                            <td id="lookyear1"></td>
                        </tr>
                        <tr>
                            <td>是否中标</td>
                            <td id="lookisBidding"></td>
                            <td>参与开标单位数量</td>
                            <td id="looknumber"></td>
                        </tr>
                        <tr>
                            <td>本公司报价</td>
                            <td id="lookoffer"></td>
                            <td>中标项目经理</td>
                            <td id="lookprj_manager"></td>
                        </tr>
                        <tr>
                            <td>项目总工</td>
                            <td id="lookprj_general"></td>
                            <td>项目工起期</td>
                            <td id="lookyear2"></td>
                        </tr>
                        <tr>
                            <td>项目工止期</td>
                            <td id="lookyear3"></td>
                            <td>中标价</td>
                            <td id="lookbidding_price"></td>
                        </tr>
                        <tr>
                            <td>中标单位</td>
                            <td id="lookbidding_unit"></td>
                            <td>投标限价</td>
                            <td id="lookbid_price_limit"></td>
                        </tr>
                        <tr>
                            <td>项目预算价</td>
                            <td id="lookprj_budget_price"></td>
                            <td>评标办法</td>
                            <td id="lookbid_evaluation_method"></td>
                        </tr>
                        <!-- <tr>
                            <td>招标文件</td>
                            <td colspan="3">szfdhb3w5b5</td>
                        </tr>
                        <tr>
                            <td>技术文件</td>
                            <td colspan="3">shfj35n</td>
                        </tr>
                        <tr>
                            <td>商务文件</td>
                            <td colspan="3">dfjne4</td>
                        </tr>
                        <tr>
                            <td>中标通知书</td>
                            <td colspan="3">shdb4w24s</td>
                        </tr>
                        <tr>
                            <td>验收证书</td>
                            <td colspan="3">shdjnw43w</td>
                        </tr><tr>
                            <td>开标记录</td>
                            <td colspan="3">sjfwrs</td>
                        </tr> -->
                    </table>
					
					<table class="table table-bordered table-condensed"  id="look_accessory1">
						<thead>
                        		<tr>
                                	<td style="width:15%;">招标文件<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"></td>
                            	</tr>
                        </thead>
                        <tbody></tbody>
					</table>
					<table class="table table-bordered table-condensed"  id="look_accessory2">
						<thead>
                        		<tr>
                                	<td style="width:15%;">技术文件<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"></td>
                            	</tr>
                        </thead>
                        <tbody></tbody>
					</table>
					<table class="table table-bordered table-condensed"  id="look_accessory3">
						<thead>
                        		<tr>
                                	<td style="width:15%;">商务文件<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"></td>
                            	</tr>
                        </thead>
                        <tbody></tbody>
					</table>
					<table class="table table-bordered table-condensed"  id="look_accessory4">
						<thead>
                        		<tr>
                                	<td style="width:15%;">中标通知书<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"></td>
                            	</tr>
                        </thead>
                        <tbody></tbody>
					</table>
					<table class="table table-bordered table-condensed"  id="look_accessory5">
						<thead>
                        		<tr>
                                	<td style="width:15%;">验收证书<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"></td>
                            	</tr>
                        </thead>
                        <tbody></tbody>
					</table>
					<table class="table table-bordered table-condensed"  id="look_accessory6">
						<thead>
                        		<tr>
                                	<td style="width:15%;">开标记录<i class="iconfont icon-xingxing-copy" style="color:red;"></i></td>
                                	<td colspan="3"></td>
                            	</tr>
                        </thead>
                        <tbody></tbody>
					</table>
					
                    <table class="table table-bordered" id="look_tender">
                        <thead>
                            <tr>
                                <th colspan="3">添加的招标人</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </form> 
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
        </div>
    </div>
</div>
<!-- allMsg结束 -->
        
        </div>
        <div class="LowerPart">
            <table class="table table-bordered table-condensed" id="mainContent">
                <thead>
                    <tr>
                        <th>项目名称</th>
                        <th>填报人</th>
                        <th>项目地区</th>
                        <th>项目类型</th>
                        <th>项目投标时间</th>
                        <th>参与开标单位数量</th>
                        <th>本公司报价</th>
                        <th>是否中标</th>
                        <th style="width:100px;">操作</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>   
            </table>
        </div>

        
    </div>
</body>
<script src="../../js/jquery.js"></script>
<script src="../../js/common-scripts.js"></script>
<script src="../../js/city-picker.data.js"></script>
<script src="../../js/city-picker.js"></script>
<script src="../../js/mainsanji.js"></script>
<script src="../../js/jquery.dataTables.min.js"></script>
<script src="../../js/bootstrap.min.js"></script>
<script src="../../js/laydate/laydate.js"></script>
<script src="../../js/jquery-editable-select.js"></script>
<script src="../../toastr/toastr.js"></script>
<script>
    $(document).ready( function () {
    	initTable();
    	initSelectPrj();
    	initUser();
    	laydate.render({
            elem: '#year1' //指定元素
        });
        laydate.render({
            elem: '#year2' //指定元素
        });
        laydate.render({
            elem: '#year3' //指定元素
        });
        laydate.render({
            elem: '#edit_year1' //指定元素
        });
        laydate.render({
            elem: '#edit_year2' //指定元素
        });
        laydate.render({
            elem: '#edit_year3' //指定元素
        });
        $('#editable-select').editableSelect({ 
            effects: 'slide' 
        });
	});
    var table=$('#mainContent').dataTable({
        "deferRender": true,
        "processing": true,
        "bDestroy": true,
        "iDisplayLength": 10,
        "searching": true,
        "lengthChange": false,
        "oLanguage": {
		    "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
		},
		"columns": [
            { "data": "prjName"}, 
            { "data": "fillInOne"}, 
            { "data": "prjArea"}, 
            { "data": "prjType"}, 
            { "data": "prjBidTime"}, 
            { "data": "numberParticipatingUnits"}, 
            { "data": "offer"}, 
            { "data": "isBidding"}, 
        ],
        "columnDefs": [
						{	
								 "class": "tcenter",
								    "targets": 8,
								    "searchable": true,
								    "render": function(data, type, full) {
								  	  		return '<i class="iconfont icon-shanchu" style="font-size:18px;cursor:pointer;"  title="删除" onclick="deleteMd(this)"  id="delyiji"></i>  <i class="iconfont icon-icon-test" style="font-size:20px;cursor:pointer;" title="查看详细信息" onclick="lookMd(this)" data-toggle="modal" data-target="#allMsg" id="lookDetall"></i>  <i class="iconfont icon-xiugai iconxiugai" style="font-size:18px;cursor:pointer;" title="修改" onclick="checkMd(this)" data-toggle="modal" data-target="#change" ></i>'
								        }
								  }
						],
        "order": [[0, 'asc']],
        "oLanguage": { //国际化配置
        "sProcessing": "正在获取数据，请稍后...",
        "sLengthMenu": "显示 _MENU_ 条",
        "sZeroRecords": "查询不到相关数据",
        "sInfo": "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",
        "sInfoEmpty": "记录数为0",
        "sInfoFiltered": "(全部记录数 _MAX_ 条)",
        "sInfoPostFix": "",
        "sSearch": "搜索",
        "sUrl": "",
        "oPaginate": {
            "sFirst": "第一页",
            "sPrevious": "上一页",
            "sNext": "下一页",
            "sLast": "最后一页"
        }},
        
	});
	function initTable(){
        $.ajax({
            type: 'POST',
            url: getContextPath()+'/ManagingDocuments/selectManagingDocuments',
            dataType: 'json',
            data: {
            },
            success: function (json) {
                $('#mainContent').dataTable().fnClearTable();
                $('#mainContent').DataTable().rows.add(json).draw(false);
            }
        });
    }
	
	//判断是否中标，中标的话本公司报价、中标价、中标单位就不准输入
	/* $("#isBidding").change(function(){
		var hideselect = $(this).val();
		if(hideselect == "否"){
			//$("#offer").show().addClass("show");
			$('#offer').attr("disabled",false)
			$('#bidding_price').attr("disabled",false)
			$('#bidding_unit').attr("disabled",false)
		}else{
			//$("#offer").hide().removeClass("show");
		    $('#offer').attr("disabled",true)
			$('#bidding_price').attr("disabled",true)
			$('#bidding_unit').attr("disabled",true)
		}
	}) */

	
	//初始化项目名称和任务单号
    function initSelectPrj(){
		$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/task/selectPrjNameAndWorkNo',
	        dataType: 'json',
	        data: {
	        },
	        error: function (msg) {
	        	toastr.error("请求失败");
	        },
	        success: function (json) {
	        	$("#prjName").html('');
	        	$("#prjNo").html('');
	        	$("#edit_prjName").html('');
	        	$("#edit_prjNo").html('');
	        	for(var i=0;i<json.length;i++){
	        		$("#prjName").append("<option value="+json[i].prjName+">"+json[i].prjName+"</option>");
	        		$("#prjNo").append("<option value="+json[i].prjNo+">"+json[i].prjNo+"</option>");
	        		$("#edit_prjName").append("<option value="+json[i].prjName+">"+json[i].prjName+"</option>");
	        		$("#edit_prjNo").append("<option value="+json[i].prjNo+">"+json[i].prjNo+"</option>");
	        	}
	        	 $('#prjNo').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/task/selectTaskPrjName',
	                    dataType: 'json',
	                    data: {
	                    	prjNo:$('#prjNo').val()
	                    },
	                    success: function (json) {
	                    	console.log(json)
	                    	for(var i=0;i<json.length;i++){
	                    		$("#prjName").val(json[i].prjName)
	                    		$("#prjType").val(json[i].prjType2)
	                    	}
	                    }
	          		});
	          	})
	          	$('#prjName').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/task/selectTaskPrjNo',
	                    dataType: 'json',
	                    data: {
	                    	prjName:$('#prjName').val()
	                    },
	                    success: function (json) {
	                    	for(var i=0;i<json.length;i++){
	                    		$("#prjNo").val(json[i].prjNo)
	                    		$("#prjType").val(json[i].prjType2)
	                    	}
	                    }
	          		});
	          	}) 
	          	 $('#edit_prjNo').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/task/selectTaskPrjName',
	                    dataType: 'json',
	                    data: {
	                    	prjNo:$('#edit_prjNo').val()
	                    },
	                    success: function (json) {
	                    	for(var i=0;i<json.length;i++){
	                    		$("#edit_prjName").val(json[i].prjName)
	                    		$("#edit_prjType").val(json[i].prjType2)
	                    	}
	                    }
	          		});
	          	})
	          	$('#edit_prjName').editableSelect().on('select.editable-select', function (e, dom) {
	        		$.ajax({
	                    type: 'POST',
	                    url: getContextPath()+'/task/selectTaskPrjNo',
	                    dataType: 'json',
	                    data: {
	                    	prjName:$('#edit_prjName').val()
	                    },
	                    success: function (json) {
	                    	for(var i=0;i<json.length;i++){
	                    		$("#edit_prjNo").val(json[i].prjNo)
	                    		$("#edit_prjType").val(json[i].prjType2)
	                    	}
	                    }
	          		});
	          	}) 
	          	 
	        }
		});
	}
	
	
	
	//初始化招标人
    function initUser(){
    	$.ajax({
            type: 'POST',
            url: getContextPath()+'/user/selectAllUser',
            dataType: 'json',
            data: {
            },
            success: function (json) {
            	for(var i=0;i<json.length;i++){
	            	$("#tender").append("<option value="+json[i].uName+">"+json[i].uName+"</option>")
	            	$("#edit_tender").append("<option value="+json[i].uName+">"+json[i].uName+"</option>")
            	}
            }
    	});
    }
	
	//修改保存城市
	function savechooseCity(){
		$('#chooseCity').on('hidden.bs.modal', function () {//解决模态框页面滚动问题
            if ($('.modal.in').size() >= 1) {
                $('body').addClass('modal-open')
            }
        })
		$("#edit_prjArea").val("")
		var city=$("#edit_city_picker3").val();
		$("#edit_prjArea").val(city)
	}
	
	
	//保存
	function save(){
		var tender=new Array();
		$("#new_Tender tbody").find("tr").each(function(){
			var name=$(this).find("td").eq(0).text();
			var arr={
					tId:null,
					tName:undefined
			}
			arr.tId=null;
			arr.tName=name;
			tender.push(arr)
		});
		if(tender.length>0){
			var prjName=$("#prjName").val();
			var prjNo=$("#prjNo").val();
			var prjArea=$("#prjArea").val();
			var prjType=$("#prjType").val();
			var fill_in_one=$("#fill_in_one").val();
			var key_word=$("#key_word").val();
			var bidding_agent=$("#bidding_agent").val();
			var year1=$("#year1").val();
			var isBidding=$("#isBidding").val();
			var number=$("#number").val();
			var offer=$("#offer").val();
			var prj_manager=$("#prj_manager").val();
			var prj_general=$("#prj_general").val();
			var year2=$("#year2").val();
			var year3=$("#year3").val();
			var bidding_price=$("#bidding_price").val();
			var bidding_unit=$("#bidding_unit").val();
			var bid_price_limit=$("#bid_price_limit").val();
			var prj_budget_price=$("#prj_budget_price").val();
			var bid_evaluation_method=$("#bid_evaluation_method").val();
			if(prjName==''){
				toastr.error("项目名不能为空")
				return;
			}
			var ManagingDocuments={
					mdId:null,
					prjName:undefined,
					prjNo:undefined,
					prjArea:undefined,
					prjType:undefined,
					fillInOne:undefined,
					keyWord:undefined,
					biddingAgent:undefined,
					prjBidTime:undefined,
					isBidding:undefined,
					numberParticipatingUnits:undefined,
					offer:0,
					biddingPrjManager:undefined,
					prjGeneral:undefined,
					prjStartTime:undefined,
					prjEndTime:undefined,
					biddingPrice:0,
					biddingUnit:undefined,
					bidPriceLimit:0,
					prjBudgetPrice:0,
					bidEvaluationMethod:undefined,
					managingDocumentsTenderer:undefined
			}
			ManagingDocuments.mdId=null;
			ManagingDocuments.prjName=prjName;
			ManagingDocuments.prjNo=prjNo;
			ManagingDocuments.prjArea=prjArea;
			ManagingDocuments.prjType=prjType;
			ManagingDocuments.fillInOne=fill_in_one;
			ManagingDocuments.keyWord=key_word;
			ManagingDocuments.biddingAgent=bidding_agent;
			ManagingDocuments.prjBidTime=year1;
			ManagingDocuments.isBidding=isBidding;
			ManagingDocuments.numberParticipatingUnits=number
			ManagingDocuments.offer=offer;
			ManagingDocuments.biddingPrjManager=prj_manager;
			ManagingDocuments.prjGeneral=prj_general;
			ManagingDocuments.prjStartTime=year2;
			ManagingDocuments.prjEndTime=year3
			ManagingDocuments.biddingPrice=bidding_price
			ManagingDocuments.biddingUnit=bidding_unit
			ManagingDocuments.bidPriceLimit=bid_price_limit
			ManagingDocuments.prjBudgetPrice=prj_budget_price;
			ManagingDocuments.bidEvaluationMethod=bid_evaluation_method;
			ManagingDocuments.managingDocumentsTenderer=tender;
			console.log(ManagingDocuments)
			
			var formData = new FormData();
	  		formData.append("managingDocuments", JSON.stringify(ManagingDocuments));
	  		
	  		$("#new_accessory1 tbody").find("tr").each(function(){
	  			formData.append("file1", $(this).find("input")[0].files[0]);
	  		})
	  		$("#new_accessory2 tbody").find("tr").each(function(){
	  			formData.append("file2", $(this).find("input")[0].files[0]);
	  		})
	  		$("#new_accessory3 tbody").find("tr").each(function(){
	  			formData.append("file3", $(this).find("input")[0].files[0]);
	  		})
	  		$("#new_accessory4 tbody").find("tr").each(function(){
	  			formData.append("file4", $(this).find("input")[0].files[0]);
	  		})
	  		$("#new_accessory5 tbody").find("tr").each(function(){
	  			formData.append("file5", $(this).find("input")[0].files[0]);
	  		})
	  		$("#new_accessory6 tbody").find("tr").each(function(){
	  			formData.append("file6", $(this).find("input")[0].files[0]);
	  		})
			$.ajax({
	  			type: 'POST',
	            url: getContextPath()+'/ManagingDocuments/addManagingDocumentsSave',
	            data: formData,  
	            cache: false,
	            processData: false,
	            contentType: false,
	            async: false,
	            success: function (json) {
	            	if(json.result>0){
	            		$("#myModal").modal("hide");
	            		toastr.success("保存成功")
	            		$('#mainContent').DataTable().row.add(json.ManagingDocuments).draw(false);     //新增行立即显示
	            	}else{
	            		toastr.error("保存失败")
	            	}
	            }
	  		}) 
			
		}else{
			toastr.error("请至少添加一名招标人");
			return;
		}
	} 
	
	
	//删除
	function deleteMd(obj){
		var dom=$(obj).parents("tr");
		var data=$("#mainContent").DataTable().row(dom).data();
		if(!confirm("确认删除吗?")){
		   return false;
		}
		$.ajax({
			type:"POST",
			url:getContextPath()+"/ManagingDocuments/deleteManagingDocumentsById",
			dataType:"json",
			data:{ 
				id:data.mdId
				},
			success:function(json){
				if(json>0){
					toastr.success("删除成功")
					$('#mainContent').DataTable().row(dom).remove().draw(false); //删除行立即显示
				}else{
					toastr.error("删除失败")
				}
			}
		})
	}
	
	
	//查看详细信息
	function lookMd(obj){
		var dom=$(obj).parents("tr");
		var data=$("#mainContent").DataTable().row(dom).data();
		
		$("#lookprjName").text(data.prjName);
		$("#lookprjNo").text(data.prjNo);
		$("#lookprjArea").text(data.prjArea);
		$("#lookprjType").text(data.prjType);
		$("#lookfill_in_one").text(data.fillInOne);
		$("#lookkey_word").text(data.keyWord);
		$("#lookbidding_agent").text(data.biddingAgent);
		$("#lookyear1").text(data.prjBidTime);
		$("#lookisBidding").text(data.isBidding);
		$("#looknumber").text(data.numberParticipatingUnits);
		$("#lookoffer").text(data.offer);
		$("#lookprj_manager").text(data.biddingPrjManager);
		$("#lookprj_general").text(data.prjGeneral);
		$("#lookyear2").text(data.prjStartTime);
		$("#lookyear3").text(data.prjEndTime);
		$("#lookbidding_price").text(data.biddingPrice);
		$("#lookbidding_unit").text(data.biddingUnit);
		$("#lookbid_price_limit").text(data.bidPriceLimit);
		$("#lookprj_budget_price").text(data.prjBudgetPrice);
		$("#lookbid_evaluation_method").text(data.bidEvaluationMethod);
		var tender=data.managingDocumentsTenderer;
		$("#look_tender tbody").empty();
		for(var i=0;i<tender.length;i++){
			$("#look_tender tbody").append("<tr>"
					+"<td style='width:25%;'>"+tender[i].tName+"</td>"
			+"</tr>")
		}
		
		$.ajax({
			type:"POST",
			url:getContextPath()+"/ManagingDocuments/selectAccessoryById",
			dataType:"json",
			data:{ 
				id:data.mdId
				},
			success:function(json){
				$("#look_accessory1 tbody").empty();
				$("#look_accessory2 tbody").empty();
				$("#look_accessory3 tbody").empty();
				$("#look_accessory4 tbody").empty();
				$("#look_accessory5 tbody").empty();
				$("#look_accessory6 tbody").empty();
	            for(var i=0;i<json.length;i++){
	            	if(json[i].aType=="招标文件"){
	            	   $("#look_accessory1 tbody").append("<tr>"+
			     	   									"<td style='width:15%;'>附件</td>"+
								            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+json[i].acName+"' disabled></td>"+
								            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
								            	    "</tr>");
	            	}
	            	if(json[i].aType=="技术文件"){
		            	   $("#look_accessory2 tbody").append("<tr>"+
				     	   									"<td style='width:15%;'>附件</td>"+
									            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+json[i].acName+"' disabled></td>"+
									            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
									            	    "</tr>");
		            }
	            	if(json[i].aType=="商务文件"){
		            	   $("#look_accessory3 tbody").append("<tr>"+
				     	   									"<td style='width:15%;'>附件</td>"+
									            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+json[i].acName+"' disabled></td>"+
									            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
									            	    "</tr>");
		            }
	            	if(json[i].aType=="中标通知书"){
		            	   $("#look_accessory4 tbody").append("<tr>"+
				     	   									"<td style='width:15%;'>附件</td>"+
									            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+json[i].acName+"' disabled></td>"+
									            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
									            	    "</tr>");
		            }
	            	if(json[i].aType=="验收证书"){
		            	   $("#look_accessory5 tbody").append("<tr>"+
				     	   									"<td style='width:15%;'>附件</td>"+
									            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+json[i].acName+"' disabled></td>"+
									            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
									            	    "</tr>");
		            }
	            	if(json[i].aType=="开标记录"){
		            	   $("#look_accessory6 tbody").append("<tr>"+
				     	   									"<td style='width:15%;'>附件</td>"+
									            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+json[i].acName+"' disabled></td>"+
									            	    	"<td><button type='button' class='btn btn-primary' data1='"+json[i].acUrl+"' onclick='download_all(this)'>下载附件</button></td>"+
									            	    "</tr>");
		            }
	            } 
			}
		})
		
	}
	
	//下载附件
	function download_all(obj){
		var url=$(obj).attr("data1");
		var name=$(obj).parents("tr").find("td").eq(1).find("input").val();
		window.location.href=encodeURI(getContextPath()+"/FileDownLoad?fileName="+name+"&filePath="+url);
	}
	
	
	//修改回显
	var xgId;
	function checkMd(obj){
		var dom=$(obj).parents("tr");
		var data=$("#mainContent").DataTable().row(dom).data();
		xgId=data.mdId;
		console.log(data)
		$("#edit_prjName").val(data.prjName);
		$("#edit_prjNo").val(data.prjNo);
		$("#edit_prjArea").val(data.prjArea);
		$("#edit_prjType").val(data.prjType);
		$("#edit_fill_in_one").val(data.fillInOne);
		$("#edit_key_word").val(data.keyWord);
		$("#edit_bidding_agent").val(data.biddingAgent);
		$("#edit_year1").val(data.prjBidTime);
		$("#edit_isBidding").val(data.isBidding);
		$("#edit_number").val(data.numberParticipatingUnits);
		$("#edit_offer").val(data.offer);
		$("#edit_prj_manager").val(data.biddingPrjManager);
		$("#edit_prj_general").val(data.prjGeneral);
		$("#edit_year2").val(data.prjStartTime);
		$("#edit_year3").val(data.prjEndTime);
		$("#edit_bidding_price").val(data.biddingPrice);
		$("#edit_bidding_unit").val(data.biddingUnit);
		$("#edit_bid_price_limit").val(data.bidPriceLimit);
		$("#edit_prj_budget_price").val(data.prjBudgetPrice);
		$("#edit_bid_evaluation_method").val(data.bidEvaluationMethod);
		
		var tender=data.managingDocumentsTenderer;
		$("#edit_table_Tender tbody").empty();
		for(var i=0;i<tender.length;i++){
			$("#edit_table_Tender tbody").append("<tr>"
					+"<td style='width:25%;'>"+tender[i].tName+"</td>"
					+"<td style='width:25%;'><button type='button' class='btn btn-primary' onclick='removeTender(this)'>移除</button></td>"
			+"</tr>")
		}
		
		var accessory1=data.accessory1;
		$("#edit_accessory1 thead").html('');
		$("#edit_accessory1 tbody").html('');
		if(accessory1==null){
			$("#edit_accessory1 thead").append("<tr>"+
						              				"<td style='width:15%;'>招标文件<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
						              				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile1()'>添加附件</button></td>"+
					          					"</tr>");
		}else{
			$("#edit_accessory1 thead").append("<tr>"+
      				"<td style='width:15%;'>招标文件<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
      				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile1()'>添加附件</button></td>"+
					"</tr>");
	        for(var i=0;i<accessory1.length;i++){
	        	   $("#edit_accessory1 thead").append("<tr>"+
								"<td style='width:15%;'>附件</td>"+
		            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+accessory1[i].acName+"' disabled></td>"+
		            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+accessory1[i].acUrl+"' data2='"+accessory1[i].aId+"' onclick='delete_thisFile(this)'>删除附件</button></td>"+
		            	    "</tr>");
	        }
		}
		var accessory2=data.accessory2;
		$("#edit_accessory2 thead").html('');
		$("#edit_accessory2 tbody").html('');
		if(accessory2==null){
			$("#edit_accessory2 thead").append("<tr>"+
						              				"<td style='width:15%;'>技术文件<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
						              				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile2()'>添加附件</button></td>"+
					          					"</tr>");
		}else{
			$("#edit_accessory2 thead").append("<tr>"+
      				"<td style='width:15%;'>技术文件<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
      				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile2()'>添加附件</button></td>"+
					"</tr>");
	        for(var i=0;i<accessory2.length;i++){
	        	   $("#edit_accessory2 thead").append("<tr>"+
								"<td style='width:15%;'>附件</td>"+
		            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+accessory2[i].acName+"' disabled></td>"+
		            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+accessory2[i].acUrl+"' data2='"+accessory2[i].aId+"' onclick='delete_thisFile(this)'>删除附件</button></td>"+
		            	    "</tr>");
	        }
		}
		var accessory3=data.accessory3;
		$("#edit_accessory3 thead").html('');
		$("#edit_accessory3 tbody").html('');
		if(accessory3==null){
			$("#edit_accessory3 thead").append("<tr>"+
						              				"<td style='width:15%;'>商务文件<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
						              				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile3()'>添加附件</button></td>"+
					          					"</tr>");
		}else{
			$("#edit_accessory3 thead").append("<tr>"+
      				"<td style='width:15%;'>商务文件<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
      				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile3()'>添加附件</button></td>"+
					"</tr>");
	        for(var i=0;i<accessory3.length;i++){
	        	   $("#edit_accessory3 thead").append("<tr>"+
								"<td style='width:15%;'>附件</td>"+
		            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+accessory3[i].acName+"' disabled></td>"+
		            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+accessory3[i].acUrl+"' data2='"+accessory3[i].aId+"' onclick='delete_thisFile(this)'>删除附件</button></td>"+
		            	    "</tr>");
	        }
		}
		var accessory4=data.accessory4;
		$("#edit_accessory4 thead").html('');
		$("#edit_accessory4 tbody").html('');
		if(accessory4==null){
			$("#edit_accessory4 thead").append("<tr>"+
						              				"<td style='width:15%;'>中标通知书<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
						              				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile4()'>添加附件</button></td>"+
					          					"</tr>");
		}else{
			$("#edit_accessory4 thead").append("<tr>"+
      				"<td style='width:15%;'>中标通知书<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
      				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile4()'>添加附件</button></td>"+
					"</tr>");
	        for(var i=0;i<accessory4.length;i++){
	        	   $("#edit_accessory4 thead").append("<tr>"+
								"<td style='width:15%;'>附件</td>"+
		            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+accessory4[i].acName+"' disabled></td>"+
		            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+accessory4[i].acUrl+"' data2='"+accessory4[i].aId+"' onclick='delete_thisFile(this)'>删除附件</button></td>"+
		            	    "</tr>");
	        }
		}
		var accessory5=data.accessory5;
		$("#edit_accessory5 thead").html('');
		$("#edit_accessory5 tbody").html('');
		if(accessory5==null){
			$("#edit_accessory5 thead").append("<tr>"+
						              				"<td style='width:15%;'>验收证书<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
						              				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile5()'>添加附件</button></td>"+
					          					"</tr>");
		}else{
			$("#edit_accessory5 thead").append("<tr>"+
      				"<td style='width:15%;'>验收证书<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
      				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile5()'>添加附件</button></td>"+
					"</tr>");
	        for(var i=0;i<accessory5.length;i++){
	        	   $("#edit_accessory5 thead").append("<tr>"+
								"<td style='width:15%;'>附件</td>"+
		            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+accessory5[i].acName+"' disabled></td>"+
		            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+accessory5[i].acUrl+"' data2='"+accessory5[i].aId+"' onclick='delete_thisFile(this)'>删除附件</button></td>"+
		            	    "</tr>");
	        }
		}
		var accessory6=data.accessory6;
		$("#edit_accessory6 thead").html('');
		$("#edit_accessory6 tbody").html('');
		if(accessory6==null){
			$("#edit_accessory6 thead").append("<tr>"+
						              				"<td style='width:15%;'>开标记录<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
						              				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile6()'>添加附件</button></td>"+
					          					"</tr>");
		}else{
			$("#edit_accessory6 thead").append("<tr>"+
      				"<td style='width:15%;'>开标记录<i class='iconfont icon-xingxing-copy' style='color:red;'></i></td>"+
      				"<td colspan='3'><button type='button' class='btn btn-primary weui-uploader__input' onclick='edit_addFile6()'>添加附件</button></td>"+
					"</tr>");
	        for(var i=0;i<accessory6.length;i++){
	        	   $("#edit_accessory6 thead").append("<tr>"+
								"<td style='width:15%;'>附件</td>"+
		            	    	"<td colspan='2'><input type='text' style='width:70%;' class='form-control' value='"+accessory6[i].acName+"' disabled></td>"+
		            	    	"<td style='width:150px;'><button type='button' class='btn btn-primary' data1='"+accessory6[i].acUrl+"' data2='"+accessory6[i].aId+"' onclick='delete_thisFile(this)'>删除附件</button></td>"+
		            	    "</tr>");
	        }
		}
		
	}
	function delete_thisFile(obj){
		var url=$(obj).attr("data1");
		var id=$(obj).attr("data2");
		var name=$(obj).parents("tr").find("td").eq(1).find("input").val();
		if(!confirm("确认删除该附件吗?")){
			   return false;
			}
		$.ajax({
	        type: 'POST',
	        url: getContextPath()+'/ManagingDocuments/deleteAccessory',
	        dataType: 'json',
	        data: {
	        	aId:id,
            	acName:name,
            	acUrl:url
	        },
	        success: function (json) {
	        	if(json==0){
	        		toastr.error("删除失败");
	        	}else{
	        		toastr.success("删除成功");
	        		$(obj).parent().parent().remove();
	        		//$("#change").modal("hide")
	        	}
	        }
		});
	}
	
	//修改保存
	function checkSave(){
		var edit_tender=new Array();
		$("#edit_table_Tender tbody").find("tr").each(function(){
			var name=$(this).find("td").eq(0).text();
			var arr={
					tId:null,
					tName:undefined
			}
			arr.tId=null;
			arr.tName=name;
			edit_tender.push(arr)
		});
		if(edit_tender.length>0){
			var prjName=$("#edit_prjName").val();
			var prjNo=$("#edit_prjNo").val();
			var prjArea=$("#edit_prjArea").val();
			var prjType=$("#edit_prjType").val();
			var fill_in_one=$("#edit_fill_in_one").val();
			var key_word=$("#edit_key_word").val();
			var bidding_agent=$("#edit_bidding_agent").val();
			var year1=$("#edit_year1").val();
			var isBidding=$("#edit_isBidding").val();
			var number=$("#edit_number").val();
			var offer=$("#edit_offer").val();
			var prj_manager=$("#edit_prj_manager").val();
			var prj_general=$("#edit_prj_general").val();
			var year2=$("#edit_year2").val();
			var year3=$("#edit_year3").val();
			var bidding_price=$("#edit_bidding_price").val();
			var bidding_unit=$("#edit_bidding_unit").val();
			var bid_price_limit=$("#edit_bid_price_limit").val();
			var prj_budget_price=$("#edit_prj_budget_price").val();
			var bid_evaluation_method=$("#edit_bid_evaluation_method").val();
			if(prjName==''){
				toastr.error("项目名不能为空")
				return;
			}
			var ManagingDocuments={
					mdId:null,
					prjName:undefined,
					prjNo:undefined,
					prjArea:undefined,
					prjType:undefined,
					fillInOne:undefined,
					keyWord:undefined,
					biddingAgent:undefined,
					prjBidTime:undefined,
					isBidding:undefined,
					numberParticipatingUnits:undefined,
					offer:0,
					biddingPrjManager:undefined,
					prjGeneral:undefined,
					prjStartTime:undefined,
					prjEndTime:undefined,
					biddingPrice:0,
					biddingUnit:undefined,
					bidPriceLimit:0,
					prjBudgetPrice:0,
					bidEvaluationMethod:undefined,
					managingDocumentsTenderer:undefined
			}
			ManagingDocuments.mdId=xgId;
			ManagingDocuments.prjName=prjName;
			ManagingDocuments.prjNo=prjNo;
			ManagingDocuments.prjArea=prjArea;
			ManagingDocuments.prjType=prjType;
			ManagingDocuments.fillInOne=fill_in_one;
			ManagingDocuments.keyWord=key_word;
			ManagingDocuments.biddingAgent=bidding_agent;
			ManagingDocuments.prjBidTime=year1;
			ManagingDocuments.isBidding=isBidding;
			ManagingDocuments.numberParticipatingUnits=number
			ManagingDocuments.offer=offer;
			ManagingDocuments.biddingPrjManager=prj_manager;
			ManagingDocuments.prjGeneral=prj_general;
			ManagingDocuments.prjStartTime=year2;
			ManagingDocuments.prjEndTime=year3
			ManagingDocuments.biddingPrice=bidding_price
			ManagingDocuments.biddingUnit=bidding_unit
			ManagingDocuments.bidPriceLimit=bid_price_limit
			ManagingDocuments.prjBudgetPrice=prj_budget_price;
			ManagingDocuments.bidEvaluationMethod=bid_evaluation_method;
			ManagingDocuments.managingDocumentsTenderer=edit_tender;
			//console.log(ManagingDocuments)
			
			var formData = new FormData();
	  		formData.append("managingDocuments", JSON.stringify(ManagingDocuments));
	  		
	  		$("#edit_accessory1 tbody").find("tr").each(function(){
	  			formData.append("file1", $(this).find("input")[0].files[0]);
	  		})
	  		$("#edit_accessory2 tbody").find("tr").each(function(){
	  			formData.append("file2", $(this).find("input")[0].files[0]);
	  		})
	  		$("#edit_accessory3 tbody").find("tr").each(function(){
	  			formData.append("file3", $(this).find("input")[0].files[0]);
	  		})
	  		$("#edit_accessory4 tbody").find("tr").each(function(){
	  			formData.append("file4", $(this).find("input")[0].files[0]);
	  		})
	  		$("#edit_accessory5 tbody").find("tr").each(function(){
	  			formData.append("file5", $(this).find("input")[0].files[0]);
	  		})
	  		$("#edit_accessory6 tbody").find("tr").each(function(){
	  			formData.append("file6", $(this).find("input")[0].files[0]);
	  		})
			$.ajax({
	  			type: 'POST',
	            url: getContextPath()+'/ManagingDocuments/updateManagingDocumentsSave',
	            data: formData,  
	            cache: false,
	            processData: false,
	            contentType: false,
	            async: false,
	            success: function (json) {
	            	if(json.result>0){
	            		$("#change").modal("hide");
	            		toastr.success("修改成功")
	            		initTable();
	            	}else{
	            		toastr.error("修改失败")
	            	}
	            }
	  		}) 
			
		}else{
			toastr.error("请至少添加一名招标人");
			return;
		}
	}
	
	
	
	//添加招标人
    function addTender(obj){
		if(obj==0){
			var name=$("#tender").val();
			if(name==''){
				toastr.error("招标人不能为空");
				return;
			}
			$("#new_Tender tbody").append("<tr>"
												+"<td style='width:50%;'>"+name+"</td>"
												+"<td style='width:50%;'><button type='button' class='btn btn-primary' onclick='removeTender(this)'>移除</button></td>"
										+"</tr>")
		}else if(obj==1){
			var name=$("#edit_tender").val();
			if(name==''){
				toastr.error("招标人不能为空");
				return;
			}
			$("#edit_table_Tender tbody").append("<tr>"
												+"<td style='width:50%;'>"+name+"</td>"
												+"<td style='width:50%;'><button type='button' class='btn btn-primary' onclick='removeTender(this)'>移除</button></td>"
										+"</tr>")
		}
	}
    function removeTender(obj){
		var tr=$(obj).parent().parent();
		$(tr).remove();
	}
	
	function addFile1(){
		$("#new_accessory1 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function addFile2(){
		$("#new_accessory2 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function addFile3(){
		$("#new_accessory3 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function addFile4(){
		$("#new_accessory4 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function addFile5(){
		$("#new_accessory5 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file' name='file' class='form-control'></td><td><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function addFile6(){
		$("#new_accessory6 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
    
	
	function edit_addFile1(){
		$("#edit_accessory1 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function edit_addFile2(){
		$("#edit_accessory2 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file' name='file' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function edit_addFile3(){
		$("#edit_accessory3 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function edit_addFile4(){
		$("#edit_accessory4 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file'  name='file' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function edit_addFile5(){
		$("#edit_accessory5 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file' name='file' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	function edit_addFile6(){
		$("#edit_accessory6 tbody").append("<tr><td>新附件</td><td colspan='2'><input style='width:70%;' type='file' name='file' class='form-control'></td><td style='width:150px;'><button type='button' class='btn btn-primary' onclick='removeFile(this)'>移除</button></td></tr>")
	}
	
	function removeFile(obj){
		var tr=$(obj).parents("tr");
		$(tr).remove();
	}

	
</script>
</html>