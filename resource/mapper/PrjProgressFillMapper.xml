<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.ldxx.dao.PrjProgressFillDao" >
  	<insert id="addPrjProgressFill" parameterType="PrjProgressFill">
  		insert into prj_progress_fill(ppf_id,prj_name,task_no,prj_type,contract_money,prj_leader,
  									provisional_sum,prj_start_time,prj_end_time,budget_money_all,
  									this_time,all_money,all_cost,prj_this_income)
  		values(#{ppf.ppfId},#{ppf.prjName},#{ppf.taskNo},#{ppf.prjType},#{ppf.contractMoney},#{ppf.prjLeader},
  					#{ppf.provisionalSum},#{ppf.prjStartTime},#{ppf.prjEndTime},#{ppf.budgetMoneyAll},
  					#{ppf.thisTime},#{ppf.allMoney},#{ppf.allCost},#{ppf.prjThisIncome})
  	</insert>
  	
  	<insert id="addPrjProgressFillInfo" parameterType="java.util.List">
  		insert into prj_progress_fill_info(ppf_id,department,money,type,main)
  		values
  		<foreach collection="ppfi" index="index" item="p" separator=",">
  			(#{p.ppfId},#{p.department},#{p.money},#{p.type},#{p.main})
  		</foreach>
  	</insert>
  	
  	<select id="selectPrjProgressFill"  resultType="PrjProgressFill">
  		select a.* from prj_progress_fill as a left join mode_status as b on a.ppf_id=b.mode_id
  		where b.status=#{status}
  	</select>
  	
  	<select id="selectPrjProgressFillInfo" resultType="PrjProgressFillInfo">
  		select * from prj_progress_fill_info where ppf_id=#{id} and type=#{type}
  	</select>
  	
  	<select id="selectPrjProgressFillById" resultType="PrjProgressFill">
  		select * from prj_progress_fill where ppf_id=#{id}
  	</select>
  	
  	<select id="selectLastPrjProgressFill" resultType="PrjProgressFill">
  		select all_money from prj_progress_fill where task_no=#{no} ORDER BY this_time desc LIMIT 1
  	</select>
</mapper>