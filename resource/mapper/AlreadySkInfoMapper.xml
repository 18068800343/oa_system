<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.ldxx.dao.AlreadySkInfoDao" >

	<insert id="addAlreadyRenling">
		insert into already_renling(r_id,c_no,c_name,t_no,t_name,this_person,sk_no,kp_no,fp_no,
		main_department,fk_danwei,come_all_money,sk_queren_money,fp_desc,queren_date,daozhang_date,fp_money,kp_date)
		values(#{ar.rId},#{ar.cNo},#{ar.cName},#{ar.tNo},#{ar.tName},#{ar.thisPerson},#{ar.skNo},
		#{ar.kpNo},#{ar.fpNo},#{ar.mainDepartment},#{ar.fkDanwei},#{ar.comeAllMoney},#{ar.skQuerenMoney},#{ar.fpDesc},
		now(),#{ar.daozhangDate},#{ar.fpMoney},#{ar.kpDate})
	</insert>
	
	<insert id="addAlreadySkOmInfo">
		insert into already_sk_om_info(ao_id,r_id,om_id,om_name,om_already_money,time,operator_person)
				values(#{skOmInfo.aoId}, #{skOmInfo.rId}, #{skOmInfo.omId},#{skOmInfo.omName},#{skOmInfo.omAlreadyMoney},
				now(),#{skOmInfo.operatorPerson})
	</insert>
	
	<select id="getyirenlingfpMoneyByKpno" resultType="AlreadyRenling">
		select IfNull(sum(sk_queren_money),0) as yirenlingallFpMoney from already_renling as a
		 left join receive_money as b on a.sk_no=b.sk_no and b.`status`!='2'
		 where a.kp_no=#{kpno}
	</select>
	
	<select id="getyirenlingfpMoneyByskno" resultType="AlreadyRenling">
		select IfNull(sum(a.sk_queren_money),0) as yirenlingallFpMoney from already_renling as a
		left join receive_money as b on a.sk_no=b.sk_no and b.`status`!='2'
		 where a.sk_no=#{skNo}
	</select>

	<select id="selectAlreadyRenling" resultType="AlreadySkInfo">
		select * from receive_money  as a left join already_renling as b on a.sk_no=b.sk_no WHERE a.`status`='2'
	</select>

</mapper>